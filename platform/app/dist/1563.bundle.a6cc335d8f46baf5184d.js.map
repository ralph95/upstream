{"version":3,"file":"1563.bundle.a6cc335d8f46baf5184d.js","mappings":"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","sources":["webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/shared/getActiveToolForKeyboardEvent.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/keyboardEventHandlers/keyDown.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/shared/getToolsWithActionsForKeyboardEvents.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/keyboardEventHandlers/keyUp.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseClick.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseDoubleClick.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/shared/getActiveToolForMouseEvent.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseDownAnnotationAction.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/shared/getToolsWithActionsForMouseEvent.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseDown.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseDownActivate.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseDrag.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseMove.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseUp.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseEventHandlers/mouseWheel.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/shared/customCallbackHandler.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/shared/getToolsWithModesForMouseEvent.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/shared/getActiveToolForTouchEvent.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/shared/getToolsWithModesForTouchEvent.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchEventHandlers/touchStart.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchEventHandlers/touchStartActivate.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchEventHandlers/touchDrag.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchEventHandlers/touchEnd.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchEventHandlers/touchTap.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchEventHandlers/touchPress.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/keyboard/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/keyboard/keyDownListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/mouse/getMouseEventPoints.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/mouse/mouseDoubleClickListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/mouse/mouseDownListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/mouse/mouseMoveListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/touch/preventGhostClick.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/touch/getTouchEventPoints.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/touch/touchStartListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/wheel/wheelListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/wheel/normalizeWheel.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/convertStackToVolumeLabelmap.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/updateStackSegmentationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/filterMoveableAnnotationTools.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/filterToolsWithAnnotationsForElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/filterToolsWithMoveableHandles.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SculptorTool/CircleSculptCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/GrowCutBaseTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/distancePointToContour.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/strategies/eraseRectangle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/geometricSurfaceUtils.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getToolsWithModesForElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getVOIMultipliers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/livewire/LiveWirePath.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/BucketQueue.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/livewire/LivewireScissors.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/aabb/intersectAABB.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/aabb/distanceToPointSquared.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/aabb/distanceToPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/angle/angleBetweenLines.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/basic/Calculator.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/circle/getCanvasCircleRadius.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/circle/getCanvasCircleCorners.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/ellipse/pointInEllipse.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/ellipse/getCanvasEllipseCorners.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/fan/fanUtils.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/line/distanceToPointSquared.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/line/distanceToPointSquaredInfo.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/line/isPointOnLineSegment.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/midPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/point/distanceToPointSquared.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/point/distanceToPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/point/mirror.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/addCanvasPointsToArray.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/areLineSegmentsIntersecting.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/combinePolyline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/containsPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/convexHull.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getAABB.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getArea.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getClosestLineSegmentIntersection.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getFirstLineSegmentIntersectionIndexes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getLineSegmentIntersectionsCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getLineSegmentIntersectionsIndexes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getLinesIntersection.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getNormal2.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getNormal3.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getSubPixelSpacingAndXYDirections.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/getWindingDirection.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/intersectPolyline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/intersectPolylines.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/isPointInsidePolyline3D.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/pointCanProjectOnLine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/pointsAreWithinCloseContourProximity.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/projectTo2D.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/robustSegmentIntersection.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/polyline/subtractPolylines.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/vec2/liangBarksyClip.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/planarFreehandROITool/smoothAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/planar/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/growCut/constants.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/stackPrefetch/stackPrefetchUtils.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/stackPrefetch/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/vec3/interpolateVec3.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/ColorbarCanvas.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/ColorbarTicks.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/common/isRangeValid.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/common/isColorbarSizeValid.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/common/areColorbarRangesEqual.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/common/areColorbarSizesEqual.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/voi/colorbar/common/isRangeTextPositionValid.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/widgets/Widget.js","webpack:///../../../node_modules/@kitware/vtk.js/Filters/Sources/SphereSource.js","webpack:///../../../node_modules/@kitware/vtk.js/Interaction/Widgets/OrientationMarkerWidget/Constants.js","webpack:///../../../node_modules/@kitware/vtk.js/Interaction/Widgets/OrientationMarkerWidget.js","webpack:///../../../node_modules/@kitware/vtk.js/Common/Core/ImageHelper.js","webpack:///../../../node_modules/@kitware/vtk.js/Rendering/Core/AnnotatedCubeActor/Presets.js","webpack:///../../../node_modules/@kitware/vtk.js/Rendering/Core/AnnotatedCubeActor.js","webpack:///../../../node_modules/@kitware/vtk.js/Filters/General/AppendPolyData.js","webpack:///../../../node_modules/@kitware/vtk.js/Filters/Sources/ConeSource.js","webpack:///../../../node_modules/@kitware/vtk.js/Filters/Sources/CylinderSource.js","webpack:///../../../node_modules/@kitware/vtk.js/Filters/Sources/ArrowSource.js","webpack:///../../../node_modules/@kitware/vtk.js/Rendering/Core/AxesActor.js"],"sourcesContent":["import { ToolModes } from '../../enums';\nimport { keyEventListener } from '../../eventListeners';\nimport { getMouseButton } from '../../eventListeners/mouse/mouseDownListener';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nconst { Active } = ToolModes;\nexport default function getActiveToolForKeyboardEvent(evt) {\n    const { renderingEngineId, viewportId } = evt.detail;\n    const mouseButton = getMouseButton();\n    const modifierKey = keyEventListener.getModifierKey();\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return null;\n    }\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    const defaultMousePrimary = toolGroup.getDefaultMousePrimary();\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const toolOptions = toolGroup.toolOptions[toolName];\n        if (toolOptions.mode !== Active) {\n            continue;\n        }\n        const correctBinding = toolOptions.bindings.length &&\n            toolOptions.bindings.some((binding) => binding.mouseButton === (mouseButton ?? defaultMousePrimary) &&\n                binding.modifierKey === modifierKey);\n        if (correctBinding) {\n            return toolGroup.getToolInstance(toolName);\n        }\n    }\n}\n","import getActiveToolForKeyboardEvent from '../shared/getActiveToolForKeyboardEvent';\nimport getToolsWithActionsForKeyboardEvent from '../shared/getToolsWithActionsForKeyboardEvents';\nimport ToolModes from '../../enums/ToolModes';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nexport default function keyDown(evt) {\n    const activeTool = getActiveToolForKeyboardEvent(evt);\n    if (activeTool) {\n        const { renderingEngineId, viewportId } = evt.detail;\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        const toolName = activeTool.getToolName();\n        if (Object.keys(toolGroup.toolOptions).includes(toolName)) {\n            toolGroup.setViewportsCursorByToolName(toolName);\n        }\n    }\n    const activeToolsWithEventBinding = getToolsWithActionsForKeyboardEvent(evt, [\n        ToolModes.Active,\n    ]);\n    if (activeToolsWithEventBinding?.size) {\n        const { element } = evt.detail;\n        for (const [key, value] of [...activeToolsWithEventBinding.entries()]) {\n            const method = typeof value.method === 'function' ? value.method : key[value.method];\n            method.call(key, element, value, evt);\n        }\n    }\n}\n","import { getToolGroupForViewport } from '../../store/ToolGroupManager';\nexport default function getToolsWithModesForKeyboardEvent(evt, toolModes) {\n    const toolsWithActions = new Map();\n    const { renderingEngineId, viewportId } = evt.detail;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return toolsWithActions;\n    }\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    const key = evt.detail.key;\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const tool = toolGroup.getToolInstance(toolName);\n        const actionsConfig = tool.configuration?.actions;\n        if (!actionsConfig) {\n            continue;\n        }\n        const actions = Object.values(actionsConfig);\n        if (!actions?.length || !toolModes.includes(tool.mode)) {\n            continue;\n        }\n        const action = actions.find((action) => action.bindings?.some((binding) => binding.key === key));\n        if (action) {\n            toolsWithActions.set(tool, action);\n        }\n    }\n    return toolsWithActions;\n}\n","import { resetModifierKey } from '../../eventListeners/keyboard/keyDownListener';\nimport getActiveToolForKeyboardEvent from '../shared/getActiveToolForKeyboardEvent';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nexport default function keyUp(evt) {\n    const activeTool = getActiveToolForKeyboardEvent(evt);\n    if (!activeTool) {\n        return;\n    }\n    const { renderingEngineId, viewportId } = evt.detail;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    resetModifierKey();\n    const toolName = activeTool.getToolName();\n    if (Object.keys(toolGroup.toolOptions).includes(toolName)) {\n        toolGroup.setViewportsCursorByToolName(toolName);\n    }\n}\n","import customCallbackHandler from '../shared/customCallbackHandler';\nconst mouseClick = customCallbackHandler.bind(null, 'Mouse', 'mouseClickCallback');\nexport default mouseClick;\n","import customCallbackHandler from '../shared/customCallbackHandler';\nconst mouseDoubleClick = customCallbackHandler.bind(null, 'Mouse', 'doubleClickCallback');\nexport default mouseDoubleClick;\n","import { ToolModes } from '../../enums';\nimport { keyEventListener } from '../../eventListeners';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nimport getMouseModifier from './getMouseModifier';\nconst { Active } = ToolModes;\nexport default function getActiveToolForMouseEvent(evt) {\n    const { renderingEngineId, viewportId, event: mouseEvent } = evt.detail;\n    const modifierKey = getMouseModifier(mouseEvent) || keyEventListener.getModifierKey();\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return null;\n    }\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    const defaultMousePrimary = toolGroup.getDefaultMousePrimary();\n    const mouseButton = evt.detail.buttons ?? mouseEvent?.buttons ?? defaultMousePrimary;\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const toolOptions = toolGroup.toolOptions[toolName];\n        const correctBinding = toolOptions.bindings.length &&\n            toolOptions.bindings.some((binding) => {\n                return (binding.mouseButton === mouseButton &&\n                    binding.modifierKey === modifierKey);\n            });\n        if (toolOptions.mode === Active && correctBinding) {\n            return toolGroup.getToolInstance(toolName);\n        }\n    }\n}\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { state } from '../../store/state';\nimport { ToolModes } from '../../enums';\nimport filterToolsWithAnnotationsForElement from '../../store/filterToolsWithAnnotationsForElement';\nimport filterMoveableAnnotationTools from '../../store/filterMoveableAnnotationTools';\nimport getToolsWithActionsForMouseEvent from '../shared/getToolsWithActionsForMouseEvent';\nconst { Active, Passive } = ToolModes;\nexport default function mouseDownAnnotationAction(evt) {\n    if (state.isInteractingWithTool) {\n        return false;\n    }\n    const eventDetail = evt.detail;\n    const { element } = eventDetail;\n    const enabledElement = getEnabledElement(element);\n    const { canvas: canvasCoords } = eventDetail.currentPoints;\n    if (!enabledElement) {\n        return false;\n    }\n    const toolsWithActions = getToolsWithActionsForMouseEvent(evt, [\n        Active,\n        Passive,\n    ]);\n    const tools = Array.from(toolsWithActions.keys());\n    const annotationToolsWithAnnotations = filterToolsWithAnnotationsForElement(element, tools);\n    const moveableAnnotationTools = filterMoveableAnnotationTools(element, annotationToolsWithAnnotations, canvasCoords);\n    if (moveableAnnotationTools.length > 0) {\n        const { tool, annotation } = moveableAnnotationTools[0];\n        const action = toolsWithActions.get(tool);\n        const method = typeof action.method === 'string' ? tool[action.method] : action.method;\n        method.call(tool, evt, annotation);\n        return true;\n    }\n    return false;\n}\n","import { keyEventListener } from '../../eventListeners';\nimport getMouseModifier from './getMouseModifier';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nexport default function getToolsWithActionsForMouseEvent(evt, toolModes) {\n    const toolsWithActions = new Map();\n    const { renderingEngineId, viewportId } = evt.detail;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return toolsWithActions;\n    }\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    const defaultMousePrimary = toolGroup.getDefaultMousePrimary();\n    const mouseEvent = evt.detail.event;\n    const mouseButton = mouseEvent?.buttons ?? defaultMousePrimary;\n    const modifierKey = getMouseModifier(mouseEvent) || keyEventListener.getModifierKey();\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const tool = toolGroup.getToolInstance(toolName);\n        const actionsConfig = tool.configuration?.actions ?? {};\n        const actions = Object.values(actionsConfig);\n        if (!actions?.length || !toolModes.includes(tool.mode)) {\n            continue;\n        }\n        const action = actions.find((action) => action.bindings?.length &&\n            action.bindings.some((binding) => binding.mouseButton === mouseButton &&\n                binding.modifierKey === modifierKey));\n        if (action) {\n            toolsWithActions.set(tool, action);\n        }\n    }\n    return toolsWithActions;\n}\n","import { state } from '../../store/state';\nimport { ToolModes } from '../../enums';\nimport { setAnnotationSelected, isAnnotationSelected, } from '../../stateManagement/annotation/annotationSelection';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport filterToolsWithMoveableHandles from '../../store/filterToolsWithMoveableHandles';\nimport filterToolsWithAnnotationsForElement from '../../store/filterToolsWithAnnotationsForElement';\nimport filterMoveableAnnotationTools from '../../store/filterMoveableAnnotationTools';\nimport getActiveToolForMouseEvent from '../shared/getActiveToolForMouseEvent';\nimport getToolsWithModesForMouseEvent from '../shared/getToolsWithModesForMouseEvent';\nimport mouseDownAnnotationAction from './mouseDownAnnotationAction';\nconst { Active, Passive } = ToolModes;\nexport default function mouseDown(evt) {\n    if (state.isInteractingWithTool) {\n        return;\n    }\n    const activeTool = getActiveToolForMouseEvent(evt);\n    if (activeTool && typeof activeTool.preMouseDownCallback === 'function') {\n        const consumedEvent = activeTool.preMouseDownCallback(evt);\n        if (consumedEvent) {\n            return;\n        }\n    }\n    const isPrimaryClick = evt.detail.event.buttons === 1;\n    const activeToolsWithEventBinding = getToolsWithModesForMouseEvent(evt, [Active], evt.detail.event.buttons);\n    const passiveToolsIfEventWasPrimaryMouseButton = isPrimaryClick\n        ? getToolsWithModesForMouseEvent(evt, [Passive])\n        : undefined;\n    const applicableTools = [\n        ...(activeToolsWithEventBinding || []),\n        ...(passiveToolsIfEventWasPrimaryMouseButton || []),\n    ];\n    const actionExecuted = mouseDownAnnotationAction(evt);\n    if (actionExecuted) {\n        return;\n    }\n    const eventDetail = evt.detail;\n    const { element } = eventDetail;\n    const annotationToolsWithAnnotations = filterToolsWithAnnotationsForElement(element, applicableTools);\n    const canvasCoords = eventDetail.currentPoints.canvas;\n    const annotationToolsWithMoveableHandles = filterToolsWithMoveableHandles(element, annotationToolsWithAnnotations, canvasCoords, 'mouse');\n    const isMultiSelect = !!evt.detail.event.shiftKey;\n    if (annotationToolsWithMoveableHandles.length > 0) {\n        const { tool, annotation, handle } = getAnnotationForSelection(annotationToolsWithMoveableHandles);\n        toggleAnnotationSelection(annotation.annotationUID, isMultiSelect);\n        tool.handleSelectedCallback(evt, annotation, handle, 'Mouse');\n        return;\n    }\n    const moveableAnnotationTools = filterMoveableAnnotationTools(element, annotationToolsWithAnnotations, canvasCoords, 'mouse');\n    if (moveableAnnotationTools.length > 0) {\n        const { tool, annotation } = getAnnotationForSelection(moveableAnnotationTools);\n        toggleAnnotationSelection(annotation.annotationUID, isMultiSelect);\n        tool.toolSelectedCallback(evt, annotation, 'Mouse', canvasCoords);\n        return;\n    }\n    if (activeTool && typeof activeTool.postMouseDownCallback === 'function') {\n        const consumedEvent = activeTool.postMouseDownCallback(evt);\n        if (consumedEvent) {\n            return;\n        }\n    }\n}\nfunction getAnnotationForSelection(toolsWithMovableHandles) {\n    if (toolsWithMovableHandles.length > 1) {\n        const unlockAndVisibleAnnotation = toolsWithMovableHandles.find((item) => {\n            const isUnlocked = !isAnnotationLocked(item.annotation.annotationUID);\n            const isVisible = isAnnotationVisible(item.annotation.annotationUID);\n            return isUnlocked && isVisible;\n        });\n        if (unlockAndVisibleAnnotation) {\n            return unlockAndVisibleAnnotation;\n        }\n    }\n    return toolsWithMovableHandles[0];\n}\nfunction toggleAnnotationSelection(annotationUID, isMultiSelect = false) {\n    if (isMultiSelect) {\n        if (isAnnotationSelected(annotationUID)) {\n            setAnnotationSelected(annotationUID, false);\n        }\n        else {\n            const preserveSelected = true;\n            setAnnotationSelected(annotationUID, true, preserveSelected);\n        }\n    }\n    else {\n        const preserveSelected = false;\n        setAnnotationSelected(annotationUID, true, preserveSelected);\n    }\n}\n","import { state } from '../../store/state';\nimport getActiveToolForMouseEvent from '../shared/getActiveToolForMouseEvent';\nimport { setAnnotationSelected } from '../../stateManagement/annotation/annotationSelection';\nexport default function mouseDownActivate(evt) {\n    if (state.isInteractingWithTool) {\n        return;\n    }\n    const activeTool = getActiveToolForMouseEvent(evt);\n    if (!activeTool) {\n        return;\n    }\n    if (state.isMultiPartToolActive) {\n        return;\n    }\n    if (activeTool.addNewAnnotation) {\n        const annotation = activeTool.addNewAnnotation(evt, 'mouse');\n        setAnnotationSelected(annotation.annotationUID);\n    }\n}\n","import getActiveToolForMouseEvent from '../shared/getActiveToolForMouseEvent';\nimport { state } from '../../store/state';\nexport default function mouseDrag(evt) {\n    if (state.isInteractingWithTool) {\n        return;\n    }\n    const activeTool = getActiveToolForMouseEvent(evt);\n    const noFoundToolOrDoesNotHaveMouseDragCallback = !activeTool || typeof activeTool.mouseDragCallback !== 'function';\n    if (noFoundToolOrDoesNotHaveMouseDragCallback) {\n        return;\n    }\n    activeTool.mouseDragCallback(evt);\n}\n","import { state } from '../../store/state';\nimport { ToolModes } from '../../enums';\nimport filterToolsWithAnnotationsForElement from '../../store/filterToolsWithAnnotationsForElement';\nimport getToolsWithModesForMouseEvent from '../shared/getToolsWithModesForMouseEvent';\nimport triggerAnnotationRender from '../../utilities/triggerAnnotationRender';\nconst { Active, Passive } = ToolModes;\nexport default function mouseMove(evt) {\n    if (state.isInteractingWithTool || state.isMultiPartToolActive) {\n        return;\n    }\n    const activeAndPassiveTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n    ]);\n    const eventDetail = evt.detail;\n    const { element } = eventDetail;\n    const toolsWithAnnotations = filterToolsWithAnnotationsForElement(element, activeAndPassiveTools);\n    const toolsWithoutAnnotations = activeAndPassiveTools.filter((tool) => {\n        const doesNotHaveAnnotations = !toolsWithAnnotations.some((toolAndAnnotation) => toolAndAnnotation.tool.getToolName() === tool.getToolName());\n        return doesNotHaveAnnotations;\n    });\n    let annotationsNeedToBeRedrawn = false;\n    for (const { tool, annotations } of toolsWithAnnotations) {\n        if (typeof tool.mouseMoveCallback === 'function') {\n            annotationsNeedToBeRedrawn =\n                tool.mouseMoveCallback(evt, annotations) || annotationsNeedToBeRedrawn;\n        }\n    }\n    toolsWithoutAnnotations.forEach((tool) => {\n        if (typeof tool.mouseMoveCallback === 'function') {\n            tool.mouseMoveCallback(evt);\n        }\n    });\n    if (annotationsNeedToBeRedrawn === true) {\n        triggerAnnotationRender(element);\n    }\n}\n","import customCallbackHandler from '../shared/customCallbackHandler';\nconst mouseUp = customCallbackHandler.bind(null, 'Mouse', 'mouseUpCallback');\nexport default mouseUp;\n","import { state } from '../../store/state';\nimport getActiveToolForMouseEvent from '../shared/getActiveToolForMouseEvent';\nimport { MouseBindings } from '../../enums/ToolBindings';\nfunction mouseWheel(evt) {\n    if (state.isInteractingWithTool) {\n        return;\n    }\n    evt.detail.buttons =\n        MouseBindings.Wheel | (evt.detail.event.buttons || 0);\n    const activeTool = getActiveToolForMouseEvent(evt);\n    if (!activeTool) {\n        return;\n    }\n    return activeTool.mouseWheelCallback(evt);\n}\nexport default mouseWheel;\n","import { state } from '../../store/state';\nimport ToolModes from '../../enums/ToolModes';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nconst { Active } = ToolModes;\nexport default function customCallbackHandler(handlerType, customFunction, evt) {\n    if (state.isInteractingWithTool) {\n        return false;\n    }\n    const { renderingEngineId, viewportId } = evt.detail;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return false;\n    }\n    let activeTool;\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const tool = toolGroup.toolOptions[toolName];\n        const toolInstance = toolGroup.getToolInstance(toolName);\n        if (tool.mode === Active &&\n            typeof toolInstance[customFunction] === 'function') {\n            activeTool = toolGroup.getToolInstance(toolName);\n            break;\n        }\n    }\n    if (!activeTool) {\n        return;\n    }\n    activeTool[customFunction](evt);\n}\n","import { getToolGroupForViewport } from '../../store/ToolGroupManager';\nexport default function getToolsWithModesForMouseEvent(evt, modesFilter, evtButton) {\n    const { renderingEngineId, viewportId } = evt.detail;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return [];\n    }\n    const enabledTools = [];\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const tool = toolGroup.toolOptions[toolName];\n        const correctBinding = evtButton != null &&\n            tool.bindings.length &&\n            tool.bindings.some((binding) => binding.mouseButton === evtButton);\n        if (modesFilter.includes(tool.mode) &&\n            (!evtButton || correctBinding)) {\n            const toolInstance = toolGroup.getToolInstance(toolName);\n            enabledTools.push(toolInstance);\n        }\n    }\n    return enabledTools;\n}\n","import { ToolModes } from '../../enums';\nimport getMouseModifier from './getMouseModifier';\nimport { keyEventListener } from '../../eventListeners';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nconst { Active } = ToolModes;\nexport default function getActiveToolForTouchEvent(evt) {\n    const { renderingEngineId, viewportId } = evt.detail;\n    const touchEvent = evt.detail.event;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return null;\n    }\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    const numTouchPoints = Object.keys(touchEvent.touches).length;\n    const modifierKey = getMouseModifier(touchEvent) || keyEventListener.getModifierKey();\n    const defaultMousePrimary = toolGroup.getDefaultMousePrimary();\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const toolOptions = toolGroup.toolOptions[toolName];\n        const correctBinding = toolOptions.bindings.length &&\n            toolOptions.bindings.some((binding) => (binding.numTouchPoints === numTouchPoints ||\n                (numTouchPoints === 1 &&\n                    binding.mouseButton === defaultMousePrimary)) &&\n                binding.modifierKey === modifierKey);\n        if (toolOptions.mode === Active && correctBinding) {\n            return toolGroup.getToolInstance(toolName);\n        }\n    }\n}\n","import { getToolGroupForViewport } from '../../store/ToolGroupManager';\nexport default function getToolsWithModesForTouchEvent(evt, modesFilter, numTouchPoints) {\n    const { renderingEngineId, viewportId } = evt.detail;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return [];\n    }\n    const enabledTools = [];\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const tool = toolGroup.toolOptions[toolName];\n        const correctBinding = numTouchPoints != null &&\n            tool.bindings.length &&\n            tool.bindings.some((binding) => binding.numTouchPoints === numTouchPoints);\n        if (modesFilter.includes(tool.mode) &&\n            (!numTouchPoints || correctBinding)) {\n            const toolInstance = toolGroup.getToolInstance(toolName);\n            enabledTools.push(toolInstance);\n        }\n    }\n    return enabledTools;\n}\n","import { state } from '../../store/state';\nimport { ToolModes } from '../../enums';\nimport { setAnnotationSelected, isAnnotationSelected, } from '../../stateManagement/annotation/annotationSelection';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport filterToolsWithMoveableHandles from '../../store/filterToolsWithMoveableHandles';\nimport filterToolsWithAnnotationsForElement from '../../store/filterToolsWithAnnotationsForElement';\nimport filterMoveableAnnotationTools from '../../store/filterMoveableAnnotationTools';\nimport getActiveToolForTouchEvent from '../shared/getActiveToolForTouchEvent';\nimport getToolsWithModesForTouchEvent from '../shared/getToolsWithModesForTouchEvent';\nconst { Active, Passive } = ToolModes;\nexport default function touchStart(evt) {\n    if (state.isInteractingWithTool) {\n        return;\n    }\n    const activeTool = getActiveToolForTouchEvent(evt);\n    if (activeTool && typeof activeTool.preTouchStartCallback === 'function') {\n        const consumedEvent = activeTool.preTouchStartCallback(evt);\n        if (consumedEvent) {\n            return;\n        }\n    }\n    const isPrimaryClick = Object.keys(evt.detail.event.touches).length === 1;\n    const activeToolsWithEventBinding = getToolsWithModesForTouchEvent(evt, [Active], Object.keys(evt.detail.event.touches).length);\n    const passiveToolsIfEventWasPrimaryTouchButton = isPrimaryClick\n        ? getToolsWithModesForTouchEvent(evt, [Passive])\n        : undefined;\n    const applicableTools = [\n        ...(activeToolsWithEventBinding || []),\n        ...(passiveToolsIfEventWasPrimaryTouchButton || []),\n        activeTool,\n    ];\n    const eventDetail = evt.detail;\n    const { element } = eventDetail;\n    const annotationToolsWithAnnotations = filterToolsWithAnnotationsForElement(element, applicableTools);\n    const canvasCoords = eventDetail.currentPoints.canvas;\n    const annotationToolsWithMoveableHandles = filterToolsWithMoveableHandles(element, annotationToolsWithAnnotations, canvasCoords, 'touch');\n    const isMultiSelect = false;\n    if (annotationToolsWithMoveableHandles.length > 0) {\n        const { tool, annotation, handle } = getAnnotationForSelection(annotationToolsWithMoveableHandles);\n        toggleAnnotationSelection(annotation.annotationUID, isMultiSelect);\n        tool.handleSelectedCallback(evt, annotation, handle, 'Touch');\n        return;\n    }\n    const moveableAnnotationTools = filterMoveableAnnotationTools(element, annotationToolsWithAnnotations, canvasCoords, 'touch');\n    if (moveableAnnotationTools.length > 0) {\n        const { tool, annotation } = getAnnotationForSelection(moveableAnnotationTools);\n        toggleAnnotationSelection(annotation.annotationUID, isMultiSelect);\n        tool.toolSelectedCallback(evt, annotation, 'Touch', canvasCoords);\n        return;\n    }\n    if (activeTool && typeof activeTool.postTouchStartCallback === 'function') {\n        const consumedEvent = activeTool.postTouchStartCallback(evt);\n        if (consumedEvent) {\n            return;\n        }\n    }\n}\nfunction getAnnotationForSelection(toolsWithMovableHandles) {\n    return ((toolsWithMovableHandles.length > 1 &&\n        toolsWithMovableHandles.find((item) => !isAnnotationLocked(item.annotation.annotationUID) &&\n            isAnnotationVisible(item.annotation.annotationUID))) ||\n        toolsWithMovableHandles[0]);\n}\nfunction toggleAnnotationSelection(annotationUID, isMultiSelect = false) {\n    if (isMultiSelect) {\n        if (isAnnotationSelected(annotationUID)) {\n            setAnnotationSelected(annotationUID, false);\n        }\n        else {\n            const preserveSelected = true;\n            setAnnotationSelected(annotationUID, true, preserveSelected);\n        }\n    }\n    else {\n        const preserveSelected = false;\n        setAnnotationSelected(annotationUID, true, preserveSelected);\n    }\n}\n","import { state } from '../../store/state';\nimport { setAnnotationSelected } from '../../stateManagement/annotation/annotationSelection';\nimport getActiveToolForTouchEvent from '../shared/getActiveToolForTouchEvent';\nexport default function touchStartActivate(evt) {\n    if (state.isInteractingWithTool) {\n        return;\n    }\n    const activeTool = getActiveToolForTouchEvent(evt);\n    if (!activeTool) {\n        return;\n    }\n    if (state.isMultiPartToolActive) {\n        return;\n    }\n    if (activeTool.addNewAnnotation) {\n        const annotation = activeTool.addNewAnnotation(evt, 'touch');\n        setAnnotationSelected(annotation.annotationUID);\n    }\n}\n","import getActiveToolForTouchEvent from '../shared/getActiveToolForTouchEvent';\nimport { state } from '../../store/state';\nexport default function touchDrag(evt) {\n    if (state.isInteractingWithTool) {\n        return;\n    }\n    const activeTool = getActiveToolForTouchEvent(evt);\n    const noFoundToolOrDoesNotHaveTouchDragCallback = !activeTool || typeof activeTool.touchDragCallback !== 'function';\n    if (noFoundToolOrDoesNotHaveTouchDragCallback) {\n        return;\n    }\n    activeTool.touchDragCallback(evt);\n}\n","import customCallbackHandler from '../shared/customCallbackHandler';\nconst touchEnd = customCallbackHandler.bind(null, 'Touch', 'touchEndCallback');\nexport default touchEnd;\n","import customCallbackHandler from '../shared/customCallbackHandler';\nconst touchTap = customCallbackHandler.bind(null, 'Touch', 'touchTapCallback');\nexport default touchTap;\n","import customCallbackHandler from '../shared/customCallbackHandler';\nconst touchPress = customCallbackHandler.bind(null, 'Touch', 'touchPressCallback');\nexport default touchPress;\n","import keyDownListener, { getModifierKey } from './keyDownListener';\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('keydown', keyDownListener);\n}\nfunction disable(element) {\n    element.removeEventListener('keydown', keyDownListener);\n}\nexport default {\n    enable,\n    disable,\n    getModifierKey,\n};\n","import { getEnabledElement, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nconst defaultState = {\n    renderingEngineId: undefined,\n    viewportId: undefined,\n    key: undefined,\n    keyCode: undefined,\n    element: null,\n};\nlet state = {\n    renderingEngineId: undefined,\n    viewportId: undefined,\n    key: undefined,\n    keyCode: undefined,\n    element: null,\n};\nfunction keyListener(evt) {\n    state.element = evt.currentTarget;\n    const enabledElement = getEnabledElement(state.element);\n    const { renderingEngineId, viewportId } = enabledElement;\n    state.renderingEngineId = renderingEngineId;\n    state.viewportId = viewportId;\n    state.key = evt.key;\n    state.keyCode = evt.keyCode;\n    evt.preventDefault();\n    const eventDetail = {\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        element: state.element,\n        key: state.key,\n        keyCode: state.keyCode,\n    };\n    triggerEvent(eventDetail.element, Events.KEY_DOWN, eventDetail);\n    document.addEventListener('keyup', _onKeyUp);\n    document.addEventListener('visibilitychange', _onVisibilityChange);\n    state.element.removeEventListener('keydown', keyListener);\n}\nfunction _onVisibilityChange() {\n    document.removeEventListener('visibilitychange', _onVisibilityChange);\n    if (document.visibilityState === 'hidden') {\n        resetModifierKey();\n    }\n}\nfunction _onKeyUp(evt) {\n    const eventDetail = {\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        element: state.element,\n        key: state.key,\n        keyCode: state.keyCode,\n    };\n    document.removeEventListener('keyup', _onKeyUp);\n    document.removeEventListener('visibilitychange', _onVisibilityChange);\n    state.element.addEventListener('keydown', keyListener);\n    state = structuredClone(defaultState);\n    triggerEvent(eventDetail.element, Events.KEY_UP, eventDetail);\n}\nexport function getModifierKey() {\n    return state.keyCode;\n}\nexport function resetModifierKey() {\n    state.keyCode = undefined;\n}\nexport default keyListener;\n","import { getEnabledElement } from '@cornerstonejs/core';\nexport default function getMouseEventPoints(evt, element) {\n    const elementToUse = element || evt.currentTarget;\n    const { viewport } = getEnabledElement(elementToUse) || {};\n    if (!viewport) {\n        return;\n    }\n    const clientPoint = _clientToPoint(evt);\n    const pagePoint = _pageToPoint(evt);\n    const canvasPoint = _pagePointsToCanvasPoints(elementToUse, pagePoint);\n    const worldPoint = viewport.canvasToWorld(canvasPoint);\n    return {\n        page: pagePoint,\n        client: clientPoint,\n        canvas: canvasPoint,\n        world: worldPoint,\n    };\n}\nfunction _pagePointsToCanvasPoints(element, pagePoint) {\n    const rect = element.getBoundingClientRect();\n    return [\n        pagePoint[0] - rect.left - window.pageXOffset,\n        pagePoint[1] - rect.top - window.pageYOffset,\n    ];\n}\nfunction _pageToPoint(evt) {\n    return [evt.pageX, evt.pageY];\n}\nfunction _clientToPoint(evt) {\n    return [evt.clientX, evt.clientY];\n}\n","import { getEnabledElement, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nimport getMouseEventPoints from './getMouseEventPoints';\nfunction mouseDoubleClickListener(evt) {\n    const element = evt.currentTarget;\n    const { viewportId, renderingEngineId } = getEnabledElement(element);\n    const startPoints = getMouseEventPoints(evt, element);\n    const deltaPoints = {\n        page: [0, 0],\n        client: [0, 0],\n        canvas: [0, 0],\n        world: [0, 0, 0],\n    };\n    const eventDetail = {\n        event: evt,\n        eventName: Events.MOUSE_DOUBLE_CLICK,\n        viewportId,\n        renderingEngineId,\n        camera: {},\n        element,\n        startPoints,\n        lastPoints: startPoints,\n        currentPoints: startPoints,\n        deltaPoints,\n    };\n    const consumed = !triggerEvent(element, Events.MOUSE_DOUBLE_CLICK, eventDetail);\n    if (consumed) {\n        evt.stopImmediatePropagation();\n        evt.preventDefault();\n    }\n}\nexport default mouseDoubleClickListener;\n","import { getEnabledElement, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nimport mouseMoveListener from './mouseMoveListener';\nimport getMouseEventPoints from './getMouseEventPoints';\nconst { MOUSE_DOWN, MOUSE_DOWN_ACTIVATE, MOUSE_CLICK, MOUSE_UP, MOUSE_DRAG } = Events;\nconst DOUBLE_CLICK_TOLERANCE_MS = 400;\nconst MULTI_BUTTON_TOLERANCE_MS = 150;\nconst DOUBLE_CLICK_DRAG_TOLERANCE = 3;\nconst defaultState = {\n    mouseButton: undefined,\n    element: null,\n    renderingEngineId: undefined,\n    viewportId: undefined,\n    isClickEvent: true,\n    clickDelay: 200,\n    preventClickTimeout: null,\n    startPoints: {\n        page: [0, 0],\n        client: [0, 0],\n        canvas: [0, 0],\n        world: [0, 0, 0],\n    },\n    lastPoints: {\n        page: [0, 0],\n        client: [0, 0],\n        canvas: [0, 0],\n        world: [0, 0, 0],\n    },\n};\nlet state = {\n    mouseButton: undefined,\n    renderingEngineId: undefined,\n    viewportId: undefined,\n    isClickEvent: true,\n    clickDelay: 200,\n    element: null,\n    preventClickTimeout: null,\n    startPoints: {\n        page: [0, 0],\n        client: [0, 0],\n        canvas: [0, 0],\n        world: [0, 0, 0],\n    },\n    lastPoints: {\n        page: [0, 0],\n        client: [0, 0],\n        canvas: [0, 0],\n        world: [0, 0, 0],\n    },\n};\nconst doubleClickState = {\n    doubleClickTimeout: null,\n    mouseDownEvent: null,\n    mouseUpEvent: null,\n    ignoreDoubleClick: false,\n};\nfunction mouseDownListener(evt) {\n    if (doubleClickState.doubleClickTimeout) {\n        if (evt.buttons === doubleClickState.mouseDownEvent.buttons) {\n            return;\n        }\n        doubleClickState.mouseDownEvent = evt;\n        _doStateMouseDownAndUp();\n        return;\n    }\n    doubleClickState.doubleClickTimeout = setTimeout(_doStateMouseDownAndUp, evt.buttons === 1 ? DOUBLE_CLICK_TOLERANCE_MS : MULTI_BUTTON_TOLERANCE_MS);\n    doubleClickState.mouseDownEvent = evt;\n    doubleClickState.ignoreDoubleClick = false;\n    state.element = evt.currentTarget;\n    state.mouseButton = evt.buttons;\n    const enabledElement = getEnabledElement(state.element);\n    const { renderingEngineId, viewportId } = enabledElement;\n    state.renderingEngineId = renderingEngineId;\n    state.viewportId = viewportId;\n    state.preventClickTimeout = setTimeout(_preventClickHandler, state.clickDelay);\n    state.element.removeEventListener('mousemove', mouseMoveListener);\n    const startPoints = getMouseEventPoints(evt, state.element);\n    state.startPoints = _copyPoints(startPoints);\n    state.lastPoints = _copyPoints(startPoints);\n    document.addEventListener('mouseup', _onMouseUp);\n    document.addEventListener('mousemove', _onMouseDrag);\n}\nfunction _doMouseDown(evt) {\n    const deltaPoints = _getDeltaPoints(state.startPoints, state.startPoints);\n    const eventDetail = {\n        event: evt,\n        eventName: MOUSE_DOWN,\n        element: state.element,\n        mouseButton: state.mouseButton,\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        camera: {},\n        startPoints: state.startPoints,\n        lastPoints: state.startPoints,\n        currentPoints: state.startPoints,\n        deltaPoints,\n    };\n    state.lastPoints = _copyPoints(eventDetail.lastPoints);\n    const notConsumed = triggerEvent(eventDetail.element, MOUSE_DOWN, eventDetail);\n    if (notConsumed) {\n        triggerEvent(eventDetail.element, MOUSE_DOWN_ACTIVATE, eventDetail);\n    }\n}\nfunction _onMouseDrag(evt) {\n    const enabledElement = getEnabledElement(state.element);\n    if (!enabledElement?.viewport) {\n        return;\n    }\n    const currentPoints = getMouseEventPoints(evt, state.element);\n    const lastPoints = _updateMouseEventsLastPoints(state.element, state.lastPoints);\n    const deltaPoints = _getDeltaPoints(currentPoints, lastPoints);\n    if (doubleClickState.doubleClickTimeout) {\n        if (_isDragPastDoubleClickTolerance(deltaPoints.canvas)) {\n            _doStateMouseDownAndUp();\n        }\n        else {\n            return;\n        }\n    }\n    const eventDetail = {\n        event: evt,\n        eventName: MOUSE_DRAG,\n        mouseButton: state.mouseButton,\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        camera: {},\n        element: state.element,\n        startPoints: _copyPoints(state.startPoints),\n        lastPoints: _copyPoints(lastPoints),\n        currentPoints,\n        deltaPoints,\n    };\n    const consumed = !triggerEvent(state.element, MOUSE_DRAG, eventDetail);\n    if (consumed) {\n        evt.stopImmediatePropagation();\n        evt.preventDefault();\n    }\n    state.lastPoints = _copyPoints(currentPoints);\n}\nfunction _onMouseUp(evt) {\n    clearTimeout(state.preventClickTimeout);\n    if (doubleClickState.doubleClickTimeout) {\n        if (!doubleClickState.mouseUpEvent) {\n            doubleClickState.mouseUpEvent = evt;\n            state.element.addEventListener('mousemove', _onMouseMove);\n        }\n        else {\n            _cleanUp();\n        }\n    }\n    else {\n        const eventName = state.isClickEvent ? MOUSE_CLICK : MOUSE_UP;\n        const currentPoints = getMouseEventPoints(evt, state.element);\n        const deltaPoints = _getDeltaPoints(currentPoints, state.lastPoints);\n        const eventDetail = {\n            event: evt,\n            eventName,\n            mouseButton: state.mouseButton,\n            element: state.element,\n            renderingEngineId: state.renderingEngineId,\n            viewportId: state.viewportId,\n            camera: {},\n            startPoints: _copyPoints(state.startPoints),\n            lastPoints: _copyPoints(state.lastPoints),\n            currentPoints,\n            deltaPoints,\n        };\n        triggerEvent(eventDetail.element, eventName, eventDetail);\n        _cleanUp();\n    }\n    document.removeEventListener('mousemove', _onMouseDrag);\n}\nfunction _onMouseMove(evt) {\n    const currentPoints = getMouseEventPoints(evt, state.element);\n    const lastPoints = _updateMouseEventsLastPoints(state.element, state.lastPoints);\n    const deltaPoints = _getDeltaPoints(currentPoints, lastPoints);\n    if (!_isDragPastDoubleClickTolerance(deltaPoints.canvas)) {\n        return;\n    }\n    _doStateMouseDownAndUp();\n    mouseMoveListener(evt);\n}\nfunction _isDragPastDoubleClickTolerance(delta) {\n    return Math.abs(delta[0]) + Math.abs(delta[1]) > DOUBLE_CLICK_DRAG_TOLERANCE;\n}\nfunction _preventClickHandler() {\n    state.isClickEvent = false;\n}\nfunction _doStateMouseDownAndUp() {\n    doubleClickState.ignoreDoubleClick = true;\n    const mouseDownEvent = doubleClickState.mouseDownEvent;\n    const mouseUpEvent = doubleClickState.mouseUpEvent;\n    _clearDoubleClickTimeoutAndEvents();\n    _doMouseDown(mouseDownEvent);\n    if (mouseUpEvent) {\n        _onMouseUp(mouseUpEvent);\n    }\n}\nfunction _clearDoubleClickTimeoutAndEvents() {\n    if (doubleClickState.doubleClickTimeout) {\n        clearTimeout(doubleClickState.doubleClickTimeout);\n        doubleClickState.doubleClickTimeout = null;\n    }\n    doubleClickState.mouseDownEvent = null;\n    doubleClickState.mouseUpEvent = null;\n}\nfunction _cleanUp() {\n    document.removeEventListener('mouseup', _onMouseUp);\n    state.element?.removeEventListener('mousemove', _onMouseMove);\n    state.element?.addEventListener('mousemove', mouseMoveListener);\n    _clearDoubleClickTimeoutAndEvents();\n    state = JSON.parse(JSON.stringify(defaultState));\n}\nfunction _copyPoints(points) {\n    return JSON.parse(JSON.stringify(points));\n}\nfunction _updateMouseEventsLastPoints(element, lastPoints) {\n    const { viewport } = getEnabledElement(element) || {};\n    if (!viewport) {\n        return lastPoints;\n    }\n    const world = viewport.canvasToWorld(lastPoints.canvas);\n    return {\n        page: lastPoints.page,\n        client: lastPoints.client,\n        canvas: lastPoints.canvas,\n        world,\n    };\n}\nfunction _getDeltaPoints(currentPoints, lastPoints) {\n    if (!currentPoints || !lastPoints) {\n        return {\n            page: [0, 0],\n            client: [0, 0],\n            canvas: [0, 0],\n            world: [0, 0, 0],\n        };\n    }\n    return {\n        page: _subtractPoints2D(currentPoints.page, lastPoints.page),\n        client: _subtractPoints2D(currentPoints.client, lastPoints.client),\n        canvas: _subtractPoints2D(currentPoints.canvas, lastPoints.canvas),\n        world: _subtractPoints3D(currentPoints.world, lastPoints.world),\n    };\n}\nfunction _subtractPoints2D(point0, point1) {\n    return [point0[0] - point1[0], point0[1] - point1[1]];\n}\nfunction _subtractPoints3D(point0, point1) {\n    return [point0[0] - point1[0], point0[1] - point1[1], point0[2] - point1[2]];\n}\nexport function getMouseButton() {\n    return state.mouseButton;\n}\nexport function mouseDoubleClickIgnoreListener(evt) {\n    if (doubleClickState.ignoreDoubleClick) {\n        doubleClickState.ignoreDoubleClick = false;\n        evt.stopImmediatePropagation();\n        evt.preventDefault();\n    }\n    else {\n        _cleanUp();\n    }\n}\nexport default mouseDownListener;\n","import { getEnabledElement, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nimport getMouseEventPoints from './getMouseEventPoints';\nconst eventName = Events.MOUSE_MOVE;\nfunction mouseMoveListener(evt) {\n    const element = evt.currentTarget;\n    const enabledElement = getEnabledElement(element);\n    if (!enabledElement) {\n        return;\n    }\n    const { renderingEngineId, viewportId } = enabledElement;\n    const currentPoints = getMouseEventPoints(evt);\n    const eventDetail = {\n        renderingEngineId,\n        viewportId,\n        camera: {},\n        element,\n        currentPoints,\n        eventName,\n        event: evt,\n    };\n    const consumed = !triggerEvent(element, eventName, eventDetail);\n    if (consumed) {\n        evt.stopImmediatePropagation();\n        evt.preventDefault();\n    }\n}\nexport default mouseMoveListener;\n","const antiGhostDelay = 2000, pointerType = {\n    mouse: 0,\n    touch: 1,\n};\nlet lastInteractionType, lastInteractionTime;\nfunction handleTap(type, e) {\n    const now = Date.now();\n    if (type !== lastInteractionType) {\n        if (now - lastInteractionTime <= antiGhostDelay) {\n            e.preventDefault();\n            e.stopPropagation();\n            e.stopImmediatePropagation();\n            return false;\n        }\n        lastInteractionType = type;\n    }\n    lastInteractionTime = now;\n}\nconst handleTapMouse = handleTap.bind(null, pointerType.mouse);\nconst handleTapTouch = handleTap.bind(null, pointerType.touch);\nfunction attachEvents(element, eventList, interactionType) {\n    const tapHandler = interactionType ? handleTapMouse : handleTapTouch;\n    eventList.forEach(function (eventName) {\n        element.addEventListener(eventName, tapHandler, { passive: false });\n    });\n}\nfunction removeEvents(element, eventList, interactionType) {\n    const tapHandler = interactionType ? handleTapMouse : handleTapTouch;\n    eventList.forEach(function (eventName) {\n        element.removeEventListener(eventName, tapHandler);\n    });\n}\nconst mouseEvents = ['mousedown', 'mouseup', 'mousemove'];\nconst touchEvents = ['touchstart', 'touchend'];\nfunction disable(element) {\n    removeEvents(element, mouseEvents, pointerType.mouse);\n    removeEvents(element, touchEvents, pointerType.touch);\n}\nfunction enable(element) {\n    disable(element);\n    attachEvents(element, mouseEvents, pointerType.mouse);\n    attachEvents(element, touchEvents, pointerType.touch);\n}\nexport default {\n    enable,\n    disable,\n};\n","import { getEnabledElement } from '@cornerstonejs/core';\nexport default function getTouchEventPoints(evt, element) {\n    const elementToUse = element || evt.currentTarget;\n    const touches = evt.type === 'touchend' ? evt.changedTouches : evt.touches;\n    return Object.keys(touches).map((i) => {\n        const clientPoint = _clientToPoint(touches[i]);\n        const pagePoint = _pageToPoint(touches[i]);\n        const canvasPoint = _pagePointsToCanvasPoints(elementToUse, pagePoint);\n        const { viewport } = getEnabledElement(elementToUse);\n        const worldPoint = viewport.canvasToWorld(canvasPoint);\n        return {\n            page: pagePoint,\n            client: clientPoint,\n            canvas: canvasPoint,\n            world: worldPoint,\n            touch: {\n                identifier: i,\n                radiusX: touches[i].radiusX,\n                radiusY: touches[i].radiusY,\n                force: touches[i].force,\n                rotationAngle: touches[i].rotationAngle,\n            },\n        };\n    });\n}\nfunction _pagePointsToCanvasPoints(element, pagePoint) {\n    const rect = element.getBoundingClientRect();\n    return [\n        pagePoint[0] - rect.left - window.pageXOffset,\n        pagePoint[1] - rect.top - window.pageYOffset,\n    ];\n}\nfunction _pageToPoint(touch) {\n    return [touch.pageX, touch.pageY];\n}\nfunction _clientToPoint(touch) {\n    return [touch.clientX, touch.clientY];\n}\n","import { getEnabledElement, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nimport { Swipe } from '../../enums/Touch';\nimport getTouchEventPoints from './getTouchEventPoints';\nimport { copyPoints, copyPointsList, getDeltaDistanceBetweenIPoints, getDeltaDistance, getDeltaPoints, getMeanTouchPoints, } from '../../utilities/touch';\nimport { Settings } from '@cornerstonejs/core';\nconst runtimeSettings = Settings.getRuntimeSettings();\nconst { TOUCH_START, TOUCH_START_ACTIVATE, TOUCH_PRESS, TOUCH_DRAG, TOUCH_END, TOUCH_TAP, TOUCH_SWIPE, } = Events;\nconst zeroIPoint = {\n    page: [0, 0],\n    client: [0, 0],\n    canvas: [0, 0],\n    world: [0, 0, 0],\n};\nconst zeroIDistance = {\n    page: 0,\n    client: 0,\n    canvas: 0,\n    world: 0,\n};\nconst defaultState = {\n    renderingEngineId: undefined,\n    viewportId: undefined,\n    element: null,\n    startPointsList: [\n        {\n            ...zeroIPoint,\n            touch: null,\n        },\n    ],\n    lastPointsList: [\n        {\n            ...zeroIPoint,\n            touch: null,\n        },\n    ],\n    isTouchStart: false,\n    startTime: null,\n    pressTimeout: null,\n    pressDelay: 700,\n    pressMaxDistance: 5,\n    accumulatedDistance: zeroIDistance,\n    swipeDistanceThreshold: 48,\n    swiped: false,\n    swipeToleranceMs: 300,\n};\nconst defaultTapState = {\n    renderingEngineId: undefined,\n    viewportId: undefined,\n    element: null,\n    startPointsList: [\n        {\n            ...zeroIPoint,\n            touch: null,\n        },\n    ],\n    taps: 0,\n    tapTimeout: null,\n    tapMaxDistance: 24,\n    tapToleranceMs: 300,\n};\nlet state = JSON.parse(JSON.stringify(defaultState));\nlet tapState = JSON.parse(JSON.stringify(defaultTapState));\nfunction triggerEventCallback(ele, name, eventDetail) {\n    return triggerEvent(ele, name, eventDetail);\n}\nfunction touchStartListener(evt) {\n    state.element = evt.currentTarget;\n    const enabledElement = getEnabledElement(state.element);\n    const { renderingEngineId, viewportId } = enabledElement;\n    state.renderingEngineId = renderingEngineId;\n    state.viewportId = viewportId;\n    if (state.isTouchStart) {\n        return;\n    }\n    clearTimeout(state.pressTimeout);\n    state.pressTimeout = setTimeout(() => _onTouchPress(evt), state.pressDelay);\n    _onTouchStart(evt);\n    document.addEventListener('touchmove', _onTouchDrag);\n    document.addEventListener('touchend', _onTouchEnd);\n}\nfunction _onTouchPress(evt) {\n    const totalDistance = state.accumulatedDistance.canvas;\n    if (totalDistance > state.pressMaxDistance) {\n        return;\n    }\n    const eventDetail = {\n        event: evt,\n        eventName: TOUCH_PRESS,\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        camera: {},\n        element: state.element,\n        startPointsList: copyPointsList(state.startPointsList),\n        lastPointsList: copyPointsList(state.lastPointsList),\n        startPoints: copyPoints(getMeanTouchPoints(state.startPointsList)),\n        lastPoints: copyPoints(getMeanTouchPoints(state.lastPointsList)),\n    };\n    triggerEventCallback(eventDetail.element, TOUCH_PRESS, eventDetail);\n}\nfunction _onTouchStart(evt) {\n    state.isTouchStart = true;\n    state.startTime = new Date();\n    const startPointsList = getTouchEventPoints(evt, state.element);\n    const startPoints = getMeanTouchPoints(startPointsList);\n    const deltaPoints = zeroIPoint;\n    const deltaDistance = zeroIDistance;\n    const eventDetail = {\n        event: evt,\n        eventName: TOUCH_START,\n        element: state.element,\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        camera: {},\n        startPointsList: startPointsList,\n        lastPointsList: startPointsList,\n        currentPointsList: startPointsList,\n        startPoints: startPoints,\n        lastPoints: startPoints,\n        currentPoints: startPoints,\n        deltaPoints,\n        deltaDistance,\n    };\n    state.startPointsList = copyPointsList(eventDetail.startPointsList);\n    state.lastPointsList = copyPointsList(eventDetail.lastPointsList);\n    const eventDidPropagate = triggerEventCallback(eventDetail.element, TOUCH_START, eventDetail);\n    if (eventDidPropagate) {\n        triggerEventCallback(eventDetail.element, TOUCH_START_ACTIVATE, eventDetail);\n    }\n}\nfunction _onTouchDrag(evt) {\n    const currentPointsList = getTouchEventPoints(evt, state.element);\n    const lastPointsList = _updateTouchEventsLastPoints(state.element, state.lastPointsList);\n    const deltaPoints = currentPointsList.length === lastPointsList.length\n        ? getDeltaPoints(currentPointsList, lastPointsList)\n        : zeroIPoint;\n    const deltaDistance = currentPointsList.length === lastPointsList.length\n        ? getDeltaDistanceBetweenIPoints(currentPointsList, lastPointsList)\n        : zeroIDistance;\n    const totalDistance = currentPointsList.length === lastPointsList.length\n        ? getDeltaDistance(currentPointsList, state.lastPointsList)\n        : zeroIDistance;\n    state.accumulatedDistance = {\n        page: state.accumulatedDistance.page + totalDistance.page,\n        client: state.accumulatedDistance.client + totalDistance.client,\n        canvas: state.accumulatedDistance.canvas + totalDistance.canvas,\n        world: state.accumulatedDistance.world + totalDistance.world,\n    };\n    const eventDetail = {\n        event: evt,\n        eventName: TOUCH_DRAG,\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        camera: {},\n        element: state.element,\n        startPoints: getMeanTouchPoints(state.startPointsList),\n        lastPoints: getMeanTouchPoints(lastPointsList),\n        currentPoints: getMeanTouchPoints(currentPointsList),\n        startPointsList: copyPointsList(state.startPointsList),\n        lastPointsList: copyPointsList(lastPointsList),\n        currentPointsList,\n        deltaPoints: deltaPoints,\n        deltaDistance: deltaDistance,\n    };\n    triggerEventCallback(state.element, TOUCH_DRAG, eventDetail);\n    _checkTouchSwipe(evt, deltaPoints);\n    state.lastPointsList = copyPointsList(currentPointsList);\n}\nfunction _onTouchEnd(evt) {\n    clearTimeout(state.pressTimeout);\n    const currentPointsList = getTouchEventPoints(evt, state.element);\n    const lastPointsList = _updateTouchEventsLastPoints(state.element, state.lastPointsList);\n    const deltaPoints = currentPointsList.length === lastPointsList.length\n        ? getDeltaPoints(currentPointsList, lastPointsList)\n        : getDeltaPoints(currentPointsList, currentPointsList);\n    const deltaDistance = currentPointsList.length === lastPointsList.length\n        ? getDeltaDistanceBetweenIPoints(currentPointsList, lastPointsList)\n        : getDeltaDistanceBetweenIPoints(currentPointsList, currentPointsList);\n    const eventDetail = {\n        event: evt,\n        eventName: TOUCH_END,\n        element: state.element,\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        camera: {},\n        startPointsList: copyPointsList(state.startPointsList),\n        lastPointsList: copyPointsList(lastPointsList),\n        currentPointsList,\n        startPoints: getMeanTouchPoints(state.startPointsList),\n        lastPoints: getMeanTouchPoints(lastPointsList),\n        currentPoints: getMeanTouchPoints(currentPointsList),\n        deltaPoints,\n        deltaDistance,\n    };\n    triggerEventCallback(eventDetail.element, TOUCH_END, eventDetail);\n    _checkTouchTap(evt);\n    state = JSON.parse(JSON.stringify(defaultState));\n    document.removeEventListener('touchmove', _onTouchDrag);\n    document.removeEventListener('touchend', _onTouchEnd);\n}\nfunction _checkTouchTap(evt) {\n    const currentTime = new Date().getTime();\n    const startTime = state.startTime.getTime();\n    if (currentTime - startTime > tapState.tapToleranceMs) {\n        return;\n    }\n    if (tapState.taps === 0) {\n        tapState.element = state.element;\n        tapState.renderingEngineId = state.renderingEngineId;\n        tapState.viewportId = state.viewportId;\n        tapState.startPointsList = state.startPointsList;\n    }\n    if (tapState.taps > 0 &&\n        !(tapState.element == state.element &&\n            tapState.renderingEngineId == state.renderingEngineId &&\n            tapState.viewportId == state.viewportId)) {\n        return;\n    }\n    const currentPointsList = getTouchEventPoints(evt, tapState.element);\n    const distanceFromStart = getDeltaDistance(currentPointsList, tapState.startPointsList).canvas;\n    if (distanceFromStart > tapState.tapMaxDistance) {\n        return;\n    }\n    clearTimeout(tapState.tapTimeout);\n    tapState.taps += 1;\n    tapState.tapTimeout = setTimeout(() => {\n        const eventDetail = {\n            event: evt,\n            eventName: TOUCH_TAP,\n            element: tapState.element,\n            renderingEngineId: tapState.renderingEngineId,\n            viewportId: tapState.viewportId,\n            camera: {},\n            currentPointsList,\n            currentPoints: getMeanTouchPoints(currentPointsList),\n            taps: tapState.taps,\n        };\n        triggerEventCallback(eventDetail.element, TOUCH_TAP, eventDetail);\n        tapState = JSON.parse(JSON.stringify(defaultTapState));\n    }, tapState.tapToleranceMs);\n}\nfunction _checkTouchSwipe(evt, deltaPoints) {\n    const currentTime = new Date().getTime();\n    const startTime = state.startTime.getTime();\n    if (state.swiped || currentTime - startTime > state.swipeToleranceMs) {\n        return;\n    }\n    const [x, y] = deltaPoints.canvas;\n    const eventDetail = {\n        event: evt,\n        eventName: TOUCH_SWIPE,\n        renderingEngineId: state.renderingEngineId,\n        viewportId: state.viewportId,\n        camera: {},\n        element: state.element,\n        swipe: null,\n    };\n    if (Math.abs(x) > state.swipeDistanceThreshold) {\n        eventDetail.swipe = x > 0 ? Swipe.RIGHT : Swipe.LEFT;\n        triggerEventCallback(eventDetail.element, TOUCH_SWIPE, eventDetail);\n        state.swiped = true;\n    }\n    if (Math.abs(y) > state.swipeDistanceThreshold) {\n        eventDetail.swipe = y > 0 ? Swipe.DOWN : Swipe.UP;\n        triggerEventCallback(eventDetail.element, TOUCH_SWIPE, eventDetail);\n        state.swiped = true;\n    }\n}\nfunction _updateTouchEventsLastPoints(element, lastPoints) {\n    const { viewport } = getEnabledElement(element);\n    return lastPoints.map((lp) => {\n        const world = viewport.canvasToWorld(lp.canvas);\n        return {\n            page: lp.page,\n            client: lp.client,\n            canvas: lp.canvas,\n            world,\n            touch: lp.touch,\n        };\n    });\n}\nexport default touchStartListener;\n","import { getEnabledElement, triggerEvent } from '@cornerstonejs/core';\nimport normalizeWheel from './normalizeWheel';\nimport Events from '../../enums/Events';\nimport getMouseEventPoints from '../mouse/getMouseEventPoints';\nfunction wheelListener(evt) {\n    const element = evt.currentTarget;\n    const enabledElement = getEnabledElement(element);\n    const { renderingEngineId, viewportId } = enabledElement;\n    if (evt.deltaY > -1 && evt.deltaY < 1) {\n        return;\n    }\n    evt.preventDefault();\n    const { spinX, spinY, pixelX, pixelY } = normalizeWheel(evt);\n    const direction = spinY < 0 ? -1 : 1;\n    const eventDetail = {\n        event: evt,\n        eventName: Events.MOUSE_WHEEL,\n        renderingEngineId,\n        viewportId,\n        element,\n        camera: {},\n        detail: evt,\n        wheel: {\n            spinX,\n            spinY,\n            pixelX,\n            pixelY,\n            direction,\n        },\n        points: getMouseEventPoints(evt),\n    };\n    triggerEvent(element, Events.MOUSE_WHEEL, eventDetail);\n}\nexport default wheelListener;\n","const PIXEL_STEP = 10;\nconst LINE_HEIGHT = 40;\nconst PAGE_HEIGHT = 800;\nexport default function normalizeWheel(event) {\n    let spinX = 0, spinY = 0, pixelX = 0, pixelY = 0;\n    if ('detail' in event) {\n        spinY = event.detail;\n    }\n    if ('wheelDelta' in event) {\n        spinY = -event.wheelDelta / 120;\n    }\n    if ('wheelDeltaY' in event) {\n        spinY = -event.wheelDeltaY / 120;\n    }\n    if ('wheelDeltaX' in event) {\n        spinX = -event.wheelDeltaX / 120;\n    }\n    pixelX = spinX * PIXEL_STEP;\n    pixelY = spinY * PIXEL_STEP;\n    if ('deltaY' in event) {\n        pixelY = event.deltaY;\n    }\n    if ('deltaX' in event) {\n        pixelX = event.deltaX;\n    }\n    if ((pixelX || pixelY) && event.deltaMode) {\n        if (event.deltaMode === 1) {\n            pixelX *= LINE_HEIGHT;\n            pixelY *= LINE_HEIGHT;\n        }\n        else {\n            pixelX *= PAGE_HEIGHT;\n            pixelY *= PAGE_HEIGHT;\n        }\n    }\n    if (pixelX && !spinX) {\n        spinX = pixelX < 1 ? -1 : 1;\n    }\n    if (pixelY && !spinY) {\n        spinY = pixelY < 1 ? -1 : 1;\n    }\n    return {\n        spinX,\n        spinY,\n        pixelX,\n        pixelY,\n    };\n}\n","import { internalConvertStackToVolumeLabelmap } from '../SegmentationStateManager';\nimport { triggerSegmentationModified } from '../triggerSegmentationEvents';\nexport async function convertStackToVolumeLabelmap(args) {\n    const result = internalConvertStackToVolumeLabelmap(args);\n    triggerSegmentationModified(args.segmentationId);\n    return result;\n}\n","import { cache, eventTarget } from '@cornerstonejs/core';\nimport { Events, SegmentationRepresentations } from '../../../enums';\nimport { getSegmentation } from '../getSegmentation';\nimport { triggerSegmentationDataModified } from '../triggerSegmentationEvents';\nimport { addSegmentationRepresentations } from '../addSegmentationRepresentationsToViewport';\nexport async function updateStackSegmentationState({ segmentationId, viewportId, imageIds, options, }) {\n    const segmentation = getSegmentation(segmentationId);\n    if (options?.removeOriginal) {\n        const data = segmentation.representationData\n            .Labelmap;\n        if (cache.getVolume(data.volumeId)) {\n            cache.removeVolumeLoadObject(data.volumeId);\n        }\n        segmentation.representationData.Labelmap = {\n            imageIds,\n        };\n    }\n    else {\n        segmentation.representationData.Labelmap = {\n            ...segmentation.representationData.Labelmap,\n            imageIds,\n        };\n    }\n    await addSegmentationRepresentations(viewportId, [\n        {\n            segmentationId,\n            type: SegmentationRepresentations.Labelmap,\n        },\n    ]);\n    eventTarget.addEventListenerOnce(Events.SEGMENTATION_RENDERED, () => triggerSegmentationDataModified(segmentationId));\n}\n","export default function filterMoveableAnnotationTools(element, ToolAndAnnotations, canvasCoords, interactionType = 'mouse') {\n    const proximity = interactionType === 'touch' ? 36 : 6;\n    const moveableAnnotationTools = [];\n    ToolAndAnnotations.forEach(({ tool, annotations }) => {\n        for (const annotation of annotations) {\n            if (annotation.isLocked || !annotation.isVisible) {\n                continue;\n            }\n            const near = tool.isPointNearTool(element, annotation, canvasCoords, proximity, interactionType);\n            if (near) {\n                moveableAnnotationTools.push({\n                    tool,\n                    annotation,\n                });\n                break;\n            }\n        }\n    });\n    return moveableAnnotationTools;\n}\n","import { getAnnotations } from '../stateManagement/annotation/annotationState';\nexport default function filterToolsWithAnnotationsForElement(element, tools) {\n    const result = [];\n    for (let i = 0; i < tools.length; i++) {\n        const tool = tools[i];\n        if (!tool) {\n            console.warn('undefined tool in filterToolsWithAnnotationsForElement');\n            continue;\n        }\n        let annotations = getAnnotations(tool.constructor.toolName, element);\n        if (!annotations?.length) {\n            continue;\n        }\n        if (typeof tool.filterInteractableAnnotationsForElement === 'function') {\n            annotations = tool.filterInteractableAnnotationsForElement(element, annotations);\n        }\n        if (annotations?.length > 0) {\n            result.push({ tool, annotations });\n        }\n    }\n    return result;\n}\n","export default function filterToolsWithMoveableHandles(element, ToolAndAnnotations, canvasCoords, interactionType = 'mouse') {\n    const proximity = interactionType === 'touch' ? 36 : 6;\n    const toolsWithMoveableHandles = [];\n    ToolAndAnnotations.forEach(({ tool, annotations }) => {\n        for (const annotation of annotations) {\n            if (annotation.isLocked || !annotation.isVisible) {\n                continue;\n            }\n            const handle = tool.getHandleNearImagePoint(element, annotation, canvasCoords, proximity);\n            if (handle) {\n                toolsWithMoveableHandles.push({\n                    tool,\n                    annotation,\n                    handle,\n                });\n                break;\n            }\n        }\n    });\n    return toolsWithMoveableHandles;\n}\n","import { vec3 } from 'gl-matrix';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { distancePointToContour } from '../distancePointToContour';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { point } from '../../utilities/math';\nclass CircleSculptCursor {\n    constructor() {\n        this.toolInfo = {\n            toolSize: null,\n            maxToolSize: null,\n        };\n    }\n    static { this.shapeName = 'Circle'; }\n    static { this.CHAIN_MAINTENANCE_ITERATIONS = 3; }\n    static { this.CHAIN_PULL_STRENGTH_FACTOR = 0.3; }\n    static { this.MAX_INTER_DISTANCE_FACTOR = 1.2; }\n    renderShape(svgDrawingHelper, canvasLocation, options) {\n        const circleUID = '0';\n        drawCircleSvg(svgDrawingHelper, 'SculptorTool', circleUID, canvasLocation, this.toolInfo.toolSize, options);\n    }\n    pushHandles(viewport, sculptData) {\n        const { points, mouseCanvasPoint } = sculptData;\n        const pushedHandles = { first: undefined, last: undefined };\n        const worldRadius = point.distanceToPoint(viewport.canvasToWorld(mouseCanvasPoint), viewport.canvasToWorld([\n            mouseCanvasPoint[0] + this.toolInfo.toolSize,\n            mouseCanvasPoint[1],\n        ]));\n        for (let i = 0; i < points.length; i++) {\n            const handleCanvasPoint = viewport.worldToCanvas(points[i]);\n            const distanceToHandle = point.distanceToPoint(handleCanvasPoint, mouseCanvasPoint);\n            if (distanceToHandle > this.toolInfo.toolSize) {\n                continue;\n            }\n            this.pushOneHandle(i, worldRadius, sculptData);\n            if (pushedHandles.first === undefined) {\n                pushedHandles.first = i;\n                pushedHandles.last = i;\n            }\n            else {\n                pushedHandles.last = i;\n            }\n        }\n        if (pushedHandles.first !== undefined && pushedHandles.last !== undefined) {\n            for (let i = 0; i < CircleSculptCursor.CHAIN_MAINTENANCE_ITERATIONS; i++) {\n                this.maintainChainStructure(sculptData, pushedHandles);\n            }\n        }\n        return pushedHandles;\n    }\n    configureToolSize(evt) {\n        const toolInfo = this.toolInfo;\n        if (toolInfo.toolSize && toolInfo.maxToolSize) {\n            return;\n        }\n        const eventData = evt.detail;\n        const element = eventData.element;\n        const minDim = Math.min(element.clientWidth, element.clientHeight);\n        const maxRadius = minDim / 12;\n        toolInfo.toolSize = maxRadius;\n        toolInfo.maxToolSize = maxRadius;\n    }\n    updateToolSize(canvasCoords, viewport, activeAnnotation) {\n        const toolInfo = this.toolInfo;\n        const radius = distancePointToContour(viewport, activeAnnotation, canvasCoords);\n        if (radius > 0) {\n            toolInfo.toolSize = Math.min(toolInfo.maxToolSize, radius);\n        }\n    }\n    getMaxSpacing(minSpacing) {\n        return Math.max(this.toolInfo.toolSize / 4, minSpacing);\n    }\n    getInsertPosition(previousIndex, nextIndex, sculptData) {\n        let insertPosition;\n        const { points, element, mouseCanvasPoint } = sculptData;\n        const toolSize = this.toolInfo.toolSize;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const previousCanvasPoint = viewport.worldToCanvas(points[previousIndex]);\n        const nextCanvasPoint = viewport.worldToCanvas(points[nextIndex]);\n        const midPoint = [\n            (previousCanvasPoint[0] + nextCanvasPoint[0]) / 2.0,\n            (previousCanvasPoint[1] + nextCanvasPoint[1]) / 2.0,\n        ];\n        const distanceToMidPoint = point.distanceToPoint(mouseCanvasPoint, midPoint);\n        if (distanceToMidPoint < toolSize) {\n            const directionUnitVector = {\n                x: (midPoint[0] - mouseCanvasPoint[0]) / distanceToMidPoint,\n                y: (midPoint[1] - mouseCanvasPoint[1]) / distanceToMidPoint,\n            };\n            insertPosition = [\n                mouseCanvasPoint[0] + toolSize * directionUnitVector.x,\n                mouseCanvasPoint[1] + toolSize * directionUnitVector.y,\n            ];\n        }\n        else {\n            insertPosition = midPoint;\n        }\n        const worldPosition = viewport.canvasToWorld(insertPosition);\n        return worldPosition;\n    }\n    pushOneHandle(i, worldRadius, sculptData) {\n        const { points, mousePoint } = sculptData;\n        const handle = points[i];\n        const directionUnitVector = this.directionalVector(mousePoint, handle);\n        const position = vec3.scaleAndAdd(vec3.create(), mousePoint, directionUnitVector, worldRadius);\n        handle[0] = position[0];\n        handle[1] = position[1];\n        handle[2] = position[2];\n    }\n    directionalVector(p1, p2) {\n        return vec3.normalize(vec3.create(), [\n            p2[0] - p1[0],\n            p2[1] - p1[1],\n            p2[2] - p1[2],\n        ]);\n    }\n    calculateMeanConsecutiveDistance(points) {\n        if (points.length < 2) {\n            return 0;\n        }\n        let totalDistance = 0;\n        const numPoints = points.length;\n        for (let i = 0; i < numPoints; i++) {\n            const nextIndex = (i + 1) % numPoints;\n            const distance = point.distanceToPoint(points[i], points[nextIndex]);\n            totalDistance += distance;\n        }\n        return totalDistance / numPoints;\n    }\n    maintainChainStructure(sculptData, pushedHandles) {\n        const { points } = sculptData;\n        const first = pushedHandles.first;\n        const last = pushedHandles.last;\n        const mean = Math.round((first + last) / 2);\n        const numPoints = points.length;\n        if (!sculptData.meanDistance) {\n            sculptData.meanDistance = this.calculateMeanConsecutiveDistance(points);\n        }\n        const maxInterDistance = sculptData.meanDistance * CircleSculptCursor.MAX_INTER_DISTANCE_FACTOR;\n        for (let i = mean; i >= 0; i--) {\n            if (i >= numPoints - 1 || i < 0) {\n                continue;\n            }\n            const nextIndex = i + 1;\n            const distanceToNext = point.distanceToPoint(points[i], points[nextIndex]);\n            if (distanceToNext > maxInterDistance) {\n                const pullDirection = this.directionalVector(points[i], points[nextIndex]);\n                const pullStrength = (distanceToNext - sculptData.meanDistance) / sculptData.meanDistance;\n                const adjustmentMagnitude = pullStrength *\n                    sculptData.meanDistance *\n                    CircleSculptCursor.CHAIN_PULL_STRENGTH_FACTOR;\n                points[i][0] += pullDirection[0] * adjustmentMagnitude;\n                points[i][1] += pullDirection[1] * adjustmentMagnitude;\n                points[i][2] += pullDirection[2] * adjustmentMagnitude;\n            }\n        }\n        for (let i = mean + 1; i < numPoints; i++) {\n            if (i >= numPoints || i <= 0) {\n                continue;\n            }\n            const previousIndex = i - 1;\n            const distanceToPrevious = point.distanceToPoint(points[i], points[previousIndex]);\n            if (distanceToPrevious > maxInterDistance) {\n                const pullDirection = this.directionalVector(points[i], points[previousIndex]);\n                const pullStrength = (distanceToPrevious - sculptData.meanDistance) /\n                    sculptData.meanDistance;\n                const adjustmentMagnitude = pullStrength *\n                    sculptData.meanDistance *\n                    CircleSculptCursor.CHAIN_PULL_STRENGTH_FACTOR;\n                points[i][0] += pullDirection[0] * adjustmentMagnitude;\n                points[i][1] += pullDirection[1] * adjustmentMagnitude;\n                points[i][2] += pullDirection[2] * adjustmentMagnitude;\n            }\n        }\n    }\n}\nexport default CircleSculptCursor;\n","import { getEnabledElement, utilities as csUtils, cache, getRenderingEngine, volumeLoader, imageLoader, ImageVolume, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { SegmentationRepresentations } from '../../enums';\nimport { segmentIndex as segmentIndexController, state as segmentationState, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { DEFAULT_POSITIVE_STD_DEV_MULTIPLIER, DEFAULT_NEGATIVE_SEED_MARGIN, } from '../../utilities/segmentation/growCut/constants';\nimport { getSVGStyleForSegment } from '../../utilities/segmentation/getSVGStyleForSegment';\nimport IslandRemoval from '../../utilities/segmentation/islandRemoval';\nimport { getOrCreateSegmentationVolume } from '../../utilities/segmentation';\nimport { getCurrentLabelmapImageIdForViewport } from '../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nconst { transformWorldToIndex, transformIndexToWorld } = csUtils;\nclass GrowCutBaseTool extends BaseTool {\n    static { this.lastGrowCutCommand = null; }\n    constructor(toolProps, defaultToolProps) {\n        const baseToolProps = csUtils.deepMerge({\n            configuration: {\n                positiveStdDevMultiplier: DEFAULT_POSITIVE_STD_DEV_MULTIPLIER,\n                shrinkExpandIncrement: 0.1,\n                islandRemoval: {\n                    enabled: false,\n                },\n            },\n        }, defaultToolProps);\n        super(toolProps, baseToolProps);\n    }\n    async preMouseDownCallback(evt) {\n        const eventData = evt.detail;\n        const { element, currentPoints } = eventData;\n        const { world: worldPoint } = currentPoints;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        const { viewUp } = viewport.getCamera();\n        const { segmentationId, segmentIndex, labelmapVolumeId, referencedVolumeId, } = await this.getLabelmapSegmentationData(viewport);\n        if (!this._isOrthogonalView(viewport, referencedVolumeId)) {\n            throw new Error('Oblique view is not supported yet');\n        }\n        this.growCutData = {\n            metadata: {\n                ...viewport.getViewReference({ points: [worldPoint] }),\n                viewUp,\n            },\n            segmentation: {\n                segmentationId,\n                segmentIndex,\n                labelmapVolumeId,\n                referencedVolumeId,\n            },\n            viewportId: viewport.id,\n            renderingEngineId: renderingEngine.id,\n        };\n        evt.preventDefault();\n        return true;\n    }\n    shrink() {\n        this._runLastCommand({\n            shrinkExpandAmount: -this.configuration.shrinkExpandIncrement,\n        });\n    }\n    expand() {\n        this._runLastCommand({\n            shrinkExpandAmount: this.configuration.shrinkExpandIncrement,\n        });\n    }\n    refresh() {\n        this._runLastCommand();\n    }\n    async getGrowCutLabelmap(_growCutData) {\n        throw new Error('Not implemented');\n    }\n    async runGrowCut() {\n        const { growCutData, configuration: config } = this;\n        const { segmentation: { segmentationId, segmentIndex, labelmapVolumeId }, } = growCutData;\n        const labelmap = cache.getVolume(labelmapVolumeId);\n        let shrinkExpandAccumulator = 0;\n        const growCutCommand = async ({ shrinkExpandAmount = 0 } = {}) => {\n            if (shrinkExpandAmount !== 0) {\n                this.seeds = null;\n            }\n            shrinkExpandAccumulator += shrinkExpandAmount;\n            const newPositiveStdDevMultiplier = Math.max(0.1, config.positiveStdDevMultiplier + shrinkExpandAccumulator);\n            const negativeSeedMargin = shrinkExpandAmount < 0\n                ? Math.max(1, DEFAULT_NEGATIVE_SEED_MARGIN -\n                    Math.abs(shrinkExpandAccumulator) * 3)\n                : DEFAULT_NEGATIVE_SEED_MARGIN + shrinkExpandAccumulator * 3;\n            const updatedGrowCutData = {\n                ...growCutData,\n                options: {\n                    ...(growCutData.options || {}),\n                    positiveSeedValue: segmentIndex,\n                    negativeSeedValue: 255,\n                    positiveStdDevMultiplier: newPositiveStdDevMultiplier,\n                    negativeSeedMargin,\n                },\n            };\n            const growcutLabelmap = await this.getGrowCutLabelmap(updatedGrowCutData);\n            const { isPartialVolume } = config;\n            const fn = isPartialVolume\n                ? this.applyPartialGrowCutLabelmap\n                : this.applyGrowCutLabelmap;\n            fn(segmentationId, segmentIndex, labelmap, growcutLabelmap);\n            this._removeIslands(updatedGrowCutData);\n        };\n        await growCutCommand();\n        GrowCutBaseTool.lastGrowCutCommand = growCutCommand;\n        this.growCutData = null;\n    }\n    applyPartialGrowCutLabelmap(segmentationId, segmentIndex, targetLabelmap, sourceLabelmap) {\n        const srcLabelmapData = sourceLabelmap.voxelManager.getCompleteScalarDataArray();\n        const tgtVoxelManager = targetLabelmap.voxelManager;\n        const [srcColumns, srcRows, srcNumSlices] = sourceLabelmap.dimensions;\n        const [tgtColumns, tgtRows] = targetLabelmap.dimensions;\n        const srcPixelsPerSlice = srcColumns * srcRows;\n        const tgtPixelsPerSlice = tgtColumns * tgtRows;\n        for (let srcSlice = 0; srcSlice < srcNumSlices; srcSlice++) {\n            for (let srcRow = 0; srcRow < srcRows; srcRow++) {\n                const srcRowIJK = [0, srcRow, srcSlice];\n                const rowVoxelWorld = transformIndexToWorld(sourceLabelmap.imageData, srcRowIJK);\n                const tgtRowIJK = transformWorldToIndex(targetLabelmap.imageData, rowVoxelWorld);\n                const [tgtColumn, tgtRow, tgtSlice] = tgtRowIJK;\n                const srcOffset = srcRow * srcColumns + srcSlice * srcPixelsPerSlice;\n                const tgtOffset = tgtColumn + tgtRow * tgtColumns + tgtSlice * tgtPixelsPerSlice;\n                for (let column = 0; column < srcColumns; column++) {\n                    const labelmapValue = srcLabelmapData[srcOffset + column] === segmentIndex\n                        ? segmentIndex\n                        : 0;\n                    tgtVoxelManager.setAtIndex(tgtOffset + column, labelmapValue);\n                }\n            }\n        }\n        triggerSegmentationDataModified(segmentationId);\n    }\n    applyGrowCutLabelmap(segmentationId, segmentIndex, targetLabelmap, sourceLabelmap) {\n        const tgtVoxelManager = targetLabelmap.voxelManager;\n        const srcVoxelManager = sourceLabelmap.voxelManager;\n        srcVoxelManager.forEach(({ value, index }) => {\n            if (value === segmentIndex) {\n                tgtVoxelManager.setAtIndex(index, value);\n            }\n        });\n        triggerSegmentationDataModified(segmentationId);\n    }\n    _runLastCommand({ shrinkExpandAmount = 0 } = {}) {\n        const cmd = GrowCutBaseTool.lastGrowCutCommand;\n        if (cmd) {\n            cmd({ shrinkExpandAmount });\n        }\n    }\n    async getLabelmapSegmentationData(viewport) {\n        const activeSeg = activeSegmentation.getActiveSegmentation(viewport.id);\n        if (!activeSeg) {\n            throw new Error('No active segmentation found');\n        }\n        const { segmentationId } = activeSeg;\n        const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n        const { representationData } = segmentationState.getSegmentation(segmentationId);\n        const labelmapData = representationData[SegmentationRepresentations.Labelmap];\n        let { volumeId: labelmapVolumeId, referencedVolumeId } = labelmapData;\n        if (!labelmapVolumeId) {\n            const referencedImageIds = viewport.getImageIds();\n            if (!csUtils.isValidVolume(referencedImageIds)) {\n                const currentImageId = viewport.getCurrentImageId();\n                const currentImage = cache.getImage(currentImageId);\n                const fakeImage = imageLoader.createAndCacheDerivedImage(currentImageId);\n                const fakeVolume = this._createFakeVolume([\n                    currentImage.imageId,\n                    fakeImage.imageId,\n                ]);\n                referencedVolumeId = fakeVolume.volumeId;\n                const currentLabelmapImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                const fakeDerivedImage = imageLoader.createAndCacheDerivedImage(currentLabelmapImageId);\n                const fakeLabelmapVolume = this._createFakeVolume([\n                    currentLabelmapImageId,\n                    fakeDerivedImage.imageId,\n                ]);\n                labelmapVolumeId = fakeLabelmapVolume.volumeId;\n            }\n            else {\n                const segVolume = getOrCreateSegmentationVolume(segmentationId);\n                labelmapVolumeId = segVolume.volumeId;\n            }\n        }\n        if (!referencedVolumeId) {\n            const { imageIds: segImageIds } = labelmapData;\n            const referencedImageIds = segImageIds.map((imageId) => cache.getImage(imageId).referencedImageId);\n            const volumeId = cache.generateVolumeId(referencedImageIds);\n            const imageVolume = cache.getVolume(volumeId);\n            referencedVolumeId = imageVolume\n                ? imageVolume.volumeId\n                : (await volumeLoader.createAndCacheVolumeFromImagesSync(volumeId, referencedImageIds)).volumeId;\n        }\n        return {\n            segmentationId,\n            segmentIndex,\n            labelmapVolumeId,\n            referencedVolumeId,\n        };\n    }\n    _createFakeVolume(imageIds) {\n        const volumeId = cache.generateVolumeId(imageIds);\n        const cachedVolume = cache.getVolume(volumeId);\n        if (cachedVolume) {\n            return cachedVolume;\n        }\n        const volumeProps = csUtils.generateVolumePropsFromImageIds(imageIds, volumeId);\n        const spacing = volumeProps.spacing;\n        if (spacing[2] === 0) {\n            spacing[2] = 1;\n        }\n        const derivedVolume = new ImageVolume({\n            volumeId,\n            dataType: volumeProps.dataType,\n            metadata: structuredClone(volumeProps.metadata),\n            dimensions: volumeProps.dimensions,\n            spacing: volumeProps.spacing,\n            origin: volumeProps.origin,\n            direction: volumeProps.direction,\n            referencedVolumeId: volumeProps.referencedVolumeId,\n            imageIds: volumeProps.imageIds,\n            referencedImageIds: volumeProps.referencedImageIds,\n        });\n        cache.putVolumeSync(volumeId, derivedVolume);\n        return derivedVolume;\n    }\n    _isOrthogonalView(viewport, referencedVolumeId) {\n        const volume = cache.getVolume(referencedVolumeId);\n        const volumeImageData = volume.imageData;\n        const camera = viewport.getCamera();\n        const { ijkVecColDir, ijkVecSliceDir } = csUtils.getVolumeDirectionVectors(volumeImageData, camera);\n        return [ijkVecColDir, ijkVecSliceDir].every((vec) => csUtils.isEqual(Math.abs(vec[0]), 1) ||\n            csUtils.isEqual(Math.abs(vec[1]), 1) ||\n            csUtils.isEqual(Math.abs(vec[2]), 1));\n    }\n    getRemoveIslandData(_growCutData) {\n        return;\n    }\n    _removeIslands(growCutData) {\n        const { islandRemoval: config } = this.configuration;\n        if (!config.enabled) {\n            return;\n        }\n        const { segmentation: { segmentIndex, labelmapVolumeId }, renderingEngineId, viewportId, } = growCutData;\n        const labelmap = cache.getVolume(labelmapVolumeId);\n        const removeIslandData = this.getRemoveIslandData(growCutData);\n        if (!removeIslandData) {\n            return;\n        }\n        const [width, height] = labelmap.dimensions;\n        const numPixelsPerSlice = width * height;\n        const { worldIslandPoints = [], islandPointIndexes = [] } = removeIslandData;\n        let ijkIslandPoints = [...(removeIslandData?.ijkIslandPoints ?? [])];\n        const renderingEngine = getRenderingEngine(renderingEngineId);\n        const viewport = renderingEngine.getViewport(viewportId);\n        const { voxelManager } = labelmap;\n        const islandRemoval = new IslandRemoval();\n        ijkIslandPoints = ijkIslandPoints.concat(worldIslandPoints.map((worldPoint) => transformWorldToIndex(labelmap.imageData, worldPoint)));\n        ijkIslandPoints = ijkIslandPoints.concat(islandPointIndexes.map((pointIndex) => {\n            const x = pointIndex % width;\n            const y = Math.floor(pointIndex / width) % height;\n            const z = Math.floor(pointIndex / numPixelsPerSlice);\n            return [x, y, z];\n        }));\n        islandRemoval.initialize(viewport, voxelManager, {\n            points: ijkIslandPoints,\n            previewSegmentIndex: segmentIndex,\n            segmentIndex,\n        });\n        islandRemoval.floodFillSegmentIsland();\n        islandRemoval.removeExternalIslands();\n        islandRemoval.removeInternalIslands();\n    }\n    getSegmentStyle({ segmentationId, viewportId, segmentIndex }) {\n        return getSVGStyleForSegment({\n            segmentationId,\n            segmentIndex,\n            viewportId,\n        });\n    }\n}\nGrowCutBaseTool.toolName = 'GrowCutBaseTool';\nexport default GrowCutBaseTool;\n","import { point } from '../utilities/math';\nexport const distancePointToContour = (viewport, annotation, coords) => {\n    if (!annotation?.data?.contour?.polyline?.length) {\n        return;\n    }\n    const { polyline } = annotation.data.contour;\n    const { length } = polyline;\n    let distance = Infinity;\n    for (let i = 0; i < length; i++) {\n        const canvasPoint = viewport.worldToCanvas(polyline[i]);\n        const distanceToPoint = point.distanceToPoint(canvasPoint, coords);\n        distance = Math.min(distance, distanceToPoint);\n    }\n    if (distance === Infinity || isNaN(distance)) {\n        return;\n    }\n    return distance;\n};\n","import { fillInsideRectangle } from './fillRectangle';\nfunction eraseRectangle(enabledElement, operationData, inside = true) {\n    const eraseOperationData = Object.assign({}, operationData, {\n        segmentIndex: 0,\n    });\n    fillInsideRectangle(enabledElement, eraseOperationData);\n}\nexport function eraseInsideRectangle(enabledElement, operationData) {\n    eraseRectangle(enabledElement, operationData, true);\n}\nexport function eraseOutsideRectangle(enabledElement, operationData) {\n    eraseRectangle(enabledElement, operationData, false);\n}\n","function validate3x3Matrix(matrix) {\n    if (!Array.isArray(matrix) || matrix.length !== 9) {\n        throw new Error('Matrix must be an array of 9 numbers');\n    }\n    if (!matrix.every((n) => typeof n === 'number' && !isNaN(n))) {\n        throw new Error('Matrix must contain only valid numbers');\n    }\n}\nexport function inverse3x3Matrix(matrix) {\n    validate3x3Matrix(matrix);\n    const mat = [\n        [matrix[0], matrix[1], matrix[2]],\n        [matrix[3], matrix[4], matrix[5]],\n        [matrix[6], matrix[7], matrix[8]],\n    ];\n    const determinant = mat[0][0] * (mat[1][1] * mat[2][2] - mat[1][2] * mat[2][1]) -\n        mat[0][1] * (mat[1][0] * mat[2][2] - mat[1][2] * mat[2][0]) +\n        mat[0][2] * (mat[1][0] * mat[2][1] - mat[1][1] * mat[2][0]);\n    if (Math.abs(determinant) < 1e-10) {\n        throw new Error('Matrix is not invertible (determinant is zero)');\n    }\n    const adjugate = [\n        [\n            mat[1][1] * mat[2][2] - mat[1][2] * mat[2][1],\n            -(mat[0][1] * mat[2][2] - mat[0][2] * mat[2][1]),\n            mat[0][1] * mat[1][2] - mat[0][2] * mat[1][1],\n        ],\n        [\n            -(mat[1][0] * mat[2][2] - mat[1][2] * mat[2][0]),\n            mat[0][0] * mat[2][2] - mat[0][2] * mat[2][0],\n            -(mat[0][0] * mat[1][2] - mat[0][2] * mat[1][0]),\n        ],\n        [\n            mat[1][0] * mat[2][1] - mat[1][1] * mat[2][0],\n            -(mat[0][0] * mat[2][1] - mat[0][1] * mat[2][0]),\n            mat[0][0] * mat[1][1] - mat[0][1] * mat[1][0],\n        ],\n    ];\n    const inverse = [];\n    for (let i = 0; i < 3; i++) {\n        for (let j = 0; j < 3; j++) {\n            inverse.push(adjugate[i][j] / determinant);\n        }\n    }\n    return inverse;\n}\nfunction normalizeVector(v) {\n    const magnitude = Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\n    return v.map((component) => component / magnitude);\n}\nexport function checkStandardBasis(directions) {\n    validate3x3Matrix(directions);\n    const xVector = directions.slice(0, 3);\n    const yVector = directions.slice(3, 6);\n    const zVector = directions.slice(6, 9);\n    const normalizedX = normalizeVector(xVector);\n    const normalizedY = normalizeVector(yVector);\n    const normalizedZ = normalizeVector(zVector);\n    const standardBasis = {\n        x: [1, 0, 0],\n        y: [0, 1, 0],\n        z: [0, 0, 1],\n    };\n    const epsilon = 1e-10;\n    const isStandard = normalizedX.every((val, i) => Math.abs(val - standardBasis.x[i]) < epsilon) &&\n        normalizedY.every((val, i) => Math.abs(val - standardBasis.y[i]) < epsilon) &&\n        normalizedZ.every((val, i) => Math.abs(val - standardBasis.z[i]) < epsilon);\n    const rotationMatrix = isStandard\n        ? [...standardBasis.x, ...standardBasis.y, ...standardBasis.z]\n        : inverse3x3Matrix([...normalizedX, ...normalizedY, ...normalizedZ]);\n    return {\n        isStandard,\n        rotationMatrix,\n    };\n}\nfunction rotatePoint(point, origin, rotationMatrix) {\n    const x = point[0] - origin[0];\n    const y = point[1] - origin[1];\n    const z = point[2] - origin[2];\n    return [\n        rotationMatrix[0] * x +\n            rotationMatrix[1] * y +\n            rotationMatrix[2] * z +\n            origin[0],\n        rotationMatrix[3] * x +\n            rotationMatrix[4] * y +\n            rotationMatrix[5] * z +\n            origin[1],\n        rotationMatrix[6] * x +\n            rotationMatrix[7] * y +\n            rotationMatrix[8] * z +\n            origin[2],\n    ];\n}\nexport function rotatePoints(rotationMatrix, origin, points) {\n    const rotatedPoints = [];\n    for (let i = 0; i < points.length; i += 3) {\n        const point = points.slice(i, i + 3);\n        const rotated = rotatePoint(point, origin, rotationMatrix);\n        rotatedPoints.push(...rotated);\n    }\n    return rotatedPoints;\n}\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nexport default function getToolsWithModesForElement(element, modesFilter) {\n    const enabledElement = getEnabledElement(element);\n    const { renderingEngineId, viewportId } = enabledElement;\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (!toolGroup) {\n        return [];\n    }\n    const enabledTools = [];\n    const toolGroupToolNames = Object.keys(toolGroup.toolOptions);\n    for (let j = 0; j < toolGroupToolNames.length; j++) {\n        const toolName = toolGroupToolNames[j];\n        const toolOptions = toolGroup.toolOptions[toolName];\n        if (!toolOptions) {\n            continue;\n        }\n        if (modesFilter.includes(toolOptions.mode)) {\n            const toolInstance = toolGroup.getToolInstance(toolName);\n            enabledTools.push(toolInstance);\n        }\n    }\n    return enabledTools;\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { isViewportPreScaled } from './viewport';\nconst DEFAULT_MULTIPLIER = 4;\nfunction getVOIMultipliers(viewport, volumeId, options) {\n    const modality = csUtils.getViewportModality(viewport, volumeId);\n    if (modality === 'PT') {\n        const { clientWidth, clientHeight } = viewport.element;\n        const ptMultiplier = 5 / Math.max(clientWidth, clientHeight);\n        const isPreScaled = isViewportPreScaled(viewport, volumeId);\n        const { fixedPTWindowWidth = true } = options ?? {};\n        const xMultiplier = fixedPTWindowWidth ? 0 : ptMultiplier;\n        return isPreScaled\n            ? [xMultiplier, ptMultiplier]\n            : [xMultiplier, DEFAULT_MULTIPLIER];\n    }\n    return [DEFAULT_MULTIPLIER, DEFAULT_MULTIPLIER];\n}\nexport { getVOIMultipliers as default, getVOIMultipliers };\n","export class LivewirePath {\n    constructor(inputPointArray, inputControlPointIndexArray) {\n        this.pointArray = inputPointArray ? inputPointArray.slice() : [];\n        this._controlPointIndexes = inputControlPointIndexArray\n            ? inputControlPointIndexArray.slice()\n            : [];\n    }\n    getPoint(index) {\n        return this.pointArray[index];\n    }\n    getLastPoint() {\n        return this.pointArray[this.pointArray.length - 1];\n    }\n    isControlPoint(point) {\n        const index = this.pointArray.indexOf(point);\n        if (index !== -1) {\n            return this._controlPointIndexes.indexOf(index) !== -1;\n        }\n        else {\n            throw new Error('Error: isControlPoint called with not in list point.');\n        }\n    }\n    addPoint(point) {\n        this.pointArray.push(point);\n    }\n    addControlPoint(point) {\n        const index = this.pointArray.indexOf(point);\n        if (index !== -1) {\n            this._controlPointIndexes.push(index);\n        }\n        else {\n            throw new Error('Cannot mark a non registered point as control point.');\n        }\n    }\n    getControlPoints() {\n        return this._controlPointIndexes.map((i) => this.pointArray[i]);\n    }\n    getNumControlPoints() {\n        return this._controlPointIndexes.length;\n    }\n    removeLastControlPoint() {\n        if (this._controlPointIndexes.length) {\n            this._controlPointIndexes.pop();\n        }\n    }\n    getLastControlPoint() {\n        if (this._controlPointIndexes.length) {\n            return this.pointArray[this._controlPointIndexes[this._controlPointIndexes.length - 1]];\n        }\n    }\n    removeLastPoints(count) {\n        this.pointArray.splice(this.pointArray.length - count, count);\n    }\n    addPoints(newPointArray) {\n        this.pointArray = this.pointArray.concat(newPointArray);\n    }\n    prependPath(other) {\n        const otherSize = other.pointArray.length;\n        const shiftedIndexArray = [];\n        this.pointArray = other.pointArray.concat(this.pointArray);\n        for (let i = 0; i < this._controlPointIndexes.length; ++i) {\n            shiftedIndexArray[i] = this._controlPointIndexes[i] + otherSize;\n        }\n        this._controlPointIndexes =\n            other._controlPointIndexes.concat(shiftedIndexArray);\n    }\n    appendPath(other) {\n        this.addPoints(other.pointArray);\n        other._controlPointIndexes.forEach((point) => this._controlPointIndexes.push(point));\n    }\n}\n","export class BucketQueue {\n    constructor({ numBits, getPriority, areEqual, }) {\n        this._bucketCount = 1 << numBits;\n        this._mask = this._bucketCount - 1;\n        this._size = 0;\n        this._currentBucketIndex = 0;\n        this._buckets = this._buildArray(this._bucketCount);\n        this._getPriority =\n            typeof getPriority !== 'undefined'\n                ? getPriority\n                : (item) => item;\n        this._areEqual =\n            typeof areEqual === 'function'\n                ? areEqual\n                : (itemA, itemB) => itemA === itemB;\n    }\n    push(item) {\n        const bucketIndex = this._getBucketIndex(item);\n        const oldHead = this._buckets[bucketIndex];\n        const newHead = {\n            value: item,\n            next: oldHead,\n        };\n        this._buckets[bucketIndex] = newHead;\n        this._size++;\n    }\n    pop() {\n        if (this._size === 0) {\n            throw new Error('Cannot pop because the queue is empty.');\n        }\n        while (this._buckets[this._currentBucketIndex] === null) {\n            this._currentBucketIndex =\n                (this._currentBucketIndex + 1) % this._bucketCount;\n        }\n        const ret = this._buckets[this._currentBucketIndex];\n        this._buckets[this._currentBucketIndex] = ret.next;\n        this._size--;\n        return ret.value;\n    }\n    remove(item) {\n        if (!item) {\n            return false;\n        }\n        const bucketIndex = this._getBucketIndex(item);\n        const firstBucketNode = this._buckets[bucketIndex];\n        let node = firstBucketNode;\n        let prevNode;\n        while (node !== null) {\n            if (this._areEqual(item, node.value)) {\n                break;\n            }\n            prevNode = node;\n            node = node.next;\n        }\n        if (node === null) {\n            return false;\n        }\n        if (node === firstBucketNode) {\n            this._buckets[bucketIndex] = node.next;\n        }\n        else {\n            prevNode.next = node.next;\n        }\n        this._size--;\n        return true;\n    }\n    isEmpty() {\n        return this._size === 0;\n    }\n    _getBucketIndex(item) {\n        return this._getPriority(item) & this._mask;\n    }\n    _buildArray(size) {\n        const buckets = new Array(size);\n        buckets.fill(null);\n        return buckets;\n    }\n}\n","import { utilities } from '@cornerstonejs/core';\nimport { BucketQueue } from '../BucketQueue';\nconst { isEqual } = utilities;\nconst MAX_UINT32 = 4294967295;\nconst TWO_THIRD_PI = 2 / (3 * Math.PI);\nexport class LivewireScissors {\n    constructor(grayscalePixelData, width, height) {\n        this._getPointIndex = (row, col) => {\n            const { width } = this;\n            return row * width + col;\n        };\n        this._getPointCoordinate = (index) => {\n            const x = index % this.width;\n            const y = Math.floor(index / this.width);\n            return [x, y];\n        };\n        this._getPointCost = (pointIndex) => {\n            return Math.round(this.searchGranularity * this.costs[pointIndex]);\n        };\n        const numPixels = grayscalePixelData.length;\n        this.searchGranularityBits = 8;\n        this.searchGranularity = 1 << this.searchGranularityBits;\n        this.width = width;\n        this.height = height;\n        this.grayscalePixelData = grayscalePixelData;\n        this.laplace = null;\n        this.gradXNew = null;\n        this.gradYNew = null;\n        this.laplace = this._computeLaplace();\n        this.gradMagnitude = this._computeGradient();\n        this.gradXNew = this._computeGradientX();\n        this.gradYNew = this._computeGradientY();\n        this.visited = new Array(numPixels);\n        this.parents = new Uint32Array(numPixels);\n        this.costs = new Float32Array(numPixels);\n    }\n    startSearch(startPoint) {\n        const startPointIndex = this._getPointIndex(startPoint[1], startPoint[0]);\n        this.startPoint = null;\n        this.visited.fill(false);\n        this.parents.fill(MAX_UINT32);\n        this.costs.fill(Infinity);\n        this.priorityQueueNew = new BucketQueue({\n            numBits: this.searchGranularityBits,\n            getPriority: this._getPointCost,\n        });\n        this.startPoint = startPoint;\n        this.costs[startPointIndex] = 0;\n        this.priorityQueueNew.push(startPointIndex);\n    }\n    findMinNearby(testPoint, delta = 2) {\n        const [x, y] = testPoint;\n        const { costs } = this;\n        const xRange = [\n            Math.max(0, x - delta),\n            Math.min(x + delta + 1, this.width),\n        ];\n        const yRange = [\n            Math.max(0, y - delta),\n            Math.min(y + delta + 1, this.height),\n        ];\n        let minValue = costs[this._getPointIndex(y, x)] * 0.8;\n        let minPoint = testPoint;\n        for (let xTest = xRange[0]; xTest < xRange[1]; xTest++) {\n            for (let yTest = yRange[0]; yTest < yRange[1]; yTest++) {\n                const distanceCost = 1 -\n                    (Math.abs(xTest - testPoint[0]) + Math.abs(yTest - testPoint[1])) /\n                        delta /\n                        2;\n                const weightCost = costs[this._getPointIndex(yTest, xTest)];\n                const weight = weightCost * 0.8 + distanceCost * 0.2;\n                if (weight < minValue) {\n                    minPoint = [xTest, yTest];\n                    minValue = weight;\n                }\n            }\n        }\n        return minPoint;\n    }\n    findPathToPoint(targetPoint) {\n        if (!this.startPoint) {\n            throw new Error('There is no search in progress');\n        }\n        const { startPoint, _getPointIndex: index, _getPointCoordinate: coord, } = this;\n        const startPointIndex = index(startPoint[1], startPoint[0]);\n        const targetPointIndex = index(targetPoint[1], targetPoint[0]);\n        const { visited: visited, parents: parents, costs: cost, priorityQueueNew: priorityQueue, } = this;\n        if (targetPointIndex === startPointIndex) {\n            return [];\n        }\n        while (!priorityQueue.isEmpty() &&\n            parents[targetPointIndex] === MAX_UINT32) {\n            const pointIndex = priorityQueue.pop();\n            if (visited[pointIndex]) {\n                continue;\n            }\n            const point = coord(pointIndex);\n            const neighborsPoints = this._getNeighborPoints(point);\n            visited[pointIndex] = true;\n            for (let i = 0, len = neighborsPoints.length; i < len; i++) {\n                const neighborPoint = neighborsPoints[i];\n                const neighborPointIndex = index(neighborPoint[1], neighborPoint[0]);\n                const dist = this._getWeightedDistance(point, neighborPoint);\n                const neighborCost = cost[pointIndex] + dist;\n                if (neighborCost < cost[neighborPointIndex]) {\n                    if (cost[neighborPointIndex] !== Infinity) {\n                        priorityQueue.remove(neighborPointIndex);\n                    }\n                    cost[neighborPointIndex] = neighborCost;\n                    parents[neighborPointIndex] = pointIndex;\n                    priorityQueue.push(neighborPointIndex);\n                }\n            }\n        }\n        const pathPoints = [];\n        let pathPointIndex = targetPointIndex;\n        while (pathPointIndex !== MAX_UINT32) {\n            pathPoints.push(coord(pathPointIndex));\n            pathPointIndex = parents[pathPointIndex];\n        }\n        return pathPoints.reverse();\n    }\n    _getDeltaX(x, y) {\n        const { grayscalePixelData: data, width } = this;\n        let index = this._getPointIndex(y, x);\n        if (x + 1 === width) {\n            index--;\n        }\n        return data[index + 1] - data[index];\n    }\n    _getDeltaY(x, y) {\n        const { grayscalePixelData: data, width, height } = this;\n        let index = this._getPointIndex(y, x);\n        if (y + 1 === height) {\n            index -= width;\n        }\n        return data[index] - data[index + width];\n    }\n    _getGradientMagnitude(x, y) {\n        const dx = this._getDeltaX(x, y);\n        const dy = this._getDeltaY(x, y);\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n    _getLaplace(x, y) {\n        const { grayscalePixelData: data, _getPointIndex: index } = this;\n        const p02 = data[index(y - 2, x)];\n        const p11 = data[index(y - 1, x - 1)];\n        const p12 = data[index(y - 1, x)];\n        const p13 = data[index(y - 1, x + 1)];\n        const p20 = data[index(y, x - 2)];\n        const p21 = data[index(y, x - 1)];\n        const p22 = data[index(y, x)];\n        const p23 = data[index(y, x + 1)];\n        const p24 = data[index(y, x + 2)];\n        const p31 = data[index(y + 1, x - 1)];\n        const p32 = data[index(y + 1, x)];\n        const p33 = data[index(y + 1, x + 1)];\n        const p42 = data[index(y + 2, x)];\n        let lap = p02;\n        lap += p11 + 2 * p12 + p13;\n        lap += p20 + 2 * p21 - 16 * p22 + 2 * p23 + p24;\n        lap += p31 + 2 * p32 + p33;\n        lap += p42;\n        return lap;\n    }\n    _computeGradient() {\n        const { width, height } = this;\n        const gradient = new Float32Array(width * height);\n        let pixelIndex = 0;\n        let max = 0;\n        let x = 0;\n        let y = 0;\n        for (y = 0; y < height - 1; y++) {\n            for (x = 0; x < width - 1; x++) {\n                gradient[pixelIndex] = this._getGradientMagnitude(x, y);\n                max = Math.max(gradient[pixelIndex], max);\n                pixelIndex++;\n            }\n            gradient[pixelIndex] = gradient[pixelIndex - 1];\n            pixelIndex++;\n        }\n        for (let len = gradient.length; pixelIndex < len; pixelIndex++) {\n            gradient[pixelIndex] = gradient[pixelIndex - width];\n        }\n        for (let i = 0, len = gradient.length; i < len; i++) {\n            gradient[i] = 1 - gradient[i] / max;\n        }\n        return gradient;\n    }\n    _computeLaplace() {\n        const { width, height, _getPointIndex: index } = this;\n        const laplace = new Float32Array(width * height);\n        laplace.fill(1, 0, index(2, 0));\n        for (let y = 2; y < height - 2; y++) {\n            laplace[index(y, 0)] = 1;\n            laplace[index(y, 1)] = 1;\n            for (let x = 2; x < width - 2; x++) {\n                laplace[index(y, x)] = this._getLaplace(x, y) > 0.33 ? 0 : 1;\n            }\n            laplace[index(y, width - 2)] = 1;\n            laplace[index(y, width - 1)] = 1;\n        }\n        laplace.fill(1, index(height - 2, 0));\n        return laplace;\n    }\n    _computeGradientX() {\n        const { width, height } = this;\n        const gradX = new Float32Array(width * height);\n        let pixelIndex = 0;\n        for (let y = 0; y < height; y++) {\n            for (let x = 0; x < width; x++) {\n                gradX[pixelIndex++] = this._getDeltaX(x, y);\n            }\n        }\n        return gradX;\n    }\n    _computeGradientY() {\n        const { width, height } = this;\n        const gradY = new Float32Array(width * height);\n        let pixelIndex = 0;\n        for (let y = 0; y < height; y++) {\n            for (let x = 0; x < width; x++) {\n                gradY[pixelIndex++] = this._getDeltaY(x, y);\n            }\n        }\n        return gradY;\n    }\n    _getGradientUnitVector(px, py) {\n        const { gradXNew, gradYNew, _getPointIndex: index } = this;\n        const pointGradX = gradXNew[index(py, px)];\n        const pointGradY = gradYNew[index(py, px)];\n        let gradVecLen = Math.sqrt(pointGradX * pointGradX + pointGradY * pointGradY);\n        gradVecLen = Math.max(gradVecLen, 1e-100);\n        return [pointGradX / gradVecLen, pointGradY / gradVecLen];\n    }\n    _getGradientDirection(px, py, qx, qy) {\n        const dgpUnitVec = this._getGradientUnitVector(px, py);\n        const gdqUnitVec = this._getGradientUnitVector(qx, qy);\n        let dp = dgpUnitVec[1] * (qx - px) - dgpUnitVec[0] * (qy - py);\n        let dq = gdqUnitVec[1] * (qx - px) - gdqUnitVec[0] * (qy - py);\n        if (dp < 0) {\n            dp = -dp;\n            dq = -dq;\n        }\n        if (px !== qx && py !== qy) {\n            dp *= Math.SQRT1_2;\n            dq *= Math.SQRT1_2;\n        }\n        dq = Math.min(Math.max(dq, -1), 1);\n        const direction = TWO_THIRD_PI * (Math.acos(Math.min(dp, 1)) + Math.acos(dq));\n        if (isNaN(direction) || !isFinite(direction)) {\n            console.warn('Found non-direction:', px, py, qx, qy, dp, dq, direction);\n            return 1;\n        }\n        return direction;\n    }\n    getCost(pointA, pointB) {\n        return this._getWeightedDistance(pointA, pointB);\n    }\n    _getWeightedDistance(pointA, pointB) {\n        const { _getPointIndex: index, width, height } = this;\n        const [aX, aY] = pointA;\n        const [bX, bY] = pointB;\n        if (bX < 0 || bX >= width || bY < 0 || bY >= height) {\n            return 1;\n        }\n        if (aX < 0 || aY < 0 || aX >= width || aY >= height) {\n            return 0;\n        }\n        const bIndex = index(bY, bX);\n        let gradient = this.gradMagnitude[bIndex];\n        if (aX === bX || aY === bY) {\n            gradient *= Math.SQRT1_2;\n        }\n        const laplace = this.laplace[bIndex];\n        const direction = this._getGradientDirection(aX, aY, bX, bY);\n        return 0.43 * gradient + 0.43 * laplace + 0.11 * direction;\n    }\n    _getNeighborPoints(point) {\n        const { width, height } = this;\n        const list = [];\n        const sx = Math.max(point[0] - 1, 0);\n        const sy = Math.max(point[1] - 1, 0);\n        const ex = Math.min(point[0] + 1, width - 1);\n        const ey = Math.min(point[1] + 1, height - 1);\n        for (let y = sy; y <= ey; y++) {\n            for (let x = sx; x <= ex; x++) {\n                if (x !== point[0] || y !== point[1]) {\n                    list.push([x, y]);\n                }\n            }\n        }\n        return list;\n    }\n    static createInstanceFromRawPixelData(pixelData, width, height, voiRange) {\n        const numPixels = pixelData.length;\n        const grayscalePixelData = new Float32Array(numPixels);\n        const { lower: minPixelValue, upper: maxPixelValue } = voiRange;\n        const pixelRange = maxPixelValue - minPixelValue;\n        for (let i = 0, len = pixelData.length; i < len; i++) {\n            grayscalePixelData[i] = Math.max(0, Math.min(1, (pixelData[i] - minPixelValue) / pixelRange));\n        }\n        return new LivewireScissors(grayscalePixelData, width, height);\n    }\n}\n","export default function intersectAABB(aabb1, aabb2) {\n    return (aabb1.minX <= aabb2.maxX &&\n        aabb1.maxX >= aabb2.minX &&\n        aabb1.minY <= aabb2.maxY &&\n        aabb1.maxY >= aabb2.minY);\n}\n","export default function distanceToPointSquared(aabb, point) {\n    const aabbWidth = aabb.maxX - aabb.minX;\n    const aabbHeight = aabb.maxY - aabb.minY;\n    const aabbSize = [aabbWidth, aabbHeight];\n    const aabbCenter = [\n        aabb.minX + aabbWidth / 2,\n        aabb.minY + aabbHeight / 2,\n    ];\n    const translatedPoint = [\n        Math.abs(point[0] - aabbCenter[0]),\n        Math.abs(point[1] - aabbCenter[1]),\n    ];\n    const dx = translatedPoint[0] - aabbSize[0] * 0.5;\n    const dy = translatedPoint[1] - aabbSize[1] * 0.5;\n    if (dx > 0 && dy > 0) {\n        return dx * dx + dy * dy;\n    }\n    const dist = Math.max(dx, 0) + Math.max(dy, 0);\n    return dist * dist;\n}\n","import distanceToPointSquared from './distanceToPointSquared';\nexport default function distanceToPoint(aabb, point) {\n    return Math.sqrt(distanceToPointSquared(aabb, point));\n}\n","import { vec2, vec3 } from 'gl-matrix';\nfunction angleBetween3DLines(line1, line2) {\n    const [p1, p2] = line1;\n    const [p3, p4] = line2;\n    const v1 = vec3.sub(vec3.create(), p2, p1);\n    const v2 = vec3.sub(vec3.create(), p3, p4);\n    const dot = vec3.dot(v1, v2);\n    const v1Length = vec3.length(v1);\n    const v2Length = vec3.length(v2);\n    const cos = dot / (v1Length * v2Length);\n    const radian = Math.acos(cos);\n    return (radian * 180) / Math.PI;\n}\nfunction angleBetween2DLines(line1, line2) {\n    const [p1, p2] = line1;\n    const [p3, p4] = line2;\n    const v1 = vec2.sub(vec2.create(), p2, p1);\n    const v2 = vec2.sub(vec2.create(), p3, p4);\n    const dot = vec2.dot(v1, v2);\n    const v1Length = vec2.length(v1);\n    const v2Length = vec2.length(v2);\n    const cos = dot / (v1Length * v2Length);\n    return Math.acos(cos) * (180 / Math.PI);\n}\nexport default function angleBetweenLines(line1, line2) {\n    const is3D = line1[0].length === 3;\n    return is3D\n        ? angleBetween3DLines(line1, line2)\n        : angleBetween2DLines(line1, line2);\n}\n","export class Calculator {\n}\nexport class InstanceCalculator {\n    constructor(options) {\n        this.storePointData = options.storePointData;\n    }\n    getStatistics() {\n        console.debug('InstanceCalculator getStatistics called');\n    }\n}\n","import { distanceToPoint } from '../point';\nexport default function getCanvasCircleRadius(circleCanvasPoints) {\n    const [center, end] = circleCanvasPoints;\n    return distanceToPoint(center, end);\n}\n","import { distanceToPoint } from '../point';\nexport default function getCanvasCircleCorners(circleCanvasPoints) {\n    const [center, end] = circleCanvasPoints;\n    const radius = distanceToPoint(center, end);\n    const topLeft = [center[0] - radius, center[1] - radius];\n    const bottomRight = [center[0] + radius, center[1] + radius];\n    return [topLeft, bottomRight];\n}\n","export default function pointInEllipse(ellipse, pointLPS, inverts = {}) {\n    if (!inverts.precalculated) {\n        precalculatePointInEllipse(ellipse, inverts);\n    }\n    return inverts.precalculated(pointLPS);\n}\nconst precalculatePointInEllipse = (ellipse, inverts = {}) => {\n    const { xRadius, yRadius, zRadius } = ellipse;\n    if (inverts.invXRadiusSq === undefined ||\n        inverts.invYRadiusSq === undefined ||\n        inverts.invZRadiusSq === undefined) {\n        inverts.invXRadiusSq = xRadius !== 0 ? 1 / xRadius ** 2 : 0;\n        inverts.invYRadiusSq = yRadius !== 0 ? 1 / yRadius ** 2 : 0;\n        inverts.invZRadiusSq = zRadius !== 0 ? 1 / zRadius ** 2 : 0;\n    }\n    const { invXRadiusSq, invYRadiusSq, invZRadiusSq } = inverts;\n    const { center } = ellipse;\n    const [centerL, centerP, centerS] = center;\n    inverts.precalculated = (pointLPS) => {\n        const dx = pointLPS[0] - centerL;\n        let inside = dx * dx * invXRadiusSq;\n        if (inside > 1) {\n            return false;\n        }\n        const dy = pointLPS[1] - centerP;\n        inside += dy * dy * invYRadiusSq;\n        if (inside > 1) {\n            return false;\n        }\n        const dz = pointLPS[2] - centerS;\n        inside += dz * dz * invZRadiusSq;\n        return inside <= 1;\n    };\n    return inverts;\n};\nexport { precalculatePointInEllipse };\n","export default function getCanvasEllipseCorners(ellipseCanvasPoints) {\n    const [bottom, top, left, right] = ellipseCanvasPoints;\n    const topLeft = [left[0], top[1]];\n    const bottomRight = [right[0], bottom[1]];\n    return [topLeft, bottomRight];\n}\n","function normalizeAngle(angle) {\n    return ((angle % 360) + 360) % 360;\n}\nexport function angleFromCenter(center, point) {\n    const dx = point[0] - center[0];\n    const dy = point[1] - center[1];\n    const angle = Math.atan2(dy, dx) * (180 / Math.PI);\n    return normalizeAngle(angle);\n}\nexport function intervalFromPoints(center, pair) {\n    const start = angleFromCenter(center, pair[0]);\n    const end = angleFromCenter(center, pair[1]);\n    return start < end ? [start, end] : [end, start];\n}\nexport function mergeIntervals(intervals) {\n    if (!intervals.length) {\n        return [];\n    }\n    intervals.sort((a, b) => a[0] - b[0]);\n    const merged = [intervals[0].slice()];\n    for (let i = 1; i < intervals.length; i++) {\n        const last = merged[merged.length - 1];\n        const current = intervals[i];\n        if (current[0] <= last[1]) {\n            last[1] = Math.max(last[1], current[1]);\n        }\n        else {\n            merged.push(current.slice());\n        }\n    }\n    return merged;\n}\nexport function subtractIntervals(blocked, target) {\n    const [T0, T1] = target;\n    if (T1 <= T0) {\n        return [];\n    }\n    const overlaps = blocked\n        .map(([a, b]) => [Math.max(a, T0), Math.min(b, T1)])\n        .filter(([a, b]) => b > a);\n    if (overlaps.length === 0) {\n        return [[T0, T1]];\n    }\n    overlaps.sort((p, q) => p[0] - q[0]);\n    const merged = [];\n    let [curA, curB] = overlaps[0];\n    for (let i = 1; i < overlaps.length; i++) {\n        const [a, b] = overlaps[i];\n        if (a <= curB) {\n            curB = Math.max(curB, b);\n        }\n        else {\n            merged.push([curA, curB]);\n            [curA, curB] = [a, b];\n        }\n    }\n    merged.push([curA, curB]);\n    const gaps = [];\n    let cursor = T0;\n    for (const [a, b] of merged) {\n        if (a > cursor) {\n            gaps.push([cursor, a]);\n        }\n        cursor = Math.max(cursor, b);\n    }\n    if (cursor < T1) {\n        gaps.push([cursor, T1]);\n    }\n    return gaps;\n}\nexport function clipInterval(inner, outerMerged) {\n    const result = [];\n    for (const out of outerMerged) {\n        const start = Math.max(inner[0], out[0]);\n        const end = Math.min(inner[1], out[1]);\n        if (start < end) {\n            result.push([start, end]);\n        }\n    }\n    return result;\n}\nexport function calculateInnerFanPercentage(center, outerFanPairs, innerFanPairs) {\n    const outerIntervals = outerFanPairs.map((pair) => intervalFromPoints(center, pair));\n    const mergedOuter = mergeIntervals(outerIntervals);\n    const outerTotal = mergedOuter.reduce((sum, [a, b]) => sum + (b - a), 0);\n    if (outerTotal === 0) {\n        return 0;\n    }\n    const clippedInnerIntervals = [];\n    for (const pair of innerFanPairs) {\n        const innerInterval = intervalFromPoints(center, pair);\n        const clipped = clipInterval(innerInterval, mergedOuter);\n        clippedInnerIntervals.push(...clipped);\n    }\n    const mergedInner = mergeIntervals(clippedInnerIntervals);\n    const innerTotal = mergedInner.reduce((sum, [a, b]) => sum + (b - a), 0);\n    const percentage = (innerTotal / outerTotal) * 100;\n    return Math.min(100, Math.max(0, percentage));\n}\n","import distanceToPointSquaredInfo from './distanceToPointSquaredInfo';\nexport default function distanceToPointSquared(lineStart, lineEnd, point) {\n    return distanceToPointSquaredInfo(lineStart, lineEnd, point).distanceSquared;\n}\n","import { distanceToPointSquared } from '../point';\nexport default function distanceToPointSquaredInfo(lineStart, lineEnd, point) {\n    let closestPoint;\n    const distanceSquared = distanceToPointSquared(lineStart, lineEnd);\n    if (lineStart[0] === lineEnd[0] && lineStart[1] === lineEnd[1]) {\n        closestPoint = lineStart;\n    }\n    if (!closestPoint) {\n        const dotProduct = ((point[0] - lineStart[0]) * (lineEnd[0] - lineStart[0]) +\n            (point[1] - lineStart[1]) * (lineEnd[1] - lineStart[1])) /\n            distanceSquared;\n        if (dotProduct < 0) {\n            closestPoint = lineStart;\n        }\n        else if (dotProduct > 1) {\n            closestPoint = lineEnd;\n        }\n        else {\n            closestPoint = [\n                lineStart[0] + dotProduct * (lineEnd[0] - lineStart[0]),\n                lineStart[1] + dotProduct * (lineEnd[1] - lineStart[1]),\n            ];\n        }\n    }\n    return {\n        point: [...closestPoint],\n        distanceSquared: distanceToPointSquared(point, closestPoint),\n    };\n}\n","const ORIENTATION_TOLERANCE = 1e-2;\nexport default function isPointOnLineSegment(lineStart, lineEnd, point) {\n    const minX = lineStart[0] <= lineEnd[0] ? lineStart[0] : lineEnd[0];\n    const maxX = lineStart[0] >= lineEnd[0] ? lineStart[0] : lineEnd[0];\n    const minY = lineStart[1] <= lineEnd[1] ? lineStart[1] : lineEnd[1];\n    const maxY = lineStart[1] >= lineEnd[1] ? lineStart[1] : lineEnd[1];\n    const aabbContainsPoint = point[0] >= minX - ORIENTATION_TOLERANCE &&\n        point[0] <= maxX + ORIENTATION_TOLERANCE &&\n        point[1] >= minY - ORIENTATION_TOLERANCE &&\n        point[1] <= maxY + ORIENTATION_TOLERANCE;\n    if (!aabbContainsPoint) {\n        return false;\n    }\n    const orientation = (lineEnd[1] - lineStart[1]) * (point[0] - lineEnd[0]) -\n        (lineEnd[0] - lineStart[0]) * (point[1] - lineEnd[1]);\n    const absOrientation = orientation >= 0 ? orientation : -orientation;\n    return absOrientation <= ORIENTATION_TOLERANCE;\n}\n","const midPoint = (...args) => {\n    const ret = args[0].length === 2 ? [0, 0] : [0, 0, 0];\n    const len = args.length;\n    for (const arg of args) {\n        ret[0] += arg[0] / len;\n        ret[1] += arg[1] / len;\n        if (ret.length === 3) {\n            ret[2] += arg[2] / len;\n        }\n    }\n    return ret;\n};\nconst midPoint2 = midPoint;\nexport default midPoint;\nexport { midPoint2 };\n","export default function distanceToPointSquared(p1, p2) {\n    if (p1.length !== p2.length) {\n        throw Error('Both points should have the same dimensionality');\n    }\n    const [x1, y1, z1 = 0] = p1;\n    const [x2, y2, z2 = 0] = p2;\n    const dx = x2 - x1;\n    const dy = y2 - y1;\n    const dz = z2 - z1;\n    return dx * dx + dy * dy + dz * dz;\n}\n","import distanceToPointSquared from './distanceToPointSquared';\nexport default function distanceToPoint(p1, p2) {\n    return Math.sqrt(distanceToPointSquared(p1, p2));\n}\n","export default function mirror(mirrorPoint, staticPoint) {\n    const [x1, y1] = mirrorPoint;\n    const [x2, y2] = staticPoint;\n    const newX = 2 * x2 - x1;\n    const newY = 2 * y2 - y1;\n    return [newX, newY];\n}\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { vec2, vec3 } from 'gl-matrix';\nconst addCanvasPointsToArray = (element, canvasPoints, newCanvasPoint, commonData) => {\n    const { xDir, yDir, spacing } = commonData;\n    const enabledElement = getEnabledElement(element);\n    const { viewport } = enabledElement;\n    if (!canvasPoints.length) {\n        canvasPoints.push(newCanvasPoint);\n        console.log('>>>>> !canvasPoints. :: RETURN');\n        return 1;\n    }\n    const lastWorldPos = viewport.canvasToWorld(canvasPoints[canvasPoints.length - 1]);\n    const newWorldPos = viewport.canvasToWorld(newCanvasPoint);\n    const worldPosDiff = vec3.create();\n    vec3.subtract(worldPosDiff, newWorldPos, lastWorldPos);\n    const xDist = Math.abs(vec3.dot(worldPosDiff, xDir));\n    const yDist = Math.abs(vec3.dot(worldPosDiff, yDir));\n    const numPointsToAdd = Math.max(Math.floor(xDist / spacing[0]), Math.floor(yDist / spacing[0]));\n    if (numPointsToAdd > 1) {\n        const lastCanvasPoint = canvasPoints[canvasPoints.length - 1];\n        const canvasDist = vec2.dist(lastCanvasPoint, newCanvasPoint);\n        const canvasDir = vec2.create();\n        vec2.subtract(canvasDir, newCanvasPoint, lastCanvasPoint);\n        vec2.set(canvasDir, canvasDir[0] / canvasDist, canvasDir[1] / canvasDist);\n        const distPerPoint = canvasDist / numPointsToAdd;\n        for (let i = 1; i <= numPointsToAdd; i++) {\n            canvasPoints.push([\n                lastCanvasPoint[0] + distPerPoint * canvasDir[0] * i,\n                lastCanvasPoint[1] + distPerPoint * canvasDir[1] * i,\n            ]);\n        }\n    }\n    else {\n        canvasPoints.push(newCanvasPoint);\n    }\n    return numPointsToAdd;\n};\nexport default addCanvasPointsToArray;\n","export default function areLineSegmentsIntersecting(p1, q1, p2, q2) {\n    let result = false;\n    const line1MinX = p1[0] < q1[0] ? p1[0] : q1[0];\n    const line1MinY = p1[1] < q1[1] ? p1[1] : q1[1];\n    const line1MaxX = p1[0] > q1[0] ? p1[0] : q1[0];\n    const line1MaxY = p1[1] > q1[1] ? p1[1] : q1[1];\n    const line2MinX = p2[0] < q2[0] ? p2[0] : q2[0];\n    const line2MinY = p2[1] < q2[1] ? p2[1] : q2[1];\n    const line2MaxX = p2[0] > q2[0] ? p2[0] : q2[0];\n    const line2MaxY = p2[1] > q2[1] ? p2[1] : q2[1];\n    if (line1MinX > line2MaxX ||\n        line1MaxX < line2MinX ||\n        line1MinY > line2MaxY ||\n        line1MaxY < line2MinY) {\n        return false;\n    }\n    const orient = [\n        orientation(p1, q1, p2),\n        orientation(p1, q1, q2),\n        orientation(p2, q2, p1),\n        orientation(p2, q2, q1),\n    ];\n    if (orient[0] !== orient[1] && orient[2] !== orient[3]) {\n        return true;\n    }\n    if (orient[0] === 0 && onSegment(p1, p2, q1)) {\n        result = true;\n    }\n    else if (orient[1] === 0 && onSegment(p1, q2, q1)) {\n        result = true;\n    }\n    else if (orient[2] === 0 && onSegment(p2, p1, q2)) {\n        result = true;\n    }\n    else if (orient[3] === 0 && onSegment(p2, q1, q2)) {\n        result = true;\n    }\n    return result;\n}\nfunction orientation(p, q, r) {\n    const orientationValue = (q[1] - p[1]) * (r[0] - q[0]) - (q[0] - p[0]) * (r[1] - q[1]);\n    if (orientationValue === 0) {\n        return 0;\n    }\n    return orientationValue > 0 ? 1 : 2;\n}\nfunction onSegment(p, q, r) {\n    if (q[0] <= Math.max(p[0], r[0]) &&\n        q[0] >= Math.min(p[0], r[0]) &&\n        q[1] <= Math.max(p[1], r[1]) &&\n        q[1] >= Math.min(p[1], r[1])) {\n        return true;\n    }\n    return false;\n}\n","import * as mathPoint from '../point';\nimport getLineSegmentIntersectionsIndexes from './getLineSegmentIntersectionsIndexes';\nimport containsPoint from './containsPoint';\nimport containsPoints from './containsPoints';\nimport intersectPolyline from './intersectPolyline';\nimport getNormal2 from './getNormal2';\nimport { glMatrix, vec3 } from 'gl-matrix';\nimport getLinesIntersection from './getLinesIntersection';\nvar PolylinePointType;\n(function (PolylinePointType) {\n    PolylinePointType[PolylinePointType[\"Vertex\"] = 0] = \"Vertex\";\n    PolylinePointType[PolylinePointType[\"Intersection\"] = 1] = \"Intersection\";\n})(PolylinePointType || (PolylinePointType = {}));\nvar PolylinePointPosition;\n(function (PolylinePointPosition) {\n    PolylinePointPosition[PolylinePointPosition[\"Outside\"] = -1] = \"Outside\";\n    PolylinePointPosition[PolylinePointPosition[\"Edge\"] = 0] = \"Edge\";\n    PolylinePointPosition[PolylinePointPosition[\"Inside\"] = 1] = \"Inside\";\n})(PolylinePointPosition || (PolylinePointPosition = {}));\nvar PolylinePointDirection;\n(function (PolylinePointDirection) {\n    PolylinePointDirection[PolylinePointDirection[\"Exiting\"] = -1] = \"Exiting\";\n    PolylinePointDirection[PolylinePointDirection[\"Unknown\"] = 0] = \"Unknown\";\n    PolylinePointDirection[PolylinePointDirection[\"Entering\"] = 1] = \"Entering\";\n})(PolylinePointDirection || (PolylinePointDirection = {}));\nfunction ensuresNextPointers(polylinePoints) {\n    for (let i = 0, len = polylinePoints.length; i < len; i++) {\n        const currentPoint = polylinePoints[i];\n        if (!currentPoint.next) {\n            currentPoint.next = polylinePoints[i === len - 1 ? 0 : i + 1];\n        }\n    }\n}\nfunction getSourceAndTargetPointsList(targetPolyline, sourcePolyline) {\n    const targetPolylinePoints = [];\n    const sourcePolylinePoints = [];\n    const sourceIntersectionsCache = new Map();\n    const isFirstPointInside = containsPoint(sourcePolyline, targetPolyline[0]);\n    let intersectionPointDirection = isFirstPointInside\n        ? PolylinePointDirection.Exiting\n        : PolylinePointDirection.Entering;\n    for (let i = 0, len = targetPolyline.length; i < len; i++) {\n        const p1 = targetPolyline[i];\n        const pointInside = containsPoint(sourcePolyline, p1);\n        const vertexPoint = {\n            type: PolylinePointType.Vertex,\n            coordinates: p1,\n            position: pointInside\n                ? PolylinePointPosition.Inside\n                : PolylinePointPosition.Outside,\n            visited: false,\n            next: null,\n        };\n        targetPolylinePoints.push(vertexPoint);\n        const q1 = targetPolyline[i === len - 1 ? 0 : i + 1];\n        const intersectionsInfo = getLineSegmentIntersectionsIndexes(sourcePolyline, p1, q1).map((intersectedLineSegment) => {\n            const sourceLineSegmentId = intersectedLineSegment[0];\n            const p2 = sourcePolyline[intersectedLineSegment[0]];\n            const q2 = sourcePolyline[intersectedLineSegment[1]];\n            const intersectionCoordinate = getLinesIntersection(p1, q1, p2, q2);\n            const targetStartPointDistSquared = mathPoint.distanceToPointSquared(p1, intersectionCoordinate);\n            return {\n                sourceLineSegmentId,\n                coordinate: intersectionCoordinate,\n                targetStartPointDistSquared,\n            };\n        });\n        intersectionsInfo.sort((left, right) => left.targetStartPointDistSquared - right.targetStartPointDistSquared);\n        intersectionsInfo.forEach((intersectionInfo) => {\n            const { sourceLineSegmentId, coordinate: intersectionCoordinate } = intersectionInfo;\n            const targetEdgePoint = {\n                type: PolylinePointType.Intersection,\n                coordinates: intersectionCoordinate,\n                position: PolylinePointPosition.Edge,\n                direction: intersectionPointDirection,\n                visited: false,\n                next: null,\n            };\n            const sourceEdgePoint = {\n                ...targetEdgePoint,\n                direction: PolylinePointDirection.Unknown,\n                cloned: true,\n            };\n            if (intersectionPointDirection === PolylinePointDirection.Entering) {\n                targetEdgePoint.next = sourceEdgePoint;\n            }\n            else {\n                sourceEdgePoint.next = targetEdgePoint;\n            }\n            let sourceIntersectionPoints = sourceIntersectionsCache.get(sourceLineSegmentId);\n            if (!sourceIntersectionPoints) {\n                sourceIntersectionPoints = [];\n                sourceIntersectionsCache.set(sourceLineSegmentId, sourceIntersectionPoints);\n            }\n            targetPolylinePoints.push(targetEdgePoint);\n            sourceIntersectionPoints.push(sourceEdgePoint);\n            intersectionPointDirection *= -1;\n        });\n    }\n    for (let i = 0, len = sourcePolyline.length; i < len; i++) {\n        const lineSegmentId = i;\n        const p1 = sourcePolyline[i];\n        const vertexPoint = {\n            type: PolylinePointType.Vertex,\n            coordinates: p1,\n            visited: false,\n            next: null,\n        };\n        sourcePolylinePoints.push(vertexPoint);\n        const sourceIntersectionPoints = sourceIntersectionsCache.get(lineSegmentId);\n        if (!sourceIntersectionPoints?.length) {\n            continue;\n        }\n        sourceIntersectionPoints\n            .map((intersectionPoint) => ({\n            intersectionPoint,\n            lineSegStartDistSquared: mathPoint.distanceToPointSquared(p1, intersectionPoint.coordinates),\n        }))\n            .sort((left, right) => left.lineSegStartDistSquared - right.lineSegStartDistSquared)\n            .map(({ intersectionPoint }) => intersectionPoint)\n            .forEach((intersectionPoint) => sourcePolylinePoints.push(intersectionPoint));\n    }\n    ensuresNextPointers(targetPolylinePoints);\n    ensuresNextPointers(sourcePolylinePoints);\n    return { targetPolylinePoints, sourcePolylinePoints };\n}\nfunction getUnvisitedOutsidePoint(polylinePoints) {\n    for (let i = 0, len = polylinePoints.length; i < len; i++) {\n        const point = polylinePoints[i];\n        if (!point.visited &&\n            point.position === PolylinePointPosition.Outside &&\n            point.type === PolylinePointType.Vertex) {\n            return point;\n        }\n    }\n    for (let i = 0, len = polylinePoints.length; i < len; i++) {\n        const point = polylinePoints[i];\n        if (!point.visited && point.position === PolylinePointPosition.Outside) {\n            return point;\n        }\n    }\n    return undefined;\n}\nfunction mergePolylines(targetPolyline, sourcePolyline) {\n    const targetNormal = getNormal2(targetPolyline);\n    const sourceNormal = getNormal2(sourcePolyline);\n    const dotNormals = vec3.dot(sourceNormal, targetNormal);\n    if (!glMatrix.equals(1, dotNormals)) {\n        sourcePolyline = sourcePolyline.slice().reverse();\n    }\n    const lineSegmentsIntersect = intersectPolyline(sourcePolyline, targetPolyline);\n    const targetContainedInSource = !lineSegmentsIntersect && containsPoints(sourcePolyline, targetPolyline);\n    if (targetContainedInSource) {\n        return sourcePolyline.slice();\n    }\n    const { targetPolylinePoints } = getSourceAndTargetPointsList(targetPolyline, sourcePolyline);\n    const startPoint = getUnvisitedOutsidePoint(targetPolylinePoints);\n    if (!startPoint) {\n        return targetPolyline.slice();\n    }\n    const mergedPolyline = [startPoint.coordinates];\n    let currentPoint = startPoint.next;\n    let iterationCount = 0;\n    const maxIterations = targetPolyline.length + sourcePolyline.length + 1000;\n    while (currentPoint !== startPoint && iterationCount < maxIterations) {\n        iterationCount++;\n        if (currentPoint.type === PolylinePointType.Intersection &&\n            currentPoint.cloned) {\n            currentPoint = currentPoint.next;\n            continue;\n        }\n        mergedPolyline.push(currentPoint.coordinates);\n        currentPoint = currentPoint.next;\n        if (!currentPoint) {\n            console.warn('Broken linked list detected in mergePolylines, breaking loop');\n            break;\n        }\n    }\n    if (iterationCount >= maxIterations) {\n        console.warn('Maximum iterations reached in mergePolylines, possible infinite loop detected');\n    }\n    return mergedPolyline;\n}\nexport { mergePolylines };\n","import isClosed from './isClosed';\nexport default function containsPoint(polyline, point, options = {\n    closed: undefined,\n}) {\n    if (polyline.length < 3) {\n        return false;\n    }\n    const numPolylinePoints = polyline.length;\n    let numIntersections = 0;\n    const { closed, holes } = options;\n    if (holes?.length) {\n        for (const hole of holes) {\n            if (containsPoint(hole, point)) {\n                return false;\n            }\n        }\n    }\n    const shouldClose = !(closed === undefined ? isClosed(polyline) : closed);\n    const maxSegmentIndex = polyline.length - (shouldClose ? 1 : 2);\n    for (let i = 0; i <= maxSegmentIndex; i++) {\n        const p1 = polyline[i];\n        const p2Index = i === numPolylinePoints - 1 ? 0 : i + 1;\n        const p2 = polyline[p2Index];\n        const maxX = p1[0] >= p2[0] ? p1[0] : p2[0];\n        const maxY = p1[1] >= p2[1] ? p1[1] : p2[1];\n        const minY = p1[1] <= p2[1] ? p1[1] : p2[1];\n        const mayIntersectLineSegment = point[0] <= maxX && point[1] >= minY && point[1] < maxY;\n        if (mayIntersectLineSegment) {\n            const isVerticalLine = p1[0] === p2[0];\n            let intersects = isVerticalLine;\n            if (!intersects) {\n                const xIntersection = ((point[1] - p1[1]) * (p2[0] - p1[0])) / (p2[1] - p1[1]) + p1[0];\n                intersects = point[0] <= xIntersection;\n            }\n            numIntersections += intersects ? 1 : 0;\n        }\n    }\n    return !!(numIntersections % 2);\n}\n","export default function convexHull(pts) {\n    if (pts.length < 3) {\n        return pts.slice();\n    }\n    const points = pts\n        .map((p) => [p[0], p[1]])\n        .sort((a, b) => a[0] === b[0] ? a[1] - b[1] : a[0] - b[0]);\n    function cross(o, a, b) {\n        return (a[0] - o[0]) * (b[1] - o[1]) - (a[1] - o[1]) * (b[0] - o[0]);\n    }\n    const lower = [];\n    for (const p of points) {\n        while (lower.length >= 2 &&\n            cross(lower[lower.length - 2], lower[lower.length - 1], p) <= 0) {\n            lower.pop();\n        }\n        lower.push(p);\n    }\n    const upper = [];\n    for (let i = points.length - 1; i >= 0; i--) {\n        const p = points[i];\n        while (upper.length >= 2 &&\n            cross(upper[upper.length - 2], upper[upper.length - 1], p) <= 0) {\n            upper.pop();\n        }\n        upper.push(p);\n    }\n    lower.pop();\n    upper.pop();\n    return lower.concat(upper);\n}\n","export default function getAABB(polyline, options) {\n    let polylineToUse = polyline;\n    const numDimensions = options?.numDimensions || 2;\n    const is3D = numDimensions === 3;\n    if (!Array.isArray(polyline[0])) {\n        const currentPolyline = polyline;\n        const totalPoints = currentPolyline.length / numDimensions;\n        polylineToUse = new Array(currentPolyline.length / numDimensions);\n        for (let i = 0, len = totalPoints; i < len; i++) {\n            polylineToUse[i] = [\n                currentPolyline[i * numDimensions],\n                currentPolyline[i * numDimensions + 1],\n            ];\n            if (is3D) {\n                polylineToUse[i].push(currentPolyline[i * numDimensions + 2]);\n            }\n        }\n    }\n    let minX = Infinity;\n    let minY = Infinity;\n    let maxX = -Infinity;\n    let maxY = -Infinity;\n    let minZ = Infinity;\n    let maxZ = -Infinity;\n    polylineToUse = polylineToUse;\n    for (let i = 0, len = polylineToUse.length; i < len; i++) {\n        const [x, y, z] = polylineToUse[i];\n        minX = minX < x ? minX : x;\n        minY = minY < y ? minY : y;\n        maxX = maxX > x ? maxX : x;\n        maxY = maxY > y ? maxY : y;\n        if (is3D) {\n            minZ = minZ < z ? minZ : z;\n            maxZ = maxZ > z ? maxZ : z;\n        }\n    }\n    return is3D\n        ? { minX, maxX, minY, maxY, minZ, maxZ }\n        : { minX, maxX, minY, maxY };\n}\n","export default function getArea(points) {\n    const n = points.length;\n    let area = 0.0;\n    let j = n - 1;\n    for (let i = 0; i < n; i++) {\n        area += (points[j][0] + points[i][0]) * (points[j][1] - points[i][1]);\n        j = i;\n    }\n    return Math.abs(area / 2.0);\n}\n","import { vec2 } from 'gl-matrix';\nimport areLineSegmentsIntersecting from './areLineSegmentsIntersecting';\nexport default function getClosestLineSegmentIntersection(points, p1, q1, closed = true) {\n    let initialQ2Index;\n    let p2Index;\n    if (closed) {\n        p2Index = points.length - 1;\n        initialQ2Index = 0;\n    }\n    else {\n        p2Index = 0;\n        initialQ2Index = 1;\n    }\n    const intersections = [];\n    for (let q2Index = initialQ2Index; q2Index < points.length; q2Index++) {\n        const p2 = points[p2Index];\n        const q2 = points[q2Index];\n        if (areLineSegmentsIntersecting(p1, q1, p2, q2)) {\n            intersections.push([p2Index, q2Index]);\n        }\n        p2Index = q2Index;\n    }\n    if (intersections.length === 0) {\n        return;\n    }\n    const distances = [];\n    intersections.forEach((intersection) => {\n        const intersectionPoints = [\n            points[intersection[0]],\n            points[intersection[1]],\n        ];\n        const midpoint = [\n            (intersectionPoints[0][0] + intersectionPoints[1][0]) / 2,\n            (intersectionPoints[0][1] + intersectionPoints[1][1]) / 2,\n        ];\n        distances.push(vec2.distance(midpoint, p1));\n    });\n    const minDistance = Math.min(...distances);\n    const indexOfMinDistance = distances.indexOf(minDistance);\n    return {\n        segment: intersections[indexOfMinDistance],\n        distance: minDistance,\n    };\n}\n","import areLineSegmentsIntersecting from './areLineSegmentsIntersecting';\nexport default function getFirstLineSegmentIntersectionIndexes(points, p1, q1, closed = true) {\n    let initialI;\n    let j;\n    if (closed) {\n        j = points.length - 1;\n        initialI = 0;\n    }\n    else {\n        j = 0;\n        initialI = 1;\n    }\n    for (let i = initialI; i < points.length; i++) {\n        const p2 = points[j];\n        const q2 = points[i];\n        if (areLineSegmentsIntersecting(p1, q1, p2, q2)) {\n            return [j, i];\n        }\n        j = i;\n    }\n}\n","import getLineSegmentIntersectionsIndexes from './getLineSegmentIntersectionsIndexes';\nimport getLinesIntersection from './getLinesIntersection';\nexport default function getLineSegmentIntersectionsCoordinates(points, p1, q1, closed = true) {\n    const result = [];\n    const polylineIndexes = getLineSegmentIntersectionsIndexes(points, p1, q1, closed);\n    for (let i = 0; i < polylineIndexes.length; i++) {\n        const p2 = points[polylineIndexes[i][0]];\n        const q2 = points[polylineIndexes[i][1]];\n        const intersection = getLinesIntersection(p1, q1, p2, q2);\n        result.push(intersection);\n    }\n    return result;\n}\n","import areLineSegmentsIntersecting from './areLineSegmentsIntersecting';\nexport default function getLineSegmentIntersectionsIndexes(polyline, p1, q1, closed = true) {\n    const intersections = [];\n    const numPoints = polyline.length;\n    const maxI = numPoints - (closed ? 1 : 2);\n    for (let i = 0; i <= maxI; i++) {\n        const p2 = polyline[i];\n        const j = i === numPoints - 1 ? 0 : i + 1;\n        const q2 = polyline[j];\n        if (areLineSegmentsIntersecting(p1, q1, p2, q2)) {\n            intersections.push([i, j]);\n        }\n    }\n    return intersections;\n}\n","import * as mathLine from '../line';\nconst PARALLEL_LINES_TOLERANCE = 1e-2;\nexport default function getLinesIntersection(p1, q1, p2, q2) {\n    const diffQ1P1 = [q1[0] - p1[0], q1[1] - p1[1]];\n    const diffQ2P2 = [q2[0] - p2[0], q2[1] - p2[1]];\n    const denominator = diffQ2P2[1] * diffQ1P1[0] - diffQ2P2[0] * diffQ1P1[1];\n    const absDenominator = denominator >= 0 ? denominator : -denominator;\n    if (absDenominator < PARALLEL_LINES_TOLERANCE) {\n        const line1AABB = [\n            p1[0] < q1[0] ? p1[0] : q1[0],\n            p1[0] > q1[0] ? p1[0] : q1[0],\n            p1[1] < q1[1] ? p1[1] : q1[1],\n            p1[1] > q1[1] ? p1[1] : q1[1],\n        ];\n        const line2AABB = [\n            p2[0] < q2[0] ? p2[0] : q2[0],\n            p2[0] > q2[0] ? p2[0] : q2[0],\n            p2[1] < q2[1] ? p2[1] : q2[1],\n            p2[1] > q2[1] ? p2[1] : q2[1],\n        ];\n        const aabbIntersects = line1AABB[0] <= line2AABB[1] &&\n            line1AABB[1] >= line2AABB[0] &&\n            line1AABB[2] <= line2AABB[3] &&\n            line1AABB[3] >= line2AABB[2];\n        if (!aabbIntersects) {\n            return;\n        }\n        const overlap = mathLine.isPointOnLineSegment(p1, q1, p2) ||\n            mathLine.isPointOnLineSegment(p1, q1, q2) ||\n            mathLine.isPointOnLineSegment(p2, q2, p1);\n        if (!overlap) {\n            return;\n        }\n        const minX = line1AABB[0] > line2AABB[0] ? line1AABB[0] : line2AABB[0];\n        const maxX = line1AABB[1] < line2AABB[1] ? line1AABB[1] : line2AABB[1];\n        const minY = line1AABB[2] > line2AABB[2] ? line1AABB[2] : line2AABB[2];\n        const maxY = line1AABB[3] < line2AABB[3] ? line1AABB[3] : line2AABB[3];\n        const midX = (minX + maxX) * 0.5;\n        const midY = (minY + maxY) * 0.5;\n        return [midX, midY];\n    }\n    let a = p1[1] - p2[1];\n    let b = p1[0] - p2[0];\n    const numerator1 = diffQ2P2[0] * a - diffQ2P2[1] * b;\n    const numerator2 = diffQ1P1[0] * a - diffQ1P1[1] * b;\n    a = numerator1 / denominator;\n    b = numerator2 / denominator;\n    const resultX = p1[0] + a * diffQ1P1[0];\n    const resultY = p1[1] + a * diffQ1P1[1];\n    return [resultX, resultY];\n}\n","import getSignedArea from './getSignedArea';\nexport default function getNormal2(polyline) {\n    const area = getSignedArea(polyline);\n    return [0, 0, area / Math.abs(area)];\n}\n","import { vec3 } from 'gl-matrix';\nfunction _getAreaVector(polyline) {\n    const vecArea = vec3.create();\n    const refPoint = polyline[0];\n    for (let i = 0, len = polyline.length; i < len; i++) {\n        const p1 = polyline[i];\n        const p2Index = i === len - 1 ? 0 : i + 1;\n        const p2 = polyline[p2Index];\n        const aX = p1[0] - refPoint[0];\n        const aY = p1[1] - refPoint[1];\n        const aZ = p1[2] - refPoint[2];\n        const bX = p2[0] - refPoint[0];\n        const bY = p2[1] - refPoint[1];\n        const bZ = p2[2] - refPoint[2];\n        vecArea[0] += aY * bZ - aZ * bY;\n        vecArea[1] += aZ * bX - aX * bZ;\n        vecArea[2] += aX * bY - aY * bX;\n    }\n    vec3.scale(vecArea, vecArea, 0.5);\n    return vecArea;\n}\nexport default function getNormal3(polyline) {\n    const vecArea = _getAreaVector(polyline);\n    return vec3.normalize(vecArea, vecArea);\n}\n","import { StackViewport } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nconst EPSILON = 1e-3;\nconst getSubPixelSpacingAndXYDirections = (viewport, subPixelResolution) => {\n    let spacing;\n    let xDir;\n    let yDir;\n    if (viewport instanceof StackViewport) {\n        const imageData = viewport.getImageData();\n        if (!imageData) {\n            return;\n        }\n        xDir = imageData.direction.slice(0, 3);\n        yDir = imageData.direction.slice(3, 6);\n        spacing = imageData.spacing;\n    }\n    else {\n        const imageData = viewport.getImageData();\n        const { direction, spacing: volumeSpacing } = imageData;\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const iVector = direction.slice(0, 3);\n        const jVector = direction.slice(3, 6);\n        const kVector = direction.slice(6, 9);\n        const viewRight = vec3.create();\n        vec3.cross(viewRight, viewUp, viewPlaneNormal);\n        const absViewRightDotI = Math.abs(vec3.dot(viewRight, iVector));\n        const absViewRightDotJ = Math.abs(vec3.dot(viewRight, jVector));\n        const absViewRightDotK = Math.abs(vec3.dot(viewRight, kVector));\n        let xSpacing;\n        if (Math.abs(1 - absViewRightDotI) < EPSILON) {\n            xSpacing = volumeSpacing[0];\n            xDir = iVector;\n        }\n        else if (Math.abs(1 - absViewRightDotJ) < EPSILON) {\n            xSpacing = volumeSpacing[1];\n            xDir = jVector;\n        }\n        else if (Math.abs(1 - absViewRightDotK) < EPSILON) {\n            xSpacing = volumeSpacing[2];\n            xDir = kVector;\n        }\n        else {\n            throw new Error('No support yet for oblique plane planar contours');\n        }\n        const absViewUpDotI = Math.abs(vec3.dot(viewUp, iVector));\n        const absViewUpDotJ = Math.abs(vec3.dot(viewUp, jVector));\n        const absViewUpDotK = Math.abs(vec3.dot(viewUp, kVector));\n        let ySpacing;\n        if (Math.abs(1 - absViewUpDotI) < EPSILON) {\n            ySpacing = volumeSpacing[0];\n            yDir = iVector;\n        }\n        else if (Math.abs(1 - absViewUpDotJ) < EPSILON) {\n            ySpacing = volumeSpacing[1];\n            yDir = jVector;\n        }\n        else if (Math.abs(1 - absViewUpDotK) < EPSILON) {\n            ySpacing = volumeSpacing[2];\n            yDir = kVector;\n        }\n        else {\n            throw new Error('No support yet for oblique plane planar contours');\n        }\n        spacing = [xSpacing, ySpacing];\n    }\n    const subPixelSpacing = [\n        spacing[0] / subPixelResolution,\n        spacing[1] / subPixelResolution,\n    ];\n    return { spacing: subPixelSpacing, xDir, yDir };\n};\nexport default getSubPixelSpacingAndXYDirections;\n","import getSignedArea from './getSignedArea';\nexport default function getWindingDirection(polyline) {\n    const signedArea = getSignedArea(polyline);\n    return signedArea >= 0 ? 1 : -1;\n}\n","import getFirstLineSegmentIntersectionIndexes from './getFirstLineSegmentIntersectionIndexes';\nexport default function intersectPolyline(sourcePolyline, targetPolyline) {\n    for (let i = 0, sourceLen = sourcePolyline.length; i < sourceLen; i++) {\n        const sourceP1 = sourcePolyline[i];\n        const sourceP2Index = i === sourceLen - 1 ? 0 : i + 1;\n        const sourceP2 = sourcePolyline[sourceP2Index];\n        const intersectionPointIndexes = getFirstLineSegmentIntersectionIndexes(targetPolyline, sourceP1, sourceP2);\n        if (intersectionPointIndexes?.length === 2) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { vec2 } from 'gl-matrix';\nimport containsPoint from './containsPoint';\nimport getSignedArea from './getSignedArea';\nimport { EPSILON, IntersectionDirection, pointsAreEqual, PolylineNodeType, robustSegmentIntersection, } from './robustSegmentIntersection';\nexport default function intersectPolylines(mainPolyCoords, clipPolyCoordsInput) {\n    if (mainPolyCoords.length < 3 || clipPolyCoordsInput.length < 3) {\n        return [];\n    }\n    let clipPolyCoords = clipPolyCoordsInput.slice();\n    const mainArea = getSignedArea(mainPolyCoords);\n    const clipArea = getSignedArea(clipPolyCoords);\n    if (Math.abs(mainArea) < EPSILON || Math.abs(clipArea) < EPSILON) {\n        return [];\n    }\n    if (mainArea < 0) {\n        mainPolyCoords = mainPolyCoords.slice().reverse();\n    }\n    if (clipArea < 0) {\n        clipPolyCoords = clipPolyCoords.slice().reverse();\n    }\n    const currentClipPolyForPIP = clipPolyCoords;\n    const intersections = [];\n    for (let i = 0; i < mainPolyCoords.length; i++) {\n        const p1 = mainPolyCoords[i];\n        const p2 = mainPolyCoords[(i + 1) % mainPolyCoords.length];\n        for (let j = 0; j < clipPolyCoords.length; j++) {\n            const q1 = clipPolyCoords[j];\n            const q2 = clipPolyCoords[(j + 1) % clipPolyCoords.length];\n            const intersectPt = robustSegmentIntersection(p1, p2, q1, q2);\n            if (intersectPt) {\n                const lenP = Math.sqrt(vec2.squaredDistance(p1, p2));\n                const lenQ = Math.sqrt(vec2.squaredDistance(q1, q2));\n                intersections.push({\n                    coord: [...intersectPt],\n                    seg1Idx: i,\n                    seg2Idx: j,\n                    alpha1: lenP < EPSILON\n                        ? 0\n                        : Math.sqrt(vec2.squaredDistance(p1, intersectPt)) / lenP,\n                    alpha2: lenQ < EPSILON\n                        ? 0\n                        : Math.sqrt(vec2.squaredDistance(q1, intersectPt)) / lenQ,\n                });\n            }\n        }\n    }\n    if (intersections.length === 0) {\n        if (containsPoint(currentClipPolyForPIP, mainPolyCoords[0]) &&\n            mainPolyCoords.every((pt) => containsPoint(currentClipPolyForPIP, pt))) {\n            return [[...mainPolyCoords.map((p) => [...p])]];\n        }\n        if (containsPoint(mainPolyCoords, clipPolyCoords[0]) &&\n            clipPolyCoords.every((pt) => containsPoint(mainPolyCoords, pt))) {\n            return [[...clipPolyCoords.map((p) => [...p])]];\n        }\n        return [];\n    }\n    const buildAugmentedList = (polyCoords, polyIndex, allIntersections) => {\n        const augmentedList = [];\n        let nodeIdCounter = 0;\n        for (let i = 0; i < polyCoords.length; i++) {\n            const p1 = polyCoords[i];\n            augmentedList.push({\n                id: `${polyIndex}_v${nodeIdCounter++}`,\n                coordinates: [...p1],\n                type: PolylineNodeType.Vertex,\n                originalPolyIndex: polyIndex,\n                originalVertexIndex: i,\n                next: null,\n                prev: null,\n                isIntersection: false,\n                visited: false,\n                processedInPath: false,\n                intersectionDir: IntersectionDirection.Unknown,\n            });\n            const segmentIntersections = allIntersections\n                .filter((isect) => (polyIndex === 0 ? isect.seg1Idx : isect.seg2Idx) === i)\n                .sort((a, b) => (polyIndex === 0 ? a.alpha1 : a.alpha2) -\n                (polyIndex === 0 ? b.alpha1 : b.alpha2));\n            for (const isect of segmentIntersections) {\n                if (augmentedList.length > 0 &&\n                    pointsAreEqual(augmentedList[augmentedList.length - 1].coordinates, isect.coord)) {\n                    const lastNode = augmentedList[augmentedList.length - 1];\n                    if (!lastNode.isIntersection) {\n                        lastNode.isIntersection = true;\n                        lastNode.intersectionInfo = isect;\n                        lastNode.alpha = polyIndex === 0 ? isect.alpha1 : isect.alpha2;\n                        lastNode.type = PolylineNodeType.Intersection;\n                    }\n                    continue;\n                }\n                augmentedList.push({\n                    id: `${polyIndex}_i${nodeIdCounter++}`,\n                    coordinates: [...isect.coord],\n                    type: PolylineNodeType.Intersection,\n                    originalPolyIndex: polyIndex,\n                    next: null,\n                    prev: null,\n                    isIntersection: true,\n                    visited: false,\n                    processedInPath: false,\n                    alpha: polyIndex === 0 ? isect.alpha1 : isect.alpha2,\n                    intersectionInfo: isect,\n                    intersectionDir: IntersectionDirection.Unknown,\n                });\n            }\n        }\n        const finalList = [];\n        if (augmentedList.length > 0) {\n            finalList.push(augmentedList[0]);\n            for (let i = 1; i < augmentedList.length; i++) {\n                if (!pointsAreEqual(augmentedList[i].coordinates, finalList[finalList.length - 1].coordinates)) {\n                    finalList.push(augmentedList[i]);\n                }\n                else {\n                    const lastNodeInFinal = finalList[finalList.length - 1];\n                    if (augmentedList[i].isIntersection &&\n                        augmentedList[i].intersectionInfo) {\n                        lastNodeInFinal.isIntersection = true;\n                        lastNodeInFinal.intersectionInfo =\n                            augmentedList[i].intersectionInfo;\n                        lastNodeInFinal.alpha = augmentedList[i].alpha;\n                        lastNodeInFinal.type = PolylineNodeType.Intersection;\n                    }\n                }\n            }\n        }\n        if (finalList.length > 1 &&\n            pointsAreEqual(finalList[0].coordinates, finalList[finalList.length - 1].coordinates)) {\n            const firstNode = finalList[0];\n            const lastNodePopped = finalList.pop();\n            if (lastNodePopped.isIntersection &&\n                !firstNode.isIntersection &&\n                lastNodePopped.intersectionInfo) {\n                firstNode.isIntersection = true;\n                firstNode.intersectionInfo = lastNodePopped.intersectionInfo;\n                firstNode.alpha = lastNodePopped.alpha;\n                firstNode.type = PolylineNodeType.Intersection;\n            }\n        }\n        if (finalList.length > 0) {\n            for (let i = 0; i < finalList.length; i++) {\n                finalList[i].next = finalList[(i + 1) % finalList.length];\n                finalList[i].prev =\n                    finalList[(i - 1 + finalList.length) % finalList.length];\n            }\n        }\n        return finalList;\n    };\n    const mainAugmented = buildAugmentedList(mainPolyCoords, 0, intersections);\n    const clipAugmented = buildAugmentedList(clipPolyCoords, 1, intersections);\n    if (mainAugmented.length === 0 || clipAugmented.length === 0) {\n        return [];\n    }\n    mainAugmented.forEach((mainNode) => {\n        if (mainNode.isIntersection && mainNode.intersectionInfo) {\n            const mainIntersectData = mainNode.intersectionInfo;\n            const partnerNode = clipAugmented.find((clipNode) => clipNode.isIntersection &&\n                clipNode.intersectionInfo &&\n                pointsAreEqual(clipNode.coordinates, mainNode.coordinates) &&\n                clipNode.intersectionInfo.seg1Idx === mainIntersectData.seg1Idx &&\n                clipNode.intersectionInfo.seg2Idx === mainIntersectData.seg2Idx);\n            if (partnerNode) {\n                mainNode.partnerNode = partnerNode;\n                partnerNode.partnerNode = mainNode;\n                const v_arrival_main = vec2.subtract(vec2.create(), mainNode.coordinates, mainNode.prev.coordinates);\n                const v_departure_clip = vec2.subtract(vec2.create(), partnerNode.next.coordinates, partnerNode.coordinates);\n                const crossZ = v_arrival_main[0] * v_departure_clip[1] -\n                    v_arrival_main[1] * v_departure_clip[0];\n                if (crossZ > EPSILON) {\n                    mainNode.intersectionDir = IntersectionDirection.Entering;\n                    partnerNode.intersectionDir = IntersectionDirection.Exiting;\n                }\n                else if (crossZ < -EPSILON) {\n                    mainNode.intersectionDir = IntersectionDirection.Exiting;\n                    partnerNode.intersectionDir = IntersectionDirection.Entering;\n                }\n                else {\n                    const midPrevMainSeg = [\n                        (mainNode.prev.coordinates[0] + mainNode.coordinates[0]) / 2,\n                        (mainNode.prev.coordinates[1] + mainNode.coordinates[1]) / 2,\n                    ];\n                    if (containsPoint(currentClipPolyForPIP, midPrevMainSeg)) {\n                        mainNode.intersectionDir = IntersectionDirection.Exiting;\n                        partnerNode.intersectionDir = IntersectionDirection.Entering;\n                    }\n                    else {\n                        mainNode.intersectionDir = IntersectionDirection.Entering;\n                        partnerNode.intersectionDir = IntersectionDirection.Exiting;\n                    }\n                }\n            }\n            else {\n                mainNode.isIntersection = false;\n                mainNode.intersectionInfo = undefined;\n            }\n        }\n    });\n    const resultPolygons = [];\n    for (const startCand of mainAugmented) {\n        if (!startCand.isIntersection ||\n            startCand.visited ||\n            startCand.intersectionDir !== IntersectionDirection.Entering) {\n            continue;\n        }\n        let currentPathCoords = [];\n        let currentNode = startCand;\n        let onMainList = true;\n        const pathStartNode = startCand;\n        let safetyBreak = 0;\n        const maxIter = (mainAugmented.length + clipAugmented.length) * 2;\n        mainAugmented.forEach((n) => (n.processedInPath = false));\n        clipAugmented.forEach((n) => (n.processedInPath = false));\n        do {\n            if (safetyBreak++ > maxIter) {\n                console.warn('Intersection: Max iterations in path tracing.', pathStartNode.id, currentNode.id);\n                currentPathCoords = [];\n                break;\n            }\n            if (currentNode.processedInPath && currentNode !== pathStartNode) {\n                console.warn('Intersection: Path processing loop detected, discarding path segment.', pathStartNode.id, currentNode.id);\n                currentPathCoords = [];\n                break;\n            }\n            currentNode.processedInPath = true;\n            currentNode.visited = true;\n            if (currentPathCoords.length === 0 ||\n                !pointsAreEqual(currentPathCoords[currentPathCoords.length - 1], currentNode.coordinates)) {\n                currentPathCoords.push([...currentNode.coordinates]);\n            }\n            let switchedList = false;\n            if (currentNode.isIntersection && currentNode.partnerNode) {\n                if (onMainList) {\n                    currentNode = currentNode.partnerNode;\n                    onMainList = false;\n                    switchedList = true;\n                }\n                else {\n                    currentNode = currentNode.partnerNode;\n                    onMainList = true;\n                    switchedList = true;\n                }\n            }\n            if (!switchedList) {\n                currentNode = currentNode.next;\n            }\n            else {\n                currentNode = currentNode.next;\n            }\n        } while (currentNode !== pathStartNode ||\n            (onMainList && currentNode.originalPolyIndex !== 0) ||\n            (!onMainList && currentNode.originalPolyIndex !== 1));\n        if (safetyBreak > maxIter || currentPathCoords.length === 0) {\n        }\n        else if (currentPathCoords.length > 0 &&\n            pointsAreEqual(currentPathCoords[0], currentPathCoords[currentPathCoords.length - 1])) {\n            currentPathCoords.pop();\n        }\n        if (currentPathCoords.length >= 3) {\n            const resultArea = getSignedArea(currentPathCoords);\n            if (mainArea > 0 && resultArea < 0) {\n                currentPathCoords.reverse();\n            }\n            else if (mainArea < 0 && resultArea > 0) {\n                currentPathCoords.reverse();\n            }\n            resultPolygons.push(currentPathCoords.map((p) => [...p]));\n        }\n    }\n    return resultPolygons;\n}\n","import containsPoint from './containsPoint';\nimport { projectTo2D } from './projectTo2D';\nexport function isPointInsidePolyline3D(point, polyline, options = {}) {\n    const { sharedDimensionIndex, projectedPolyline } = projectTo2D(polyline);\n    const { holes } = options;\n    const projectedHoles = [];\n    if (holes) {\n        for (let i = 0; i < holes.length; i++) {\n            const hole = holes[i];\n            const hole2D = [];\n            for (let j = 0; j < hole.length; j++) {\n                hole2D.push([\n                    hole[j][(sharedDimensionIndex + 1) % 3],\n                    hole[j][(sharedDimensionIndex + 2) % 3],\n                ]);\n            }\n            projectedHoles.push(hole2D);\n        }\n    }\n    const point2D = [\n        point[(sharedDimensionIndex + 1) % 3],\n        point[(sharedDimensionIndex + 2) % 3],\n    ];\n    return containsPoint(projectedPolyline, point2D, { holes: projectedHoles });\n}\n","import { vec2 } from 'gl-matrix';\nconst pointCanProjectOnLine = (p, p1, p2, proximity) => {\n    const p1p = [p[0] - p1[0], p[1] - p1[1]];\n    const p1p2 = [p2[0] - p1[0], p2[1] - p1[1]];\n    const dot = p1p[0] * p1p2[0] + p1p[1] * p1p2[1];\n    if (dot < 0) {\n        return false;\n    }\n    const p1p2Mag = Math.sqrt(p1p2[0] * p1p2[0] + p1p2[1] * p1p2[1]);\n    if (p1p2Mag === 0) {\n        return false;\n    }\n    const projectionVectorMag = dot / p1p2Mag;\n    const p1p2UnitVector = [p1p2[0] / p1p2Mag, p1p2[1] / p1p2Mag];\n    const projectionVector = [\n        p1p2UnitVector[0] * projectionVectorMag,\n        p1p2UnitVector[1] * projectionVectorMag,\n    ];\n    const projectionPoint = [\n        p1[0] + projectionVector[0],\n        p1[1] + projectionVector[1],\n    ];\n    const distance = vec2.distance(p, projectionPoint);\n    if (distance > proximity) {\n        return false;\n    }\n    if (vec2.distance(p1, projectionPoint) > vec2.distance(p1, p2)) {\n        return false;\n    }\n    return true;\n};\nexport default pointCanProjectOnLine;\n","import { vec2 } from 'gl-matrix';\nconst pointsAreWithinCloseContourProximity = (p1, p2, closeContourProximity) => {\n    return vec2.dist(p1, p2) < closeContourProximity;\n};\nexport default pointsAreWithinCloseContourProximity;\n","import { utilities } from '@cornerstonejs/core';\nconst epsilon = 1e-6;\nexport function projectTo2D(polyline) {\n    let sharedDimensionIndex;\n    const testPoints = utilities.getRandomSampleFromArray(polyline, 50);\n    for (let i = 0; i < 3; i++) {\n        if (testPoints.every((point, index, array) => Math.abs(point[i] - array[0][i]) < epsilon)) {\n            sharedDimensionIndex = i;\n            break;\n        }\n    }\n    if (sharedDimensionIndex === undefined) {\n        throw new Error('Cannot find a shared dimension index for polyline, probably oblique plane');\n    }\n    const points2D = [];\n    const firstDim = (sharedDimensionIndex + 1) % 3;\n    const secondDim = (sharedDimensionIndex + 2) % 3;\n    for (let i = 0; i < polyline.length; i++) {\n        points2D.push([polyline[i][firstDim], polyline[i][secondDim]]);\n    }\n    return {\n        sharedDimensionIndex,\n        projectedPolyline: points2D,\n    };\n}\n","import { utilities } from '@cornerstonejs/core';\nimport { vec2 } from 'gl-matrix';\nexport const EPSILON = 1e-7;\nexport function vec2CrossZ(a, b) {\n    return a[0] * b[1] - a[1] * b[0];\n}\nexport function pointsAreEqual(p1, p2) {\n    return utilities.isEqual(p1, p2, EPSILON);\n}\nexport function robustSegmentIntersection(p1, p2, q1, q2) {\n    const r = vec2.subtract(vec2.create(), p2, p1);\n    const s = vec2.subtract(vec2.create(), q2, q1);\n    const rxs = vec2CrossZ(r, s);\n    const qmp = vec2.subtract(vec2.create(), q1, p1);\n    const qmpxr = vec2CrossZ(qmp, r);\n    if (Math.abs(rxs) < EPSILON) {\n        if (Math.abs(qmpxr) < EPSILON) {\n            const rDotR = vec2.dot(r, r);\n            const sDotS = vec2.dot(s, s);\n            if (rDotR < EPSILON || sDotS < EPSILON) {\n                if (pointsAreEqual(p1, q1) || pointsAreEqual(p1, q2)) {\n                    return p1;\n                }\n                if (pointsAreEqual(p2, q1) || pointsAreEqual(p2, q2)) {\n                    return p2;\n                }\n                return null;\n            }\n            const t0 = vec2.dot(vec2.subtract(vec2.create(), q1, p1), r) / rDotR;\n            const t1 = vec2.dot(vec2.subtract(vec2.create(), q2, p1), r) / rDotR;\n            const u0 = vec2.dot(vec2.subtract(vec2.create(), p1, q1), s) / sDotS;\n            const u1 = vec2.dot(vec2.subtract(vec2.create(), p2, q1), s) / sDotS;\n            const isInRange = (t) => t >= -EPSILON && t <= 1 + EPSILON;\n            if (isInRange(t0)) {\n                const projectedPoint = vec2.scaleAndAdd(vec2.create(), p1, r, t0);\n                if (pointsAreEqual(q1, projectedPoint)) {\n                    return q1;\n                }\n            }\n            if (isInRange(t1)) {\n                const projectedPoint = vec2.scaleAndAdd(vec2.create(), p1, r, t1);\n                if (pointsAreEqual(q2, projectedPoint)) {\n                    return q2;\n                }\n            }\n            if (isInRange(u0)) {\n                const projectedPoint = vec2.scaleAndAdd(vec2.create(), q1, s, u0);\n                if (pointsAreEqual(p1, projectedPoint)) {\n                    return p1;\n                }\n            }\n            if (isInRange(u1)) {\n                const projectedPoint = vec2.scaleAndAdd(vec2.create(), q1, s, u1);\n                if (pointsAreEqual(p2, projectedPoint)) {\n                    return p2;\n                }\n            }\n        }\n        return null;\n    }\n    const t = vec2CrossZ(qmp, s) / rxs;\n    const u = qmpxr / rxs;\n    if (t >= -EPSILON && t <= 1 + EPSILON && u >= -EPSILON && u <= 1 + EPSILON) {\n        return [p1[0] + t * r[0], p1[1] + t * r[1]];\n    }\n    return null;\n}\nexport var PolylineNodeType;\n(function (PolylineNodeType) {\n    PolylineNodeType[PolylineNodeType[\"Vertex\"] = 0] = \"Vertex\";\n    PolylineNodeType[PolylineNodeType[\"Intersection\"] = 1] = \"Intersection\";\n})(PolylineNodeType || (PolylineNodeType = {}));\nexport var IntersectionDirection;\n(function (IntersectionDirection) {\n    IntersectionDirection[IntersectionDirection[\"Entering\"] = 0] = \"Entering\";\n    IntersectionDirection[IntersectionDirection[\"Exiting\"] = 1] = \"Exiting\";\n    IntersectionDirection[IntersectionDirection[\"Unknown\"] = 2] = \"Unknown\";\n})(IntersectionDirection || (IntersectionDirection = {}));\n","import { vec2 } from 'gl-matrix';\nimport getSignedArea from './getSignedArea';\nimport { EPSILON, IntersectionDirection, pointsAreEqual, PolylineNodeType, robustSegmentIntersection, } from './robustSegmentIntersection';\nimport containsPoint from './containsPoint';\nimport arePolylinesIdentical from './arePolylinesIdentical';\nexport default function subtractPolylines(targetPolylineCoords, sourcePolylineCoordsInput) {\n    if (targetPolylineCoords.length < 3) {\n        return [];\n    }\n    if (sourcePolylineCoordsInput.length < 3) {\n        return [targetPolylineCoords.slice()];\n    }\n    const sourcePolylineCoords = sourcePolylineCoordsInput.slice();\n    if (arePolylinesIdentical(targetPolylineCoords, sourcePolylineCoordsInput)) {\n        return [];\n    }\n    const targetArea = getSignedArea(targetPolylineCoords);\n    const sourceArea = getSignedArea(sourcePolylineCoords);\n    if (Math.sign(targetArea) === Math.sign(sourceArea) &&\n        Math.abs(sourceArea) > EPSILON) {\n        sourcePolylineCoords.reverse();\n    }\n    const intersections = [];\n    for (let i = 0; i < targetPolylineCoords.length; i++) {\n        const p1 = targetPolylineCoords[i];\n        const p2 = targetPolylineCoords[(i + 1) % targetPolylineCoords.length];\n        for (let j = 0; j < sourcePolylineCoords.length; j++) {\n            const q1 = sourcePolylineCoords[j];\n            const q2 = sourcePolylineCoords[(j + 1) % sourcePolylineCoords.length];\n            const intersectPt = robustSegmentIntersection(p1, p2, q1, q2);\n            if (intersectPt) {\n                const lenP = Math.sqrt(vec2.squaredDistance(p1, p2));\n                const lenQ = Math.sqrt(vec2.squaredDistance(q1, q2));\n                intersections.push({\n                    coord: intersectPt,\n                    seg1Idx: i,\n                    seg2Idx: j,\n                    alpha1: lenP < EPSILON\n                        ? 0\n                        : Math.sqrt(vec2.squaredDistance(p1, intersectPt)) / lenP,\n                    alpha2: lenQ < EPSILON\n                        ? 0\n                        : Math.sqrt(vec2.squaredDistance(q1, intersectPt)) / lenQ,\n                });\n            }\n        }\n    }\n    const buildAugmentedList = (polyCoords, polyIndex, allIntersections) => {\n        const augmentedList = [];\n        let nodeIdCounter = 0;\n        for (let i = 0; i < polyCoords.length; i++) {\n            const p1 = polyCoords[i];\n            augmentedList.push({\n                id: `${polyIndex}_v${nodeIdCounter++}`,\n                coordinates: p1,\n                type: PolylineNodeType.Vertex,\n                originalPolyIndex: polyIndex,\n                originalVertexIndex: i,\n                next: null,\n                prev: null,\n                isIntersection: false,\n                visited: false,\n            });\n            const segmentIntersections = allIntersections\n                .filter((isect) => (polyIndex === 0 ? isect.seg1Idx : isect.seg2Idx) === i)\n                .sort((a, b) => (polyIndex === 0 ? a.alpha1 : a.alpha2) -\n                (polyIndex === 0 ? b.alpha1 : b.alpha2));\n            for (const isect of segmentIntersections) {\n                if (augmentedList.length > 0 &&\n                    pointsAreEqual(augmentedList[augmentedList.length - 1].coordinates, isect.coord)) {\n                    if (!augmentedList[augmentedList.length - 1].isIntersection) {\n                        augmentedList[augmentedList.length - 1].isIntersection = true;\n                        augmentedList[augmentedList.length - 1].intersectionInfo = isect;\n                        augmentedList[augmentedList.length - 1].alpha =\n                            polyIndex === 0 ? isect.alpha1 : isect.alpha2;\n                    }\n                    continue;\n                }\n                augmentedList.push({\n                    id: `${polyIndex}_i${nodeIdCounter++}`,\n                    coordinates: isect.coord,\n                    type: PolylineNodeType.Intersection,\n                    originalPolyIndex: polyIndex,\n                    next: null,\n                    prev: null,\n                    isIntersection: true,\n                    visited: false,\n                    alpha: polyIndex === 0 ? isect.alpha1 : isect.alpha2,\n                    intersectionInfo: isect,\n                });\n            }\n        }\n        const finalList = [];\n        if (augmentedList.length > 0) {\n            finalList.push(augmentedList[0]);\n            for (let i = 1; i < augmentedList.length; i++) {\n                if (!pointsAreEqual(augmentedList[i].coordinates, finalList[finalList.length - 1].coordinates)) {\n                    finalList.push(augmentedList[i]);\n                }\n                else {\n                    if (augmentedList[i].isIntersection) {\n                        finalList[finalList.length - 1].isIntersection = true;\n                        finalList[finalList.length - 1].intersectionInfo =\n                            augmentedList[i].intersectionInfo;\n                        finalList[finalList.length - 1].alpha = augmentedList[i].alpha;\n                    }\n                }\n            }\n        }\n        if (finalList.length > 0) {\n            for (let i = 0; i < finalList.length; i++) {\n                finalList[i].next = finalList[(i + 1) % finalList.length];\n                finalList[i].prev =\n                    finalList[(i - 1 + finalList.length) % finalList.length];\n            }\n        }\n        return finalList;\n    };\n    const targetAugmented = buildAugmentedList(targetPolylineCoords, 0, intersections);\n    const sourceAugmented = buildAugmentedList(sourcePolylineCoords, 1, intersections);\n    targetAugmented.forEach((tnode) => {\n        if (tnode.isIntersection) {\n            const tData = tnode.intersectionInfo;\n            const partner = sourceAugmented.find((snode) => snode.isIntersection &&\n                pointsAreEqual(snode.coordinates, tnode.coordinates) &&\n                snode.intersectionInfo.seg1Idx ===\n                    tData.seg1Idx &&\n                snode.intersectionInfo.seg2Idx === tData.seg2Idx);\n            if (partner) {\n                tnode.partnerNode = partner;\n                partner.partnerNode = tnode;\n                const p_prev = tnode.prev.coordinates;\n                const p_curr = tnode.coordinates;\n                const p_next_source = partner.next.coordinates;\n                const v_target_arrival = vec2.subtract(vec2.create(), p_curr, p_prev);\n                const v_source_departure = vec2.subtract(vec2.create(), p_next_source, p_curr);\n                const midPrevTargetSeg = [\n                    (tnode.prev.coordinates[0] + tnode.coordinates[0]) / 2,\n                    (tnode.prev.coordinates[1] + tnode.coordinates[1]) / 2,\n                ];\n                const prevSegMidpointInsideSource = containsPoint(sourcePolylineCoordsInput, midPrevTargetSeg);\n                if (prevSegMidpointInsideSource) {\n                    tnode.intersectionDir = IntersectionDirection.Exiting;\n                }\n                else {\n                    tnode.intersectionDir = IntersectionDirection.Entering;\n                }\n            }\n            else {\n                tnode.isIntersection = false;\n            }\n        }\n    });\n    targetAugmented.forEach((n) => delete n.intersectionInfo);\n    sourceAugmented.forEach((n) => delete n.intersectionInfo);\n    const resultPolylines = [];\n    for (let i = 0; i < targetAugmented.length; i++) {\n        const startNode = targetAugmented[i];\n        if (startNode.visited || startNode.isIntersection) {\n            continue;\n        }\n        if (containsPoint(sourcePolylineCoordsInput, startNode.coordinates)) {\n            continue;\n        }\n        const currentPathCoords = [];\n        let currentNode = startNode;\n        let onTargetList = true;\n        let safetyBreak = 0;\n        const maxIter = (targetAugmented.length + sourceAugmented.length) * 2;\n        do {\n            if (safetyBreak++ > maxIter) {\n                console.warn('Subtraction: Max iterations reached, possible infinite loop.');\n                break;\n            }\n            currentNode.visited = true;\n            if (currentPathCoords.length === 0 ||\n                !pointsAreEqual(currentPathCoords[currentPathCoords.length - 1], currentNode.coordinates)) {\n                currentPathCoords.push(currentNode.coordinates);\n            }\n            if (currentNode.isIntersection) {\n                if (onTargetList) {\n                    if (currentNode.intersectionDir === IntersectionDirection.Entering &&\n                        currentNode.partnerNode) {\n                        currentNode = currentNode.partnerNode;\n                        onTargetList = false;\n                    }\n                }\n                else {\n                    if (currentNode.partnerNode) {\n                        currentNode = currentNode.partnerNode;\n                        onTargetList = true;\n                    }\n                    else {\n                        console.warn('Subtraction: Intersection on source without partner.');\n                    }\n                }\n            }\n            currentNode = currentNode.next;\n        } while (currentNode !== startNode || !onTargetList);\n        if (currentPathCoords.length >= 3) {\n            if (pointsAreEqual(currentPathCoords[0], currentPathCoords[currentPathCoords.length - 1])) {\n                currentPathCoords.pop();\n            }\n            if (currentPathCoords.length >= 3) {\n                resultPolylines.push(currentPathCoords);\n            }\n        }\n    }\n    return resultPolylines;\n}\n","const EPSILON = 1e-6;\nconst INSIDE = 1;\nconst OUTSIDE = 0;\nfunction clipT(num, denom, c) {\n    const [tE, tL] = c;\n    if (Math.abs(denom) < EPSILON) {\n        return num < 0;\n    }\n    const t = num / denom;\n    if (denom > 0) {\n        if (t > tL) {\n            return 0;\n        }\n        if (t > tE) {\n            c[0] = t;\n        }\n    }\n    else {\n        if (t < tE) {\n            return 0;\n        }\n        if (t < tL) {\n            c[1] = t;\n        }\n    }\n    return 1;\n}\nexport default function clip(a, b, box, da, db) {\n    const [x1, y1] = a;\n    const [x2, y2] = b;\n    const dx = x2 - x1;\n    const dy = y2 - y1;\n    if (da === undefined || db === undefined) {\n        da = a;\n        db = b;\n    }\n    else {\n        da[0] = a[0];\n        da[1] = a[1];\n        db[0] = b[0];\n        db[1] = b[1];\n    }\n    if (Math.abs(dx) < EPSILON &&\n        Math.abs(dy) < EPSILON &&\n        x1 >= box[0] &&\n        x1 <= box[2] &&\n        y1 >= box[1] &&\n        y1 <= box[3]) {\n        return INSIDE;\n    }\n    const c = [0, 1];\n    if (clipT(box[0] - x1, dx, c) &&\n        clipT(x1 - box[2], -dx, c) &&\n        clipT(box[1] - y1, dy, c) &&\n        clipT(y1 - box[3], -dy, c)) {\n        const [tE, tL] = c;\n        if (tL < 1) {\n            db[0] = x1 + tL * dx;\n            db[1] = y1 + tL * dy;\n        }\n        if (tE > 0) {\n            da[0] += tE * dx;\n            da[1] += tE * dy;\n        }\n        return INSIDE;\n    }\n    return OUTSIDE;\n}\n","import { mat4, vec3 } from 'gl-matrix';\nimport interpolateSegmentPoints from './interpolation/interpolateSegmentPoints';\nfunction shouldPreventInterpolation(annotation, options) {\n    const knotsRatioPercentage = options?.knotsRatioPercentage || 30;\n    if (!annotation?.data?.contour?.polyline?.length ||\n        knotsRatioPercentage <= 0) {\n        return true;\n    }\n    return false;\n}\nfunction rotateMatrix(normal, focal) {\n    const mat = mat4.create();\n    const eye = vec3.add(vec3.create(), focal, normal);\n    const up = Math.abs(normal[0]) > 0.1\n        ? vec3.fromValues(-normal[1], normal[0], 0)\n        : vec3.fromValues(0, -normal[2], normal[1]);\n    mat4.lookAt(mat, focal, eye, up);\n    return mat;\n}\nfunction rotate(list, count = Math.floor(Math.random() * (list.length - 1))) {\n    if (count === 0) {\n        return 0;\n    }\n    const srcList = [...list];\n    const { length } = list;\n    for (let i = 0; i < length; i++) {\n        list[i] = srcList[(i + count + length) % length];\n    }\n    return count;\n}\nexport default function smoothAnnotation(annotation, options) {\n    if (shouldPreventInterpolation(annotation, options)) {\n        return false;\n    }\n    const { viewPlaneNormal } = annotation.metadata;\n    const { closed, polyline } = annotation.data.contour;\n    const rotateMat = rotateMatrix(viewPlaneNormal, annotation.data.contour.polyline[0]);\n    const canvasPoints = annotation.data.contour.polyline.map((p) => {\n        const planeP = vec3.transformMat4(vec3.create(), p, rotateMat);\n        return [planeP[0], planeP[1]];\n    });\n    let rotation = closed ? rotate(canvasPoints) : 0;\n    let interpolatedCanvasPoints = (interpolateSegmentPoints(canvasPoints, 0, canvasPoints.length - 1, options?.knotsRatioPercentage || 30));\n    if (interpolatedCanvasPoints === canvasPoints) {\n        return false;\n    }\n    rotate(interpolatedCanvasPoints, -rotation);\n    for (let i = 1; i < options?.loop; i++) {\n        rotation = closed ? rotate(interpolatedCanvasPoints) : 0;\n        interpolatedCanvasPoints = (interpolateSegmentPoints(interpolatedCanvasPoints, 0, interpolatedCanvasPoints.length - 1, options?.knotsRatioPercentage || 30));\n        rotate(interpolatedCanvasPoints, -rotation);\n    }\n    const unRotate = mat4.invert(mat4.create(), rotateMat);\n    annotation.data.contour.polyline = (interpolatedCanvasPoints.map((p) => vec3.transformMat4([0, 0, 0], [...p, 0], unRotate)));\n    return true;\n}\n","import filterAnnotationsWithinSlice from './filterAnnotationsWithinSlice';\nimport getWorldWidthAndHeightFromCorners from './getWorldWidthAndHeightFromCorners';\nimport filterAnnotationsForDisplay from './filterAnnotationsForDisplay';\nimport getWorldWidthAndHeightFromTwoPoints from './getWorldWidthAndHeightFromTwoPoints';\nimport { getPointInLineOfSightWithCriteria, getPointsInLineOfSight, } from './getPointInLineOfSightWithCriteria';\nimport { isPlaneIntersectingAABB } from './isPlaneIntersectingAABB';\nimport { filterAnnotationsWithinSamePlane } from './filterAnnotationsWithinPlane';\nexport default {\n    filterAnnotationsWithinSlice,\n    getWorldWidthAndHeightFromCorners,\n    getWorldWidthAndHeightFromTwoPoints,\n    filterAnnotationsForDisplay,\n    getPointInLineOfSightWithCriteria,\n    isPlaneIntersectingAABB,\n    filterAnnotationsWithinSamePlane,\n    getPointsInLineOfSight,\n};\nexport { filterAnnotationsWithinSlice, getWorldWidthAndHeightFromCorners, getWorldWidthAndHeightFromTwoPoints, filterAnnotationsForDisplay, getPointInLineOfSightWithCriteria, isPlaneIntersectingAABB, filterAnnotationsWithinSamePlane, getPointsInLineOfSight, };\n","export const POSITIVE_SEED_LABEL = 254;\nexport const NEGATIVE_SEED_LABEL = 255;\nexport const DEFAULT_NEIGHBORHOOD_RADIUS = 1;\nexport const DEFAULT_POSITIVE_STD_DEV_MULTIPLIER = 1.8;\nexport const DEFAULT_NEGATIVE_STD_DEV_MULTIPLIER = 3.2;\nexport const DEFAULT_NEGATIVE_SEED_MARGIN = 30;\nexport const DEFAULT_NEGATIVE_SEEDS_COUNT = 70;\nexport const MAX_NEGATIVE_SEED_ATTEMPTS_MULTIPLIER = 50;\n","import { getEnabledElement, StackViewport, Enums } from '@cornerstonejs/core';\nimport { getToolState } from './state';\nexport const requestType = Enums.RequestType.Prefetch;\nexport const priority = 0;\nexport function range(lowEnd, highEnd) {\n    lowEnd = Math.round(lowEnd) || 0;\n    highEnd = Math.round(highEnd) || 0;\n    const arr = [];\n    let c = highEnd - lowEnd + 1;\n    if (c <= 0) {\n        return arr;\n    }\n    while (c--) {\n        arr[c] = highEnd--;\n    }\n    return arr;\n}\nexport function nearestIndex(arr, x) {\n    let low = 0;\n    let high = arr.length - 1;\n    arr.forEach((v, idx) => {\n        if (v < x) {\n            low = Math.max(idx, low);\n        }\n        else if (v > x) {\n            high = Math.min(idx, high);\n        }\n    });\n    return { low, high };\n}\nexport function getStackData(element) {\n    const enabledElement = getEnabledElement(element);\n    if (!enabledElement) {\n        return null;\n    }\n    const { viewport } = enabledElement;\n    if (!(viewport instanceof StackViewport)) {\n        return null;\n    }\n    return {\n        currentImageIdIndex: viewport.getCurrentImageIdIndex(),\n        imageIds: viewport.getImageIds(),\n    };\n}\nexport function getPromiseRemovedHandler(element) {\n    return function (e) {\n        const eventData = e.detail;\n        let stackData;\n        try {\n            stackData = getStackData(element);\n        }\n        catch (error) {\n            return;\n        }\n        if (!stackData || !stackData.imageIds || stackData.imageIds.length === 0) {\n            return;\n        }\n        const stack = stackData;\n        const imageIdIndex = stack.imageIds.indexOf(eventData.imageId);\n        if (imageIdIndex < 0) {\n            return;\n        }\n        const stackPrefetchData = getToolState(element);\n        if (!stackPrefetchData ||\n            !stackPrefetchData.indicesToRequest ||\n            !stackPrefetchData.indicesToRequest.length) {\n            return;\n        }\n        stackPrefetchData.indicesToRequest.push(imageIdIndex);\n    };\n}\nexport const clearFromImageIds = (stack) => {\n    const imageIdSet = new Set(stack.imageIds);\n    return (requestDetails) => requestDetails.type !== requestType ||\n        !imageIdSet.has(requestDetails.additionalDetails.imageId);\n};\n","import { getEnabledElement } from '@cornerstonejs/core';\nconst state = {};\nfunction addToolState(element, data) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId } = enabledElement;\n    state[viewportId] = data;\n}\nfunction getToolState(element) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId } = enabledElement;\n    return state[viewportId];\n}\nexport { addToolState, getToolState };\n","const interpolateVec3 = (a, b, t) => {\n    return [\n        a[0] * (1 - t) + b[0] * t,\n        a[1] * (1 - t) + b[1] * t,\n        a[2] * (1 - t) + b[2] * t,\n    ];\n};\nexport { interpolateVec3 as default, interpolateVec3 };\n","import { utilities } from '@cornerstonejs/core';\nimport interpolateVec3 from '../../math/vec3/interpolateVec3';\nimport { isRangeValid, areColorbarRangesEqual, isColorbarSizeValid, areColorbarSizesEqual, } from './common';\nconst { clamp } = utilities;\nclass ColorbarCanvas {\n    constructor(props) {\n        ColorbarCanvas.validateProps(props);\n        const { colormap, size = { width: 20, height: 100 }, imageRange = { lower: 0, upper: 1 }, voiRange = { lower: 0, upper: 1 }, container, showFullPixelValueRange = false, } = props;\n        this._colormap = colormap;\n        this._imageRange = imageRange;\n        this._voiRange = voiRange;\n        this._showFullImageRange = showFullPixelValueRange;\n        this._canvas = this._createRootElement(size);\n        if (container) {\n            this.appendTo(container);\n        }\n    }\n    get colormap() {\n        return this._colormap;\n    }\n    set colormap(colormap) {\n        this._colormap = colormap;\n        this.render();\n    }\n    get size() {\n        const { width, height } = this._canvas;\n        return { width, height };\n    }\n    set size(size) {\n        const { _canvas: canvas } = this;\n        if (!isColorbarSizeValid(size) || areColorbarSizesEqual(canvas, size)) {\n            return;\n        }\n        this._setCanvasSize(canvas, size);\n        this.render();\n    }\n    get imageRange() {\n        return { ...this._imageRange };\n    }\n    set imageRange(imageRange) {\n        if (!isRangeValid(imageRange) ||\n            areColorbarRangesEqual(imageRange, this._imageRange)) {\n            return;\n        }\n        this._imageRange = imageRange;\n        this.render();\n    }\n    get voiRange() {\n        return { ...this._voiRange };\n    }\n    set voiRange(voiRange) {\n        if (!isRangeValid(voiRange) ||\n            areColorbarRangesEqual(voiRange, this._voiRange)) {\n            return;\n        }\n        this._voiRange = voiRange;\n        this.render();\n    }\n    get showFullImageRange() {\n        return this._showFullImageRange;\n    }\n    set showFullImageRange(showFullImageRange) {\n        if (showFullImageRange === this._showFullImageRange) {\n            return;\n        }\n        this._showFullImageRange = showFullImageRange;\n        this.render();\n    }\n    appendTo(container) {\n        container.appendChild(this._canvas);\n        this.render();\n    }\n    dispose() {\n        const { _canvas: canvas } = this;\n        const { parentElement } = canvas;\n        parentElement?.removeChild(canvas);\n    }\n    static validateProps(props) {\n        const { size, imageRange, voiRange } = props;\n        if (size && !isColorbarSizeValid(size)) {\n            throw new Error('Invalid \"size\"');\n        }\n        if (imageRange && !isRangeValid(imageRange)) {\n            throw new Error('Invalid \"imageRange\"');\n        }\n        if (voiRange && !isRangeValid(voiRange)) {\n            throw new Error('Invalid \"voiRange\"');\n        }\n    }\n    _setCanvasSize(canvas, size) {\n        const { width, height } = size;\n        canvas.width = width;\n        canvas.height = height;\n        Object.assign(canvas.style, {\n            width: `${width}px`,\n            height: `${height}px`,\n        });\n    }\n    _createRootElement(size) {\n        const canvas = document.createElement('canvas');\n        Object.assign(canvas.style, {\n            position: 'absolute',\n            top: '0',\n            left: '0',\n            pointerEvents: 'none',\n            boxSizing: 'border-box',\n        });\n        this._setCanvasSize(canvas, size);\n        return canvas;\n    }\n    render() {\n        if (!this._canvas.isConnected) {\n            return;\n        }\n        const { _colormap: colormap } = this;\n        const { RGBPoints: rgbPoints } = colormap;\n        const colorsCount = rgbPoints.length / 4;\n        const getColorPoint = (index) => {\n            const offset = 4 * index;\n            if (index < 0 || index >= colorsCount) {\n                return;\n            }\n            return {\n                index,\n                position: rgbPoints[offset],\n                color: [\n                    rgbPoints[offset + 1],\n                    rgbPoints[offset + 2],\n                    rgbPoints[offset + 3],\n                ],\n            };\n        };\n        const { width, height } = this._canvas;\n        const canvasContext = this._canvas.getContext('2d');\n        if (!canvasContext) {\n            return;\n        }\n        const isHorizontal = width > height;\n        const maxValue = isHorizontal ? width : height;\n        const { _voiRange: voiRange } = this;\n        const range = this._showFullImageRange ? this._imageRange : { ...voiRange };\n        let previousColorPoint = undefined;\n        let currentColorPoint = getColorPoint(0);\n        const incRawPixelValue = (range.upper - range.lower) / (maxValue - 1);\n        let rawPixelValue = range.lower;\n        for (let i = 0; i < maxValue; i++) {\n            const tVoiRange = (rawPixelValue - voiRange.lower) /\n                Math.abs(voiRange.upper - voiRange.lower);\n            if (currentColorPoint) {\n                for (let i = currentColorPoint.index; i < colorsCount; i++) {\n                    if (tVoiRange <= currentColorPoint.position) {\n                        break;\n                    }\n                    previousColorPoint = currentColorPoint;\n                    currentColorPoint = getColorPoint(i + 1);\n                }\n            }\n            let normColor;\n            if (!previousColorPoint) {\n                normColor = [...currentColorPoint.color];\n            }\n            else if (!currentColorPoint) {\n                normColor = [...previousColorPoint.color];\n            }\n            else {\n                const tColorRange = (tVoiRange - previousColorPoint.position) /\n                    (currentColorPoint.position - previousColorPoint.position);\n                normColor = interpolateVec3(previousColorPoint.color, currentColorPoint.color, tColorRange);\n            }\n            const color = normColor.map((color) => clamp(Math.round(color * 255), 0, 255));\n            canvasContext.fillStyle = `rgb(${color[0]}, ${color[1]}, ${color[2]})`;\n            if (isHorizontal) {\n                canvasContext.fillRect(i, 0, 1, height);\n            }\n            else {\n                canvasContext.fillRect(0, height - i - 1, width, 1);\n            }\n            rawPixelValue += incRawPixelValue;\n        }\n    }\n}\nexport { ColorbarCanvas as default, ColorbarCanvas };\n","import { isColorbarSizeValid, isRangeValid, areColorbarRangesEqual, areColorbarSizesEqual, } from './common';\nimport { ColorbarRangeTextPosition } from './enums/ColorbarRangeTextPosition';\nconst DEFAULTS = {\n    FONT: '10px Arial',\n    COLOR: 'white',\n    TICK_SIZE: 5,\n    TICK_WIDTH: 1,\n    TICK_LABEL_MARGIN: 3,\n    MAX_NUM_TICKS: 8,\n    TICKS_STEPS: [1, 2.5, 5, 10],\n};\nclass ColorbarTicks {\n    constructor(props) {\n        ColorbarTicks.validateProps(props);\n        const { top = 0, left = 0, size = { width: 20, height: 100 }, imageRange = { lower: 0, upper: 1 }, voiRange = { lower: 0, upper: 1 }, ticks: ticksProps, container, showFullPixelValueRange = false, } = props;\n        const { style: ticksStyle, position: rangeTextPosition } = ticksProps ?? {};\n        this._imageRange = imageRange;\n        this._voiRange = voiRange;\n        this._font = ticksStyle?.font ?? DEFAULTS.FONT;\n        this._color = ticksStyle?.color ?? DEFAULTS.COLOR;\n        this._tickSize = ticksStyle?.tickSize ?? DEFAULTS.TICK_SIZE;\n        this._tickWidth = ticksStyle?.tickWidth ?? DEFAULTS.TICK_WIDTH;\n        this._labelMargin = ticksStyle?.labelMargin ?? DEFAULTS.TICK_LABEL_MARGIN;\n        this._maxNumTicks = ticksStyle?.maxNumTicks ?? DEFAULTS.MAX_NUM_TICKS;\n        this._rangeTextPosition =\n            rangeTextPosition ?? ColorbarRangeTextPosition.Right;\n        this._showFullPixelValueRange = showFullPixelValueRange;\n        this._canvas = this._createCanvasElement(size, top, left);\n        if (container) {\n            this.appendTo(container);\n        }\n    }\n    get size() {\n        const { width, height } = this._canvas;\n        return { width, height };\n    }\n    set size(size) {\n        const { _canvas: canvas } = this;\n        if (!isColorbarSizeValid(size) || areColorbarSizesEqual(canvas, size)) {\n            return;\n        }\n        this._setCanvasSize(canvas, size);\n        this.render();\n    }\n    get top() {\n        return Number.parseInt(this._canvas.style.top);\n    }\n    set top(top) {\n        const { _canvas: canvas } = this;\n        const currentTop = this.top;\n        if (top === currentTop) {\n            return;\n        }\n        canvas.style.top = `${top}px`;\n        this.render();\n    }\n    get left() {\n        return Number.parseInt(this._canvas.style.left);\n    }\n    set left(left) {\n        const { _canvas: canvas } = this;\n        const currentLeft = this.left;\n        if (left === currentLeft) {\n            return;\n        }\n        canvas.style.left = `${left}px`;\n        this.render();\n    }\n    get imageRange() {\n        return { ...this._imageRange };\n    }\n    set imageRange(imageRange) {\n        if (!isRangeValid(imageRange) ||\n            areColorbarRangesEqual(imageRange, this._imageRange)) {\n            return;\n        }\n        this._imageRange = imageRange;\n        this.render();\n    }\n    get voiRange() {\n        return { ...this._voiRange };\n    }\n    set voiRange(voiRange) {\n        if (!isRangeValid(voiRange) ||\n            areColorbarRangesEqual(voiRange, this._voiRange)) {\n            return;\n        }\n        this._voiRange = voiRange;\n        this.render();\n    }\n    get tickSize() {\n        return this._tickSize;\n    }\n    set tickSize(tickSize) {\n        if (tickSize === this._tickSize) {\n            return;\n        }\n        this._tickSize = tickSize;\n        this.render();\n    }\n    get tickWidth() {\n        return this._tickWidth;\n    }\n    set tickWidth(tickWidth) {\n        if (tickWidth === this._tickWidth) {\n            return;\n        }\n        this._tickWidth = tickWidth;\n        this.render();\n    }\n    get color() {\n        return this._color;\n    }\n    set color(color) {\n        if (color === this._color) {\n            return;\n        }\n        this._color = color;\n        this.render();\n    }\n    get showFullPixelValueRange() {\n        return this._showFullPixelValueRange;\n    }\n    set showFullPixelValueRange(showFullRange) {\n        if (showFullRange === this._showFullPixelValueRange) {\n            return;\n        }\n        this._showFullPixelValueRange = showFullRange;\n        this.render();\n    }\n    get visible() {\n        return this._canvas.style.display === 'block';\n    }\n    set visible(visible) {\n        if (visible === this.visible) {\n            return;\n        }\n        this._canvas.style.display = visible ? 'block' : 'none';\n        if (visible) {\n            this.render();\n        }\n    }\n    appendTo(container) {\n        container.appendChild(this._canvas);\n        this.render();\n    }\n    static validateProps(props) {\n        const { size, imageRange, voiRange } = props;\n        if (size && !isColorbarSizeValid(size)) {\n            throw new Error('Invalid \"size\"');\n        }\n        if (imageRange && !isRangeValid(imageRange)) {\n            throw new Error('Invalid \"imageRange\"');\n        }\n        if (voiRange && !isRangeValid(voiRange)) {\n            throw new Error('Invalid \"voiRange\"');\n        }\n    }\n    _setCanvasSize(canvas, size) {\n        const { width, height } = size;\n        canvas.width = width;\n        canvas.height = height;\n        Object.assign(canvas.style, {\n            width: `${width}px`,\n            height: `${height}px`,\n        });\n    }\n    _createCanvasElement(size, top, left) {\n        const canvas = document.createElement('canvas');\n        Object.assign(canvas.style, {\n            display: 'none',\n            position: 'absolute',\n            boxSizing: 'border-box',\n            top: `${top}px`,\n            left: `${left}px`,\n        });\n        this._setCanvasSize(canvas, size);\n        return canvas;\n    }\n    _getTicks(range) {\n        const { lower, upper } = range;\n        const rangeValue = upper - lower;\n        const roughStep = rangeValue / (this._maxNumTicks - 1);\n        const stepPower = Math.pow(10, -Math.floor(Math.log10(Math.abs(roughStep))));\n        const roughtStepNormalized = roughStep * stepPower;\n        const normalizedStep = DEFAULTS.TICKS_STEPS.find((n) => n >= roughtStepNormalized);\n        const step = normalizedStep / stepPower;\n        const scaleMax = Math.ceil(upper / step) * step;\n        const scaleMin = Math.floor(lower / step) * step;\n        const ticksCount = Math.round((scaleMax - scaleMin) / step) + 1;\n        const ticks = [];\n        for (let i = 0; i < ticksCount; i++) {\n            ticks.push(scaleMin + i * step);\n        }\n        return { scaleMin, scaleMax, step, ticks };\n    }\n    _getLeftTickInfo({ position, labelMeasure }) {\n        const { width } = this._canvas;\n        const labelX = width - this.tickSize - labelMeasure.width - this._labelMargin;\n        const labelPoint = [labelX, position];\n        const tickPoints = {\n            start: [width - this._tickSize, position],\n            end: [width, position],\n        };\n        return { labelPoint, tickPoints };\n    }\n    _getRightTickInfo({ position }) {\n        const labelPoint = [this._tickSize + this._labelMargin, position];\n        const tickPoints = {\n            start: [0, position],\n            end: [this._tickSize, position],\n        };\n        return { labelPoint, tickPoints };\n    }\n    _getTopTickInfo({ position, labelMeasure }) {\n        const { height } = this._canvas;\n        const labelY = height - this.tickSize - this._labelMargin;\n        const labelPoint = [position, labelY];\n        const tickPoints = {\n            start: [position, height - this._tickSize],\n            end: [position, height],\n        };\n        return { labelPoint, tickPoints };\n    }\n    _getBottomTickInfo({ position, labelMeasure }) {\n        const labelPoint = [position, this._tickSize + this._labelMargin];\n        const tickPoints = {\n            start: [position, 0],\n            end: [position, this._tickSize],\n        };\n        return { labelPoint, tickPoints };\n    }\n    render() {\n        const { _canvas: canvas } = this;\n        if (!canvas.isConnected || !this.visible) {\n            return;\n        }\n        const { width, height } = canvas;\n        const isHorizontal = width >= height;\n        const maxCanvasPixelValue = isHorizontal ? width : height;\n        const canvasContext = canvas.getContext('2d');\n        const { _voiRange: voiRange } = this;\n        const range = this._showFullPixelValueRange\n            ? this._imageRange\n            : { ...voiRange };\n        const rangeWidth = range.upper - range.lower;\n        const { ticks } = this._getTicks(range);\n        canvasContext.clearRect(0, 0, width, height);\n        canvasContext.font = this._font;\n        canvasContext.textBaseline = isHorizontal ? 'top' : 'middle';\n        canvasContext.textAlign = isHorizontal ? 'center' : 'left';\n        canvasContext.fillStyle = this._color;\n        canvasContext.strokeStyle = this._color;\n        canvasContext.lineWidth = this.tickWidth;\n        ticks.forEach((tick) => {\n            let position = Math.round(maxCanvasPixelValue * ((tick - range.lower) / rangeWidth));\n            if (!isHorizontal) {\n                position = height - position;\n            }\n            if (position < 0 || position > maxCanvasPixelValue) {\n                return;\n            }\n            const label = tick.toString();\n            const labelMeasure = canvasContext.measureText(label);\n            let tickInfo;\n            if (isHorizontal) {\n                if (this._rangeTextPosition === ColorbarRangeTextPosition.Top) {\n                    tickInfo = this._getTopTickInfo({ position, labelMeasure });\n                }\n                else {\n                    tickInfo = this._getBottomTickInfo({ position, labelMeasure });\n                }\n            }\n            else {\n                if (this._rangeTextPosition === ColorbarRangeTextPosition.Left) {\n                    tickInfo = this._getLeftTickInfo({ position, labelMeasure });\n                }\n                else {\n                    tickInfo = this._getRightTickInfo({ position });\n                }\n            }\n            const { labelPoint, tickPoints } = tickInfo;\n            const { start: tickStart, end: tickEnd } = tickPoints;\n            canvasContext.beginPath();\n            canvasContext.moveTo(tickStart[0], tickStart[1]);\n            canvasContext.lineTo(tickEnd[0], tickEnd[1]);\n            canvasContext.fillText(label, labelPoint[0], labelPoint[1]);\n            canvasContext.stroke();\n            return position;\n        });\n    }\n}\nexport { ColorbarTicks as default, ColorbarTicks };\n","const isRangeValid = (range) => {\n    return range && range.upper > range.lower;\n};\nexport { isRangeValid as default, isRangeValid };\n","const isColorbarSizeValid = (size) => {\n    return !!size && size.width > 0 && size.height > 0;\n};\nexport { isColorbarSizeValid as default, isColorbarSizeValid };\n","const areColorbarRangesEqual = (a, b) => {\n    return !!a && !!b && a.lower === b.lower && a.upper === b.upper;\n};\nexport { areColorbarRangesEqual as default, areColorbarRangesEqual };\n","const areColorbarSizesEqual = (a, b) => {\n    return !!a && !!b && a.width === b.width && a.height === b.height;\n};\nexport { areColorbarSizesEqual as default, areColorbarSizesEqual };\n","import { ColorbarRangeTextPosition } from '../enums';\nfunction isRangeTextPositionValid(colorbarWidth, colorbarHeight, rangeTextPosition) {\n    const isHorizontal = colorbarWidth >= colorbarHeight;\n    const validRangeTextPositions = isHorizontal\n        ? [ColorbarRangeTextPosition.Top, ColorbarRangeTextPosition.Bottom]\n        : [ColorbarRangeTextPosition.Left, ColorbarRangeTextPosition.Right];\n    return validRangeTextPositions.includes(rangeTextPosition);\n}\nexport { isRangeTextPositionValid as default, isRangeTextPositionValid };\n","class Widget {\n    constructor({ id, container }) {\n        this._containerResizeCallback = (entries) => {\n            let width;\n            let height;\n            const { contentRect, contentBoxSize } = entries[0];\n            if (contentRect) {\n                width = contentRect.width;\n                height = contentRect.height;\n            }\n            else if (contentBoxSize?.length) {\n                width = contentBoxSize[0].inlineSize;\n                height = contentBoxSize[0].blockSize;\n            }\n            this._containerSize = { width, height };\n            this.onContainerResize();\n        };\n        this._id = id;\n        this._containerSize = { width: 0, height: 0 };\n        this._rootElement = this.createRootElement(id);\n        this._containerResizeObserver = new ResizeObserver(this._containerResizeCallback);\n        if (container) {\n            this.appendTo(container);\n        }\n    }\n    get id() {\n        return this._id;\n    }\n    get rootElement() {\n        return this._rootElement;\n    }\n    appendTo(container) {\n        const { _rootElement: rootElement, _containerResizeObserver: resizeObserver, } = this;\n        const { parentElement: currentContainer } = rootElement;\n        if (!container || container === currentContainer) {\n            return;\n        }\n        if (currentContainer) {\n            resizeObserver.unobserve(currentContainer);\n        }\n        container.appendChild(rootElement);\n        resizeObserver.observe(container);\n    }\n    destroy() {\n        const { _rootElement: rootElement, _containerResizeObserver: resizeObserver, } = this;\n        const { parentElement } = rootElement;\n        parentElement?.removeChild(rootElement);\n        resizeObserver.disconnect();\n    }\n    get containerSize() {\n        return { ...this._containerSize };\n    }\n    createRootElement(id) {\n        const rootElement = document.createElement('div');\n        rootElement.id = id;\n        rootElement.classList.add('widget');\n        Object.assign(rootElement.style, {\n            width: '100%',\n            height: '100%',\n        });\n        return rootElement;\n    }\n    onContainerResize() {\n    }\n}\nexport { Widget as default, Widget };\n","import { m as macro } from '../../macros2.js';\nimport vtkPolyData from '../../Common/DataModel/PolyData.js';\nimport vtkDataArray from '../../Common/Core/DataArray.js';\n\n// ----------------------------------------------------------------------------\n// vtkSphereSource methods\n// ----------------------------------------------------------------------------\n\nfunction vtkSphereSource(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkSphereSource');\n  publicAPI.requestData = (inData, outData) => {\n    if (model.deleted) {\n      return;\n    }\n    let dataset = outData[0];\n    const pointDataType = dataset ? dataset.getPoints().getDataType() : model.pointType;\n    dataset = vtkPolyData.newInstance();\n\n    // ----------------------------------------------------------------------\n    let numPoles = 0;\n\n    // Check data, determine increments, and convert to radians\n    let {\n      thetaResolution\n    } = model;\n    let startTheta = model.startTheta < model.endTheta ? model.startTheta : model.endTheta;\n    startTheta *= Math.PI / 180.0;\n    let endTheta = model.endTheta > model.startTheta ? model.endTheta : model.startTheta;\n    endTheta *= Math.PI / 180.0;\n    let startPhi = model.startPhi < model.endPhi ? model.startPhi : model.endPhi;\n    startPhi *= Math.PI / 180.0;\n    let endPhi = model.endPhi > model.startPhi ? model.endPhi : model.startPhi;\n    endPhi *= Math.PI / 180.0;\n    if (Math.abs(startTheta - endTheta) < 2.0 * Math.PI) {\n      ++thetaResolution;\n    }\n    const deltaTheta = (endTheta - startTheta) / model.thetaResolution;\n    const jStart = model.startPhi <= 0.0 ? 1 : 0;\n    const jEnd = model.phiResolution + (model.endPhi >= 180.0 ? -1 : 0);\n    const numPts = model.phiResolution * thetaResolution + 2;\n    const numPolys = model.phiResolution * 2 * model.thetaResolution;\n\n    // Points\n    let pointIdx = 0;\n    let points = macro.newTypedArray(pointDataType, numPts * 3);\n\n    // Normals\n    let normals = new Float32Array(numPts * 3);\n\n    // Cells\n    let cellLocation = 0;\n    let polys = new Uint32Array(numPolys * 5);\n\n    // Create north pole if needed\n    if (model.startPhi <= 0.0) {\n      points[pointIdx * 3 + 0] = model.center[0];\n      points[pointIdx * 3 + 1] = model.center[1];\n      points[pointIdx * 3 + 2] = model.center[2] + model.radius;\n      normals[pointIdx * 3 + 0] = 0;\n      normals[pointIdx * 3 + 1] = 0;\n      normals[pointIdx * 3 + 2] = 1;\n      pointIdx++;\n      numPoles++;\n    }\n\n    // Create south pole if needed\n    if (model.endPhi >= 180.0) {\n      points[pointIdx * 3 + 0] = model.center[0];\n      points[pointIdx * 3 + 1] = model.center[1];\n      points[pointIdx * 3 + 2] = model.center[2] - model.radius;\n      normals[pointIdx * 3 + 0] = 0;\n      normals[pointIdx * 3 + 1] = 0;\n      normals[pointIdx * 3 + 2] = -1;\n      pointIdx++;\n      numPoles++;\n    }\n    const phiResolution = model.phiResolution - numPoles;\n    const deltaPhi = (endPhi - startPhi) / (model.phiResolution - 1);\n\n    // Create intermediate points\n    for (let i = 0; i < thetaResolution; i++) {\n      const theta = startTheta + i * deltaTheta;\n      for (let j = jStart; j < jEnd; j++) {\n        const phi = startPhi + j * deltaPhi;\n        const radius = model.radius * Math.sin(phi);\n        normals[pointIdx * 3 + 0] = radius * Math.cos(theta);\n        normals[pointIdx * 3 + 1] = radius * Math.sin(theta);\n        normals[pointIdx * 3 + 2] = model.radius * Math.cos(phi);\n        points[pointIdx * 3 + 0] = normals[pointIdx * 3 + 0] + model.center[0];\n        points[pointIdx * 3 + 1] = normals[pointIdx * 3 + 1] + model.center[1];\n        points[pointIdx * 3 + 2] = normals[pointIdx * 3 + 2] + model.center[2];\n        let norm = Math.sqrt(normals[pointIdx * 3 + 0] * normals[pointIdx * 3 + 0] + normals[pointIdx * 3 + 1] * normals[pointIdx * 3 + 1] + normals[pointIdx * 3 + 2] * normals[pointIdx * 3 + 2]);\n        norm = norm === 0 ? 1 : norm;\n        normals[pointIdx * 3 + 0] /= norm;\n        normals[pointIdx * 3 + 1] /= norm;\n        normals[pointIdx * 3 + 2] /= norm;\n        pointIdx++;\n      }\n    }\n\n    // Generate mesh connectivity\n    const base = phiResolution * thetaResolution;\n    if (Math.abs(startTheta - endTheta) < 2.0 * Math.PI) {\n      --thetaResolution;\n    }\n\n    // around north pole\n    if (model.startPhi <= 0.0) {\n      for (let i = 0; i < thetaResolution; i++) {\n        polys[cellLocation++] = 3;\n        polys[cellLocation++] = phiResolution * i + numPoles;\n        polys[cellLocation++] = phiResolution * (i + 1) % base + numPoles;\n        polys[cellLocation++] = 0;\n      }\n    }\n\n    // around south pole\n    if (model.endPhi >= 180.0) {\n      const numOffset = phiResolution - 1 + numPoles;\n      for (let i = 0; i < thetaResolution; i++) {\n        polys[cellLocation++] = 3;\n        polys[cellLocation++] = phiResolution * i + numOffset;\n        polys[cellLocation++] = numPoles - 1;\n        polys[cellLocation++] = phiResolution * (i + 1) % base + numOffset;\n      }\n    }\n\n    // bands in-between poles\n    for (let i = 0; i < thetaResolution; i++) {\n      for (let j = 0; j < phiResolution - 1; j++) {\n        const a = phiResolution * i + j + numPoles;\n        const b = a + 1;\n        const c = (phiResolution * (i + 1) + j) % base + numPoles + 1;\n        if (!model.latLongTessellation) {\n          polys[cellLocation++] = 3;\n          polys[cellLocation++] = a;\n          polys[cellLocation++] = b;\n          polys[cellLocation++] = c;\n          polys[cellLocation++] = 3;\n          polys[cellLocation++] = a;\n          polys[cellLocation++] = c;\n          polys[cellLocation++] = c - 1;\n        } else {\n          polys[cellLocation++] = 4;\n          polys[cellLocation++] = a;\n          polys[cellLocation++] = b;\n          polys[cellLocation++] = c;\n          polys[cellLocation++] = c - 1;\n        }\n      }\n    }\n\n    // Squeeze\n    points = points.subarray(0, pointIdx * 3);\n    dataset.getPoints().setData(points, 3);\n    normals = normals.subarray(0, pointIdx * 3);\n    const normalArray = vtkDataArray.newInstance({\n      name: 'Normals',\n      values: normals,\n      numberOfComponents: 3\n    });\n    dataset.getPointData().setNormals(normalArray);\n    polys = polys.subarray(0, cellLocation);\n    dataset.getPolys().setData(polys, 1);\n\n    // Update output\n    outData[0] = dataset;\n  };\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  radius: 0.5,\n  latLongTessellation: false,\n  thetaResolution: 8,\n  startTheta: 0.0,\n  endTheta: 360.0,\n  phiResolution: 8,\n  startPhi: 0.0,\n  endPhi: 180.0,\n  center: [0, 0, 0],\n  pointType: 'Float64Array'\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Build VTK API\n  macro.obj(publicAPI, model);\n  macro.setGet(publicAPI, model, ['radius', 'latLongTessellation', 'thetaResolution', 'startTheta', 'endTheta', 'phiResolution', 'startPhi', 'endPhi']);\n  macro.setGetArray(publicAPI, model, ['center'], 3);\n  macro.algo(publicAPI, model, 0, 1);\n  vtkSphereSource(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkSphereSource');\n\n// ----------------------------------------------------------------------------\n\nvar vtkSphereSource$1 = {\n  newInstance,\n  extend\n};\n\nexport { vtkSphereSource$1 as default, extend, newInstance };\n","const Corners = {\n  TOP_LEFT: 'TOP_LEFT',\n  TOP_RIGHT: 'TOP_RIGHT',\n  BOTTOM_LEFT: 'BOTTOM_LEFT',\n  BOTTOM_RIGHT: 'BOTTOM_RIGHT'\n};\nvar Constants = {\n  Corners\n};\n\nexport { Corners, Constants as default };\n","import { m as macro } from '../../macros2.js';\nimport vtkRenderer from '../../Rendering/Core/Renderer.js';\nimport Constants from './OrientationMarkerWidget/Constants.js';\n\nconst {\n  vtkErrorMacro\n} = macro;\nconst {\n  Corners\n} = Constants;\n\n// ----------------------------------------------------------------------------\n// vtkOrientationMarkerWidget\n// ----------------------------------------------------------------------------\n\nfunction vtkOrientationMarkerWidget(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkOrientationMarkerWidget');\n  const superClass = {\n    ...publicAPI\n  };\n\n  // Private variables\n\n  const previousCameraInput = [];\n  const selfRenderer = vtkRenderer.newInstance();\n  const resizeObserver = new ResizeObserver(entries => {\n    publicAPI.updateViewport();\n  });\n  let onCameraChangedSub = null;\n  let onCameraModifiedSub = null;\n  let onAnimationSub = null;\n  let onEndAnimationSub = null;\n  let selfSubscription = null;\n  function onCameraModified() {\n    // If animating, marker will be updated on Animation event\n    if (!model._interactor.isAnimating()) {\n      publicAPI.updateMarkerOrientation();\n    }\n  }\n  model._onParentRendererChanged = () => publicAPI.updateViewport();\n  publicAPI.computeViewport = () => {\n    const parentRen = model.parentRenderer || model._interactor.getCurrentRenderer();\n    const [xMin, yMin, xMax, yMax] = parentRen.getViewport();\n    const view = model._interactor.getView();\n    const canvasSize = view.getSize();\n    const [viewXSize, viewYSize] = view.getViewportSize(parentRen);\n    const minViewSize = Math.min(viewXSize, viewYSize);\n    let pixelSize = model.viewportSize * minViewSize;\n    // clamp pixel size\n    pixelSize = Math.max(Math.min(model.minPixelSize, minViewSize), Math.min(model.maxPixelSize, pixelSize));\n    const xFrac = pixelSize / canvasSize[0];\n    const yFrac = pixelSize / canvasSize[1];\n    // [left bottom right top]\n    switch (model.viewportCorner) {\n      case Corners.TOP_LEFT:\n        return [xMin, yMax - yFrac, xMin + xFrac, yMax];\n      case Corners.TOP_RIGHT:\n        return [xMax - xFrac, yMax - yFrac, xMax, yMax];\n      case Corners.BOTTOM_LEFT:\n        return [xMin, yMin, xMin + xFrac, yMin + yFrac];\n      case Corners.BOTTOM_RIGHT:\n        return [xMax - xFrac, yMin, xMax, yMin + yFrac];\n      default:\n        vtkErrorMacro('Invalid widget corner');\n        return null;\n    }\n  };\n  publicAPI.updateViewport = () => {\n    if (model.enabled) {\n      selfRenderer.setViewport(...publicAPI.computeViewport());\n      model._interactor.render();\n    }\n  };\n  publicAPI.updateMarkerOrientation = () => {\n    const ren = model.parentRenderer || model._interactor.getCurrentRenderer();\n    const currentCamera = ren.getActiveCamera();\n    if (!currentCamera) {\n      return;\n    }\n    const position = currentCamera.getReferenceByName('position');\n    const focalPoint = currentCamera.getReferenceByName('focalPoint');\n    const viewUp = currentCamera.getReferenceByName('viewUp');\n    if (previousCameraInput[0] !== position[0] || previousCameraInput[1] !== position[1] || previousCameraInput[2] !== position[2] || previousCameraInput[3] !== focalPoint[0] || previousCameraInput[4] !== focalPoint[1] || previousCameraInput[5] !== focalPoint[2] || previousCameraInput[6] !== viewUp[0] || previousCameraInput[7] !== viewUp[1] || previousCameraInput[8] !== viewUp[2]) {\n      previousCameraInput[0] = position[0];\n      previousCameraInput[1] = position[1];\n      previousCameraInput[2] = position[2];\n      previousCameraInput[3] = focalPoint[0];\n      previousCameraInput[4] = focalPoint[1];\n      previousCameraInput[5] = focalPoint[2];\n      previousCameraInput[6] = viewUp[0];\n      previousCameraInput[7] = viewUp[1];\n      previousCameraInput[8] = viewUp[2];\n      const activeCamera = selfRenderer.getActiveCamera();\n      activeCamera.setPosition(position[0], position[1], position[2]);\n      activeCamera.setFocalPoint(focalPoint[0], focalPoint[1], focalPoint[2]);\n      activeCamera.setViewUp(viewUp[0], viewUp[1], viewUp[2]);\n      selfRenderer.resetCamera();\n    }\n  };\n\n  /**\n   * Enables/Disables the orientation marker.\n   */\n  publicAPI.setEnabled = enabling => {\n    if (enabling) {\n      if (model.enabled) {\n        return;\n      }\n      if (!model.actor) {\n        vtkErrorMacro('Must set actor before enabling orientation marker.');\n        return;\n      }\n      if (!model._interactor) {\n        vtkErrorMacro('Must set interactor before enabling orientation marker.');\n        return;\n      }\n      const ren = model.parentRenderer || model._interactor.getCurrentRenderer();\n      const renderWindow = ren.getRenderWindow();\n      renderWindow.addRenderer(selfRenderer);\n      if (renderWindow.getNumberOfLayers() < 2) {\n        renderWindow.setNumberOfLayers(2);\n      }\n      // Highest number is foreground\n      selfRenderer.setLayer(renderWindow.getNumberOfLayers() - 1);\n      selfRenderer.setInteractive(model.interactiveRenderer);\n      selfRenderer.addViewProp(model.actor);\n      model.actor.setVisibility(true);\n      onCameraChangedSub = ren.onEvent(event => {\n        if (event.type === 'ActiveCameraEvent') {\n          if (onCameraModifiedSub) {\n            onCameraModifiedSub.unsubscribe();\n          }\n          onCameraModifiedSub = event.camera.onModified(onCameraModified);\n        }\n      });\n      onCameraModifiedSub = ren.getActiveCamera().onModified(onCameraModified);\n      onAnimationSub = model._interactor.onAnimation(publicAPI.updateMarkerOrientation);\n      onEndAnimationSub = model._interactor.onEndAnimation(publicAPI.updateMarkerOrientation);\n      resizeObserver.observe(model._interactor.getView().getCanvas());\n      publicAPI.updateViewport();\n      publicAPI.updateMarkerOrientation();\n      model.enabled = true;\n    } else {\n      if (!model.enabled) {\n        return;\n      }\n      model.enabled = false;\n      resizeObserver.disconnect();\n      onCameraChangedSub.unsubscribe();\n      onCameraChangedSub = null;\n      onCameraModifiedSub.unsubscribe();\n      onCameraModifiedSub = null;\n      onAnimationSub.unsubscribe();\n      onAnimationSub = null;\n      onEndAnimationSub.unsubscribe();\n      onEndAnimationSub = null;\n      model.actor.setVisibility(false);\n      selfRenderer.removeViewProp(model.actor);\n      const renderWindow = model._interactor?.findPokedRenderer()?.getRenderWindow();\n      if (renderWindow) {\n        renderWindow.removeRenderer(selfRenderer);\n      }\n    }\n    publicAPI.modified();\n  };\n\n  /**\n   * Sets the viewport corner.\n   */\n  publicAPI.setViewportCorner = corner => {\n    if (corner === model.viewportCorner) {\n      return;\n    }\n    model.viewportCorner = corner;\n    publicAPI.updateViewport();\n  };\n\n  /**\n   * Sets the viewport size.\n   */\n  publicAPI.setViewportSize = sizeFactor => {\n    const viewportSize = Math.min(1, Math.max(0, sizeFactor));\n    if (viewportSize === model.viewportSize) {\n      return;\n    }\n    model.viewportSize = viewportSize;\n    publicAPI.updateViewport();\n  };\n  publicAPI.setActor = actor => {\n    const previousState = model.enabled;\n    publicAPI.setEnabled(false);\n    model.actor = actor;\n    publicAPI.setEnabled(previousState);\n  };\n  publicAPI.getRenderer = () => selfRenderer;\n  publicAPI.delete = () => {\n    superClass.delete();\n    if (selfSubscription) {\n      selfSubscription.unsubscribe();\n      selfSubscription = null;\n    }\n    if (onCameraChangedSub) {\n      onCameraChangedSub.unsubscribe();\n      onCameraChangedSub = null;\n    }\n    if (onCameraModifiedSub) {\n      onCameraModifiedSub.unsubscribe();\n      onCameraModifiedSub = null;\n    }\n    if (onAnimationSub) {\n      onAnimationSub.unsubscribe();\n      onAnimationSub = null;\n    }\n    if (onEndAnimationSub) {\n      onEndAnimationSub.unsubscribe();\n      onEndAnimationSub = null;\n    }\n    resizeObserver.disconnect();\n  };\n\n  // --------------------------------------------------------------------------\n\n  // update viewport whenever we are updated\n  selfSubscription = publicAPI.onModified(publicAPI.updateViewport);\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  // actor: null,\n  // _interactor: null,\n  viewportCorner: Constants.Corners.BOTTOM_LEFT,\n  viewportSize: 0.2,\n  minPixelSize: 50,\n  maxPixelSize: 200,\n  parentRenderer: null,\n  interactiveRenderer: false\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Build VTK API\n  macro.obj(publicAPI, model);\n  macro.get(publicAPI, model, ['enabled', 'viewportCorner', 'viewportSize', 'interactiveRenderer']);\n\n  // NOTE: setting these while the widget is enabled will\n  // not update the widget.\n  macro.setGet(publicAPI, model, ['_interactor', 'minPixelSize', 'maxPixelSize', 'parentRenderer']);\n  macro.get(publicAPI, model, ['actor']);\n  macro.moveToProtected(publicAPI, model, ['interactor']);\n\n  // Object methods\n  vtkOrientationMarkerWidget(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkOrientationMarkerWidget');\n\n// ----------------------------------------------------------------------------\n\nvar vtkOrientationMarkerWidget$1 = {\n  newInstance,\n  extend,\n  ...Constants\n};\n\nexport { DEFAULT_VALUES, vtkOrientationMarkerWidget$1 as default, extend, newInstance };\n","import vtkImageData from '../DataModel/ImageData.js';\nimport vtkDataArray from './DataArray.js';\n\n/**\n * Takes a canvas and converts it to a vtkImageData.\n *\n * Optionally supply a bounding box to get a particular subset of the canvas.\n *\n * @param canvas       The HTML canvas to convert\n * @param boundingBox  A bounding box of type [top, left, width, height]\n */\nfunction canvasToImageData(canvas) {\n  let boundingBox = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [0, 0, 0, 0];\n  const [top, left, width, height] = boundingBox;\n  const ctxt = canvas.getContext('2d');\n  const idata = ctxt.getImageData(top, left, width || canvas.width, height || canvas.height);\n  const imageData = vtkImageData.newInstance({\n    type: 'vtkImageData'\n  });\n  imageData.setOrigin(0, 0, 0);\n  imageData.setSpacing(1, 1, 1);\n  imageData.setExtent(0, (width || canvas.width) - 1, 0, (height || canvas.height) - 1, 0, 0);\n  const scalars = vtkDataArray.newInstance({\n    numberOfComponents: 4,\n    values: new Uint8Array(idata.data.buffer)\n  });\n  scalars.setName('scalars');\n  imageData.getPointData().setScalars(scalars);\n  return imageData;\n}\n\n/**\n * Converts an Image object to a vtkImageData.\n */\nfunction imageToImageData(image) {\n  let transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    flipX: false,\n    flipY: false,\n    rotate: 0\n  };\n  const canvas = document.createElement('canvas');\n  canvas.width = image.width;\n  canvas.height = image.height;\n  const ctx = canvas.getContext('2d');\n  const {\n    flipX,\n    flipY,\n    rotate\n  } = transform;\n  ctx.translate(canvas.width / 2, canvas.height / 2);\n  ctx.scale(flipX ? -1 : 1, flipY ? -1 : 1);\n  ctx.rotate(rotate * Math.PI / 180);\n  ctx.drawImage(image, -image.width / 2, -image.height / 2);\n  return canvasToImageData(canvas);\n}\nvar ImageHelper = {\n  canvasToImageData,\n  imageToImageData\n};\n\nexport { ImageHelper as default };\n","const STYLES = {\n  default: {\n    defaultStyle: {\n      fontStyle: 'bold',\n      fontFamily: 'Arial',\n      fontColor: 'black',\n      fontSizeScale: res => res / 2,\n      faceColor: 'white',\n      edgeThickness: 0.1,\n      edgeColor: 'black',\n      resolution: 400\n    },\n    xMinusFaceProperty: {\n      text: 'X-',\n      faceColor: 'yellow'\n    },\n    xPlusFaceProperty: {\n      text: 'X+',\n      faceColor: 'yellow'\n    },\n    yMinusFaceProperty: {\n      text: 'Y-',\n      faceColor: 'red'\n    },\n    yPlusFaceProperty: {\n      text: 'Y+',\n      faceColor: 'red'\n    },\n    zMinusFaceProperty: {\n      text: 'Z-',\n      faceColor: '#008000'\n    },\n    zPlusFaceProperty: {\n      text: 'Z+',\n      faceColor: '#008000'\n    }\n  },\n  lps: {\n    xMinusFaceProperty: {\n      text: 'R',\n      faceRotation: -90\n    },\n    xPlusFaceProperty: {\n      text: 'L',\n      faceRotation: 90\n    },\n    yMinusFaceProperty: {\n      text: 'A',\n      faceRotation: 0\n    },\n    yPlusFaceProperty: {\n      text: 'P',\n      faceRotation: 180\n    },\n    zMinusFaceProperty: {\n      text: 'I',\n      faceRotation: 180\n    },\n    zPlusFaceProperty: {\n      text: 'S',\n      faceRotation: 0\n    }\n  }\n};\nfunction applyDefinitions(definitions, cubeActor) {\n  cubeActor.set(definitions);\n}\nfunction applyPreset(name, cubeActor) {\n  return applyDefinitions(STYLES[name], cubeActor);\n}\nfunction registerStylePreset(name, definitions) {\n  STYLES[name] = definitions;\n}\nvar AnnotatedCubePresets = {\n  applyDefinitions,\n  applyPreset,\n  registerStylePreset\n};\n\nexport { AnnotatedCubePresets as default };\n","import { m as macro } from '../../macros2.js';\nimport vtkActor from './Actor.js';\nimport vtkMapper from './Mapper.js';\nimport vtkTexture from './Texture.js';\nimport vtkCubeSource from '../../Filters/Sources/CubeSource.js';\nimport ImageHelper from '../../Common/Core/ImageHelper.js';\nimport AnnotatedCubePresets from './AnnotatedCubeActor/Presets.js';\n\nconst FACE_TO_INDEX = {\n  xPlus: 0,\n  xMinus: 1,\n  yPlus: 2,\n  yMinus: 3,\n  zPlus: 4,\n  zMinus: 5\n};\n\n// ----------------------------------------------------------------------------\n// vtkAnnotatedCubeActor\n// ----------------------------------------------------------------------------\n\nfunction vtkAnnotatedCubeActor(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkAnnotatedCubeActor');\n\n  // Make sure face properties are not references to the default value\n  model.xPlusFaceProperty = {\n    ...model.xPlusFaceProperty\n  };\n  model.xMinusFaceProperty = {\n    ...model.xMinusFaceProperty\n  };\n  model.yPlusFaceProperty = {\n    ...model.yPlusFaceProperty\n  };\n  model.yMinusFaceProperty = {\n    ...model.yMinusFaceProperty\n  };\n  model.zPlusFaceProperty = {\n    ...model.zPlusFaceProperty\n  };\n  model.zMinusFaceProperty = {\n    ...model.zMinusFaceProperty\n  };\n\n  // private variables\n\n  let cubeSource = null;\n  const canvas = document.createElement('canvas');\n  const mapper = vtkMapper.newInstance();\n  const texture = vtkTexture.newInstance();\n  texture.setInterpolate(true);\n\n  // private methods\n\n  function updateFaceTexture(faceName) {\n    let newProp = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    if (newProp) {\n      Object.assign(model[`${faceName}FaceProperty`], newProp);\n    }\n    const prop = {\n      ...model.defaultStyle,\n      ...model[`${faceName}FaceProperty`]\n    };\n\n    // set canvas resolution\n    canvas.width = prop.resolution;\n    canvas.height = prop.resolution;\n    const ctxt = canvas.getContext('2d');\n\n    // set background color\n    ctxt.fillStyle = prop.faceColor;\n    ctxt.fillRect(0, 0, canvas.width, canvas.height);\n\n    // draw edge\n    if (prop.edgeThickness > 0) {\n      ctxt.strokeStyle = prop.edgeColor;\n      ctxt.lineWidth = prop.edgeThickness * canvas.width;\n      ctxt.strokeRect(0, 0, canvas.width, canvas.height);\n    }\n\n    // set face rotation\n    ctxt.save();\n\n    // vertical flip\n    ctxt.translate(0, canvas.height);\n    ctxt.scale(1, -1);\n    ctxt.translate(canvas.width / 2, canvas.height / 2);\n    ctxt.rotate(-Math.PI * (prop.faceRotation / 180.0));\n\n    // set foreground text\n    const textSize = prop.fontSizeScale(prop.resolution);\n    ctxt.fillStyle = prop.fontColor;\n    ctxt.textAlign = 'center';\n    ctxt.textBaseline = 'middle';\n    ctxt.font = `${prop.fontStyle} ${textSize}px \"${prop.fontFamily}\"`;\n    ctxt.fillText(prop.text, 0, 0);\n    ctxt.restore();\n    const vtkImage = ImageHelper.canvasToImageData(canvas);\n    texture.setInputData(vtkImage, FACE_TO_INDEX[faceName]);\n    publicAPI.modified();\n  }\n  function updateAllFaceTextures() {\n    cubeSource = vtkCubeSource.newInstance({\n      generate3DTextureCoordinates: true\n    });\n    mapper.setInputConnection(cubeSource.getOutputPort());\n    updateFaceTexture('xPlus');\n    updateFaceTexture('xMinus');\n    updateFaceTexture('yPlus');\n    updateFaceTexture('yMinus');\n    updateFaceTexture('zPlus');\n    updateFaceTexture('zMinus');\n  }\n\n  // public methods\n\n  publicAPI.setDefaultStyle = style => {\n    model.defaultStyle = {\n      ...model.defaultStyle,\n      ...style\n    };\n    updateAllFaceTextures();\n  };\n  publicAPI.setXPlusFaceProperty = prop => updateFaceTexture('xPlus', prop);\n  publicAPI.setXMinusFaceProperty = prop => updateFaceTexture('xMinus', prop);\n  publicAPI.setYPlusFaceProperty = prop => updateFaceTexture('yPlus', prop);\n  publicAPI.setYMinusFaceProperty = prop => updateFaceTexture('yMinus', prop);\n  publicAPI.setZPlusFaceProperty = prop => updateFaceTexture('zPlus', prop);\n  publicAPI.setZMinusFaceProperty = prop => updateFaceTexture('zMinus', prop);\n\n  // constructor\n\n  updateAllFaceTextures();\n\n  // set mapper\n  mapper.setInputConnection(cubeSource.getOutputPort());\n  publicAPI.setMapper(mapper);\n\n  // set texture\n  publicAPI.addTexture(texture);\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  defaultStyle: {\n    text: '',\n    faceColor: 'white',\n    faceRotation: 0,\n    fontFamily: 'Arial',\n    fontColor: 'black',\n    fontStyle: 'normal',\n    fontSizeScale: resolution => resolution / 1.8,\n    edgeThickness: 0.1,\n    edgeColor: 'black',\n    resolution: 200\n  }\n  // xPlusFaceProperty: null,\n  // xMinusFaceProperty: null,\n  // yPlusFaceProperty: null,\n  // yMinusFaceProperty: null,\n  // zPlusFaceProperty: null,\n  // zMinusFaceProperty: null,\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Inheritance\n  vtkActor.extend(publicAPI, model, initialValues);\n  macro.get(publicAPI, model, ['defaultStyle', 'xPlusFaceProperty', 'xMinusFaceProperty', 'yPlusFaceProperty', 'yMinusFaceProperty', 'zPlusFaceProperty', 'zMinusFaceProperty']);\n\n  // Object methods\n  vtkAnnotatedCubeActor(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkAnnotatedCubeActor');\n\n// ----------------------------------------------------------------------------\n\nvar vtkAnnotatedCubeActor$1 = {\n  newInstance,\n  extend,\n  Presets: AnnotatedCubePresets\n};\n\nexport { DEFAULT_VALUES, vtkAnnotatedCubeActor$1 as default, extend, newInstance };\n","import { m as macro } from '../../macros2.js';\nimport vtkDataArray from '../../Common/Core/DataArray.js';\nimport vtkPoints from '../../Common/Core/Points.js';\nimport vtkPolyData from '../../Common/DataModel/PolyData.js';\nimport { DesiredOutputPrecision } from '../../Common/DataModel/DataSetAttributes/Constants.js';\nimport { VtkDataTypes } from '../../Common/Core/DataArray/Constants.js';\n\nconst {\n  vtkErrorMacro\n} = macro;\nfunction offsetCellArray(typedArray, offset) {\n  let currentIdx = 0;\n  return typedArray.map((value, index) => {\n    if (index === currentIdx) {\n      currentIdx += value + 1;\n      return value;\n    }\n    return value + offset;\n  });\n}\nfunction appendCellData(dest, src, ptOffset, cellOffset) {\n  dest.set(offsetCellArray(src, ptOffset), cellOffset);\n}\n\n// ----------------------------------------------------------------------------\n// vtkAppendPolyData methods\n// ----------------------------------------------------------------------------\n\nfunction vtkAppendPolyData(publicAPI, model) {\n  // Set our classname\n  model.classHierarchy.push('vtkAppendPolyData');\n  publicAPI.requestData = (inData, outData) => {\n    // implement requestData\n    const numberOfInputs = publicAPI.getNumberOfInputPorts();\n    if (!numberOfInputs) {\n      vtkErrorMacro('No input specified.');\n      return;\n    }\n    if (numberOfInputs === 1) {\n      // pass through filter\n      outData[0] = inData[0];\n      return;\n    }\n\n    // Allocate output\n    const output = vtkPolyData.newInstance();\n    let numPts = 0;\n    let pointType = 0;\n    let ttype = 1;\n    let firstType = 1;\n    let numVerts = 0;\n    let numLines = 0;\n    let numStrips = 0;\n    let numPolys = 0;\n\n    // Field data is propagated to output only if present in all inputs\n    let hasPtNormals = true; // assume present by default\n    let hasPtTCoords = true;\n    let hasPtScalars = true;\n    for (let i = 0; i < numberOfInputs; i++) {\n      const ds = inData[i];\n      if (!ds) {\n        // eslint-disable-next-line\n        continue;\n      }\n      const dsNumPts = ds.getPoints().getNumberOfPoints();\n      numPts += dsNumPts;\n      numVerts += ds.getVerts().getNumberOfValues();\n      numLines += ds.getLines().getNumberOfValues();\n      numStrips += ds.getStrips().getNumberOfValues();\n      numPolys += ds.getPolys().getNumberOfValues();\n      if (dsNumPts) {\n        if (firstType) {\n          firstType = 0;\n          pointType = ds.getPoints().getDataType();\n        }\n        ttype = ds.getPoints().getDataType();\n        pointType = pointType > ttype ? pointType : ttype;\n      }\n      const ptD = ds.getPointData();\n      if (ptD) {\n        hasPtNormals = hasPtNormals && ptD.getNormals() !== null;\n        hasPtTCoords = hasPtTCoords && ptD.getTCoords() !== null;\n        hasPtScalars = hasPtScalars && ptD.getScalars() !== null;\n      } else {\n        hasPtNormals = false;\n        hasPtTCoords = false;\n        hasPtScalars = false;\n      }\n    }\n    if (model.outputPointsPrecision === DesiredOutputPrecision.SINGLE) {\n      pointType = VtkDataTypes.FLOAT;\n    } else if (model.outputPointsPrecision === DesiredOutputPrecision.DOUBLE) {\n      pointType = VtkDataTypes.DOUBLE;\n    }\n    const points = vtkPoints.newInstance({\n      dataType: pointType\n    });\n    points.setNumberOfPoints(numPts);\n    const pointData = points.getData();\n    const vertData = new Uint32Array(numVerts);\n    const lineData = new Uint32Array(numLines);\n    const stripData = new Uint32Array(numStrips);\n    const polyData = new Uint32Array(numPolys);\n    let newPtNormals = null;\n    let newPtTCoords = null;\n    let newPtScalars = null;\n    const lds = inData[numberOfInputs - 1];\n    if (hasPtNormals) {\n      const dsNormals = lds.getPointData().getNormals();\n      newPtNormals = vtkDataArray.newInstance({\n        numberOfComponents: 3,\n        numberOfTuples: numPts,\n        size: 3 * numPts,\n        dataType: dsNormals.getDataType(),\n        name: dsNormals.getName()\n      });\n    }\n    if (hasPtTCoords) {\n      const dsTCoords = lds.getPointData().getTCoords();\n      newPtTCoords = vtkDataArray.newInstance({\n        numberOfComponents: 2,\n        numberOfTuples: numPts,\n        size: 2 * numPts,\n        dataType: dsTCoords.getDataType(),\n        name: dsTCoords.getName()\n      });\n    }\n    if (hasPtScalars) {\n      const dsScalars = lds.getPointData().getScalars();\n      newPtScalars = vtkDataArray.newInstance({\n        numberOfComponents: dsScalars.getNumberOfComponents(),\n        numberOfTuples: numPts,\n        size: numPts * dsScalars.getNumberOfComponents(),\n        dataType: dsScalars.getDataType(),\n        name: dsScalars.getName()\n      });\n    }\n    numPts = 0;\n    numVerts = 0;\n    numLines = 0;\n    numStrips = 0;\n    numPolys = 0;\n    for (let i = 0; i < numberOfInputs; i++) {\n      const ds = inData[i];\n      pointData.set(ds.getPoints().getData(), numPts * 3);\n      appendCellData(vertData, ds.getVerts().getData(), numPts, numVerts);\n      numVerts += ds.getVerts().getNumberOfValues();\n      appendCellData(lineData, ds.getLines().getData(), numPts, numLines);\n      numLines += ds.getLines().getNumberOfValues();\n      appendCellData(stripData, ds.getStrips().getData(), numPts, numStrips);\n      numStrips += ds.getStrips().getNumberOfValues();\n      appendCellData(polyData, ds.getPolys().getData(), numPts, numPolys);\n      numPolys += ds.getPolys().getNumberOfValues();\n      const dsPD = ds.getPointData();\n      if (hasPtNormals) {\n        const ptNorms = dsPD.getNormals();\n        newPtNormals.getData().set(ptNorms.getData(), numPts * 3);\n      }\n      if (hasPtTCoords) {\n        const ptTCoords = dsPD.getTCoords();\n        newPtTCoords.getData().set(ptTCoords.getData(), numPts * 2);\n      }\n      if (hasPtScalars) {\n        const ptScalars = dsPD.getScalars();\n        newPtScalars.getData().set(ptScalars.getData(), numPts * newPtScalars.getNumberOfComponents());\n      }\n      numPts += ds.getPoints().getNumberOfPoints();\n    }\n    output.setPoints(points);\n    output.getVerts().setData(vertData);\n    output.getLines().setData(lineData);\n    output.getStrips().setData(stripData);\n    output.getPolys().setData(polyData);\n    if (newPtNormals) {\n      output.getPointData().setNormals(newPtNormals);\n    }\n    if (newPtTCoords) {\n      output.getPointData().setTCoords(newPtTCoords);\n    }\n    if (newPtScalars) {\n      output.getPointData().setScalars(newPtScalars);\n    }\n    outData[0] = output;\n  };\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  outputPointsPrecision: DesiredOutputPrecision.DEFAULT\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Build VTK API\n  macro.setGet(publicAPI, model, ['outputPointsPrecision']);\n\n  // Make this a VTK object\n  macro.obj(publicAPI, model);\n\n  // Also make it an algorithm with one input and one output\n  macro.algo(publicAPI, model, 1, 1);\n\n  // Object specific methods\n  vtkAppendPolyData(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkAppendPolyData');\n\n// ----------------------------------------------------------------------------\n\nvar vtkAppendPolyData$1 = {\n  newInstance,\n  extend\n};\n\nexport { vtkAppendPolyData$1 as default, extend, newInstance };\n","import { m as macro } from '../../macros2.js';\nimport vtkPolyData from '../../Common/DataModel/PolyData.js';\nimport vtkMatrixBuilder from '../../Common/Core/MatrixBuilder.js';\n\n// ----------------------------------------------------------------------------\n// vtkConeSource methods\n// ----------------------------------------------------------------------------\n\nfunction vtkConeSource(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkConeSource');\n  function requestData(inData, outData) {\n    if (model.deleted) {\n      return;\n    }\n    let dataset = outData[0];\n    const angle = 2 * Math.PI / model.resolution;\n    const xbot = -model.height / 2.0;\n    const numberOfPoints = model.resolution + 1;\n    const cellArraySize = 4 * model.resolution + 1 + model.resolution;\n\n    // Points\n    let pointIdx = 0;\n    const points = macro.newTypedArray(model.pointType, numberOfPoints * 3);\n\n    // Cells\n    let cellLocation = 0;\n    const polys = new Uint32Array(cellArraySize);\n\n    // Add summit point\n    points[0] = model.height / 2.0;\n    points[1] = 0.0;\n    points[2] = 0.0;\n\n    // Create bottom cell\n    if (model.capping) {\n      polys[cellLocation++] = model.resolution;\n    }\n\n    // Add all points\n    for (let i = 0; i < model.resolution; i++) {\n      pointIdx++;\n      points[pointIdx * 3 + 0] = xbot;\n      points[pointIdx * 3 + 1] = model.radius * Math.cos(i * angle);\n      points[pointIdx * 3 + 2] = model.radius * Math.sin(i * angle);\n\n      // Add points to bottom cell in reverse order\n      if (model.capping) {\n        polys[model.resolution - cellLocation++ + 1] = pointIdx;\n      }\n    }\n\n    // Add all triangle cells\n    for (let i = 0; i < model.resolution; i++) {\n      polys[cellLocation++] = 3;\n      polys[cellLocation++] = 0;\n      polys[cellLocation++] = i + 1;\n      polys[cellLocation++] = i + 2 > model.resolution ? 1 : i + 2;\n    }\n\n    // Apply transformation to the points coordinates\n    vtkMatrixBuilder.buildFromRadian().translate(...model.center).rotateFromDirections([1, 0, 0], model.direction).apply(points);\n    dataset = vtkPolyData.newInstance();\n    dataset.getPoints().setData(points, 3);\n    dataset.getPolys().setData(polys, 1);\n\n    // Update output\n    outData[0] = dataset;\n  }\n\n  // Expose methods\n  publicAPI.requestData = requestData;\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  height: 1.0,\n  radius: 0.5,\n  resolution: 6,\n  center: [0, 0, 0],\n  direction: [1.0, 0.0, 0.0],\n  capping: true,\n  pointType: 'Float64Array'\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Build VTK API\n  macro.obj(publicAPI, model);\n  macro.setGet(publicAPI, model, ['height', 'radius', 'resolution', 'capping']);\n  macro.setGetArray(publicAPI, model, ['center', 'direction'], 3);\n  macro.algo(publicAPI, model, 0, 1);\n  vtkConeSource(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkConeSource');\n\n// ----------------------------------------------------------------------------\n\nvar vtkConeSource$1 = {\n  newInstance,\n  extend\n};\n\nexport { vtkConeSource$1 as default, extend, newInstance };\n","import { m as macro } from '../../macros2.js';\nimport vtkDataArray from '../../Common/Core/DataArray.js';\nimport vtkPolyData from '../../Common/DataModel/PolyData.js';\nimport vtkMatrixBuilder from '../../Common/Core/MatrixBuilder.js';\n\n// ----------------------------------------------------------------------------\n// vtkCylinderSource methods\n// ----------------------------------------------------------------------------\n\nfunction vtkCylinderSource(publicAPI, model) {\n  // Set our classname\n  model.classHierarchy.push('vtkCylinderSource');\n  function requestData(inData, outData) {\n    if (model.deleted) {\n      return;\n    }\n    let dataset = outData[0];\n    const angle = 2.0 * Math.PI / model.resolution;\n    let numberOfPoints = 2 * model.resolution;\n    let numberOfPolys = 5 * model.resolution;\n    if (model.capping) {\n      numberOfPoints = 4 * model.resolution;\n      numberOfPolys = 7 * model.resolution + 2;\n    }\n\n    // Points\n    const points = macro.newTypedArray(model.pointType, numberOfPoints * 3);\n\n    // Cells\n    let cellLocation = 0;\n    const polys = new Uint32Array(numberOfPolys);\n\n    // Normals\n    const normalsData = new Float32Array(numberOfPoints * 3);\n    const normals = vtkDataArray.newInstance({\n      numberOfComponents: 3,\n      values: normalsData,\n      name: 'Normals'\n    });\n\n    // Texture coords\n    const tcData = new Float32Array(numberOfPoints * 2);\n    const tcoords = vtkDataArray.newInstance({\n      numberOfComponents: 2,\n      values: tcData,\n      name: 'TCoords'\n    });\n\n    // Generate points for all sides\n    const nbot = [0.0, 0.0, 0.0];\n    const ntop = [0.0, 0.0, 0.0];\n    const xbot = [0.0, 0.0, 0.0];\n    const xtop = [0.0, 0.0, 0.0];\n    const tcbot = [0.0, 0.0];\n    const tctop = [0.0, 0.0];\n    const otherRadius = model.otherRadius == null ? model.radius : model.otherRadius;\n    for (let i = 0; i < model.resolution; i++) {\n      // x coordinate\n      nbot[0] = Math.cos(i * angle + model.initAngle);\n      ntop[0] = nbot[0];\n      xbot[0] = model.radius * nbot[0] + model.center[0];\n      xtop[0] = xbot[0];\n      tcbot[0] = Math.abs(2.0 * i / model.resolution - 1.0);\n      tctop[0] = tcbot[0];\n\n      // y coordinate\n      xbot[1] = 0.5 * model.height + model.center[1];\n      xtop[1] = -0.5 * model.height + model.center[1];\n      tcbot[1] = 0.0;\n      tctop[1] = 1.0;\n\n      // z coordinate\n      nbot[2] = -Math.sin(i * angle + model.initAngle);\n      ntop[2] = nbot[2];\n      xbot[2] = otherRadius * nbot[2] + model.center[2];\n      xtop[2] = xbot[2];\n      const pointIdx = 2 * i;\n      for (let j = 0; j < 3; j++) {\n        normalsData[pointIdx * 3 + j] = nbot[j];\n        normalsData[(pointIdx + 1) * 3 + j] = ntop[j];\n        points[pointIdx * 3 + j] = xbot[j];\n        points[(pointIdx + 1) * 3 + j] = xtop[j];\n        if (j < 2) {\n          tcData[pointIdx * 2 + j] = tcbot[j];\n          tcData[(pointIdx + 1) * 2 + j] = tctop[j];\n        }\n      }\n    }\n\n    // Generate polygons for sides\n    for (let i = 0; i < model.resolution; i++) {\n      polys[cellLocation++] = 4;\n      polys[cellLocation++] = 2 * i;\n      polys[cellLocation++] = 2 * i + 1;\n      const pt = (2 * i + 3) % (2 * model.resolution);\n      polys[cellLocation++] = pt;\n      polys[cellLocation++] = pt - 1;\n    }\n    if (model.capping) {\n      // Generate points for top/bottom polygons\n      for (let i = 0; i < model.resolution; i++) {\n        // x coordinate\n        xbot[0] = model.radius * Math.cos(i * angle + model.initAngle);\n        xtop[0] = xbot[0];\n        tcbot[0] = xbot[0];\n        tctop[0] = xbot[0];\n        xbot[0] += model.center[0];\n        xtop[0] += model.center[0];\n\n        // y coordinate\n        nbot[1] = 1.0;\n        ntop[1] = -1.0;\n        xbot[1] = 0.5 * model.height + model.center[1];\n        xtop[1] = -0.5 * model.height + model.center[1];\n\n        // z coordinate\n        xbot[2] = -otherRadius * Math.sin(i * angle + model.initAngle);\n        xtop[2] = xbot[2];\n        tcbot[1] = xbot[2];\n        tctop[1] = xbot[2];\n        xbot[2] += model.center[2];\n        xtop[2] += model.center[2];\n        const botIdx = 2 * model.resolution + i;\n        const topIdx = 3 * model.resolution + model.resolution - i - 1;\n        for (let j = 0; j < 3; j++) {\n          normalsData[3 * botIdx + j] = nbot[j];\n          normalsData[3 * topIdx + j] = ntop[j];\n          points[3 * botIdx + j] = xbot[j];\n          points[3 * topIdx + j] = xtop[j];\n          if (j < 2) {\n            tcData[2 * botIdx + j] = tcbot[j];\n            tcData[2 * topIdx + j] = tctop[j];\n          }\n        }\n      }\n\n      // Generate polygons for top/bottom\n      polys[cellLocation++] = model.resolution;\n      for (let i = 0; i < model.resolution; i++) {\n        polys[cellLocation++] = 2 * model.resolution + i;\n      }\n      polys[cellLocation++] = model.resolution;\n      for (let i = 0; i < model.resolution; i++) {\n        polys[cellLocation++] = 3 * model.resolution + i;\n      }\n    }\n\n    // Apply transformation to the points coordinates\n    vtkMatrixBuilder.buildFromRadian().translate(...model.center).rotateFromDirections([0, 1, 0], model.direction).translate(...model.center.map(c => c * -1)).apply(points);\n    dataset = vtkPolyData.newInstance();\n    dataset.getPoints().setData(points, 3);\n    dataset.getPolys().setData(polys, 1);\n    dataset.getPointData().setNormals(normals);\n    dataset.getPointData().setTCoords(tcoords);\n\n    // Update output\n    outData[0] = dataset;\n  }\n\n  // Expose methods\n  publicAPI.requestData = requestData;\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  height: 1.0,\n  initAngle: 0,\n  radius: 1.0,\n  resolution: 6,\n  center: [0, 0, 0],\n  direction: [0.0, 1.0, 0.0],\n  capping: true,\n  pointType: 'Float64Array'\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Build VTK API\n  macro.obj(publicAPI, model);\n  macro.setGet(publicAPI, model, ['height', 'initAngle', 'otherRadius', 'radius', 'resolution', 'capping']);\n  macro.setGetArray(publicAPI, model, ['center', 'direction'], 3);\n  macro.algo(publicAPI, model, 0, 1);\n  vtkCylinderSource(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkCylinderSource');\n\n// ----------------------------------------------------------------------------\n\nvar vtkCylinderSource$1 = {\n  newInstance,\n  extend\n};\n\nexport { vtkCylinderSource$1 as default, extend, newInstance };\n","import { m as macro } from '../../macros2.js';\nimport vtkAppendPolyData from '../General/AppendPolyData.js';\nimport vtkConeSource from './ConeSource.js';\nimport vtkCylinderSource from './CylinderSource.js';\nimport vtkMatrixBuilder from '../../Common/Core/MatrixBuilder.js';\n\n// ----------------------------------------------------------------------------\n// vtkArrowSource methods\n// ----------------------------------------------------------------------------\n\nfunction vtkArrowSource(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkArrowSource');\n  function requestData(inData, outData) {\n    if (model.deleted) {\n      return;\n    }\n    const cylinder = vtkCylinderSource.newInstance({\n      capping: true\n    });\n    cylinder.setResolution(model.shaftResolution);\n    cylinder.setRadius(model.shaftRadius);\n    cylinder.setHeight(1.0 - model.tipLength);\n    cylinder.setCenter(0, (1.0 - model.tipLength) * 0.5, 0.0);\n    const cylinderPD = cylinder.getOutputData();\n    const cylinderPts = cylinderPD.getPoints().getData();\n    const cylinderNormals = cylinderPD.getPointData().getNormals().getData();\n\n    // Apply transformation to the cylinder\n    vtkMatrixBuilder.buildFromDegree().rotateZ(-90).apply(cylinderPts).apply(cylinderNormals);\n    const cone = vtkConeSource.newInstance();\n    cone.setResolution(model.tipResolution);\n    cone.setHeight(model.tipLength);\n    cone.setRadius(model.tipRadius);\n    const conePD = cone.getOutputData();\n    const conePts = conePD.getPoints().getData();\n\n    // Apply transformation to the cone\n    vtkMatrixBuilder.buildFromRadian().translate(1.0 - model.tipLength * 0.5, 0.0, 0.0).apply(conePts);\n    const append = vtkAppendPolyData.newInstance();\n    append.setInputData(cylinderPD);\n    append.addInputData(conePD);\n    const appendPD = append.getOutputData();\n    const appendPts = appendPD.getPoints().getData();\n    // Center the arrow about [0, 0, 0]\n    vtkMatrixBuilder.buildFromRadian().translate(-0.5 + model.tipLength * 0.5, 0.0, 0.0).apply(appendPts);\n    if (model.invert) {\n      // Apply transformation to the arrow\n      vtkMatrixBuilder.buildFromRadian().rotateFromDirections([1, 0, 0], model.direction).scale(-1, -1, -1).apply(appendPts);\n\n      // Update output\n      outData[0] = appendPD;\n    } else {\n      // Apply transformation to the arrow\n      vtkMatrixBuilder.buildFromRadian().rotateFromDirections([1, 0, 0], model.direction).scale(1, 1, 1).apply(appendPts);\n\n      // Update output\n      outData[0] = append.getOutputData();\n    }\n  }\n\n  // Expose methods\n  publicAPI.requestData = requestData;\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  tipResolution: 6,\n  tipRadius: 0.1,\n  tipLength: 0.35,\n  shaftResolution: 6,\n  shaftRadius: 0.03,\n  invert: false,\n  direction: [1.0, 0.0, 0.0],\n  pointType: 'Float64Array'\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Build VTK API\n  macro.obj(publicAPI, model);\n  macro.setGet(publicAPI, model, ['tipResolution', 'tipRadius', 'tipLength', 'shaftResolution', 'shaftRadius', 'invert']);\n  macro.setGetArray(publicAPI, model, ['direction'], 3);\n  macro.algo(publicAPI, model, 0, 1);\n  vtkArrowSource(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkArrowSource');\n\n// ----------------------------------------------------------------------------\n\nvar vtkArrowSource$1 = {\n  newInstance,\n  extend\n};\n\nexport { vtkArrowSource$1 as default, extend, newInstance };\n","import { m as macro } from '../../macros2.js';\nimport vtkMatrixBuilder from '../../Common/Core/MatrixBuilder.js';\nimport vtkDataArray from '../../Common/Core/DataArray.js';\nimport vtkActor from './Actor.js';\nimport vtkMapper from './Mapper.js';\nimport vtkArrowSource from '../../Filters/Sources/ArrowSource.js';\nimport vtkAppendPolyData from '../../Filters/General/AppendPolyData.js';\n\n// ----------------------------------------------------------------------------\n\nfunction centerDataSet(ds) {\n  const bounds = ds.getPoints().getBounds();\n  const center = [-(bounds[0] + bounds[1]) * 0.5, -(bounds[2] + bounds[3]) * 0.5, -(bounds[4] + bounds[5]) * 0.5];\n  vtkMatrixBuilder.buildFromDegree().translate(...center).apply(ds.getPoints().getData());\n}\nfunction shiftDataset(ds, axis) {\n  let invert = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  const bounds = ds.getPoints().getBounds();\n  const center = [0, 0, 0];\n  if (invert) {\n    center[axis] = -bounds[axis * 2 + 1];\n  } else {\n    center[axis] = -bounds[axis * 2];\n  }\n  vtkMatrixBuilder.buildFromDegree().translate(...center).apply(ds.getPoints().getData());\n}\n\n// ----------------------------------------------------------------------------\n\nfunction addColor(ds, r, g, b) {\n  const size = ds.getPoints().getData().length;\n  const rgbArray = new Uint8ClampedArray(size);\n  let offset = 0;\n  while (offset < size) {\n    rgbArray[offset++] = r;\n    rgbArray[offset++] = g;\n    rgbArray[offset++] = b;\n  }\n  ds.getPointData().setScalars(vtkDataArray.newInstance({\n    name: 'color',\n    numberOfComponents: 3,\n    values: rgbArray\n  }));\n}\n\n// ----------------------------------------------------------------------------\n// vtkAxesActor\n// ----------------------------------------------------------------------------\n\nfunction vtkAxesActor(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkAxesActor');\n  const _mapper = vtkMapper.newInstance();\n  publicAPI.setMapper(_mapper);\n  publicAPI.update = () => {\n    let currentConfig = {\n      ...model.config,\n      ...model.xConfig\n    };\n    const xAxis = vtkArrowSource.newInstance({\n      direction: [1, 0, 0],\n      ...currentConfig\n    }).getOutputData();\n    if (model.config.recenter) {\n      centerDataSet(xAxis);\n    } else {\n      shiftDataset(xAxis, 0, currentConfig.invert);\n    }\n    addColor(xAxis, ...currentConfig.color);\n    currentConfig = {\n      ...model.config,\n      ...model.yConfig\n    };\n    const yAxis = vtkArrowSource.newInstance({\n      direction: [0, 1, 0],\n      ...currentConfig\n    }).getOutputData();\n    if (model.config.recenter) {\n      centerDataSet(yAxis);\n    } else {\n      shiftDataset(yAxis, 1, currentConfig.invert);\n    }\n    addColor(yAxis, ...currentConfig.color);\n    currentConfig = {\n      ...model.config,\n      ...model.zConfig\n    };\n    const zAxis = vtkArrowSource.newInstance({\n      direction: [0, 0, 1],\n      ...currentConfig\n    }).getOutputData();\n    if (model.config.recenter) {\n      centerDataSet(zAxis);\n    } else {\n      shiftDataset(zAxis, 2, currentConfig.invert);\n    }\n    addColor(zAxis, ...currentConfig.color);\n    const source = vtkAppendPolyData.newInstance();\n    source.setInputData(xAxis);\n    source.addInputData(yAxis);\n    source.addInputData(zAxis);\n    _mapper.setInputConnection(source.getOutputPort());\n  };\n  publicAPI.update();\n  const _debouncedUpdate = macro.debounce(publicAPI.update, 0);\n  publicAPI.setXAxisColor = color => publicAPI.setXConfig({\n    ...publicAPI.getXConfig(),\n    color\n  });\n  publicAPI.setYAxisColor = color => publicAPI.setYConfig({\n    ...publicAPI.getYConfig(),\n    color\n  });\n  publicAPI.setZAxisColor = color => publicAPI.setZConfig({\n    ...publicAPI.getZConfig(),\n    color\n  });\n  publicAPI.getXAxisColor = () => model.getXConfig().color;\n  publicAPI.getYAxisColor = () => model.getYConfig().color;\n  publicAPI.getZAxisColor = () => model.getZConfig().color;\n  model._onConfigChanged = _debouncedUpdate;\n  model._onXConfigChanged = _debouncedUpdate;\n  model._onYConfigChanged = _debouncedUpdate;\n  model._onZConfigChanged = _debouncedUpdate;\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nfunction defaultValues(initialValues) {\n  return {\n    config: {\n      recenter: true,\n      tipResolution: 60,\n      tipRadius: 0.1,\n      tipLength: 0.2,\n      shaftResolution: 60,\n      shaftRadius: 0.03,\n      invert: false,\n      ...initialValues?.config\n    },\n    xConfig: {\n      color: [255, 0, 0],\n      invert: false,\n      ...initialValues?.xConfig\n    },\n    yConfig: {\n      color: [255, 255, 0],\n      invert: false,\n      ...initialValues?.yConfig\n    },\n    zConfig: {\n      color: [0, 128, 0],\n      invert: false,\n      ...initialValues?.zConfig\n    }\n  };\n}\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  // Inheritance\n  vtkActor.extend(publicAPI, model, defaultValues(initialValues));\n  macro.setGet(publicAPI, model, ['config', 'xConfig', 'yConfig', 'zConfig']);\n\n  // Object methods\n  vtkAxesActor(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend, 'vtkAxesActor');\n\n// ----------------------------------------------------------------------------\n\nvar vtkAxesActor$1 = {\n  newInstance,\n  extend\n};\n\nexport { vtkAxesActor$1 as default, extend, newInstance };\n"],"names":["Active","ToolModes","getActiveToolForKeyboardEvent","evt","renderingEngineId","viewportId","detail","mouseButton","modifierKey","getModifierKey","toolGroup","getToolGroupForViewport","toolGroupToolNames","Object","keys","toolOptions","defaultMousePrimary","getDefaultMousePrimary","j","length","toolName","mode","bindings","some","binding","getToolInstance","keyDown","activeTool","getToolName","includes","setViewportsCursorByToolName","activeToolsWithEventBinding","toolModes","toolsWithActions","Map","key","tool","actionsConfig","configuration","actions","values","action","find","set","size","element","value","entries","method","call","keyUp","customCallbackHandler","bind","getActiveToolForMouseEvent","event","mouseEvent","getMouseModifier","buttons","correctBinding","mouseDownAnnotationAction","state","isInteractingWithTool","eventDetail","enabledElement","getEnabledElement","canvas","canvasCoords","currentPoints","getToolsWithActionsForMouseEvent","Passive","tools","Array","from","annotationToolsWithAnnotations","filterToolsWithAnnotationsForElement","moveableAnnotationTools","filterMoveableAnnotationTools","annotation","get","mouseDown","preMouseDownCallback","isPrimaryClick","applicableTools","getToolsWithModesForMouseEvent","undefined","annotationToolsWithMoveableHandles","filterToolsWithMoveableHandles","isMultiSelect","shiftKey","handle","getAnnotationForSelection","toggleAnnotationSelection","annotationUID","handleSelectedCallback","toolSelectedCallback","postMouseDownCallback","toolsWithMovableHandles","unlockAndVisibleAnnotation","item","isUnlocked","isAnnotationLocked","isVisible","isAnnotationVisible","isAnnotationSelected","setAnnotationSelected","preserveSelected","mouseDownActivate","isMultiPartToolActive","addNewAnnotation","mouseDrag","mouseDragCallback","mouseMove","activeAndPassiveTools","toolsWithAnnotations","toolsWithoutAnnotations","filter","toolAndAnnotation","annotationsNeedToBeRedrawn","annotations","mouseMoveCallback","forEach","triggerAnnotationRender","Wheel","mouseWheelCallback","handlerType","customFunction","toolInstance","modesFilter","evtButton","enabledTools","push","getActiveToolForTouchEvent","touchEvent","numTouchPoints","touches","getToolsWithModesForTouchEvent","touchStart","preTouchStartCallback","postTouchStartCallback","touchStartActivate","touchDrag","touchDragCallback","disable","removeEventListener","enable","addEventListener","defaultState","keyCode","keyListener","currentTarget","preventDefault","triggerEvent","KEY_DOWN","document","_onKeyUp","_onVisibilityChange","visibilityState","resetModifierKey","structuredClone","KEY_UP","getMouseEventPoints","elementToUse","viewport","clientPoint","clientX","clientY","_clientToPoint","pagePoint","pageX","pageY","_pageToPoint","canvasPoint","rect","getBoundingClientRect","left","window","pageXOffset","top","pageYOffset","_pagePointsToCanvasPoints","page","client","world","canvasToWorld","startPoints","eventName","MOUSE_DOUBLE_CLICK","camera","lastPoints","deltaPoints","stopImmediatePropagation","MOUSE_DOWN","MOUSE_DOWN_ACTIVATE","MOUSE_CLICK","MOUSE_UP","MOUSE_DRAG","DOUBLE_CLICK_DRAG_TOLERANCE","isClickEvent","clickDelay","preventClickTimeout","doubleClickState","doubleClickTimeout","mouseDownEvent","mouseUpEvent","ignoreDoubleClick","_onMouseDrag","_updateMouseEventsLastPoints","_getDeltaPoints","_isDragPastDoubleClickTolerance","_doStateMouseDownAndUp","_copyPoints","_onMouseUp","clearTimeout","_cleanUp","_onMouseMove","delta","Math","abs","_preventClickHandler","_clearDoubleClickTimeoutAndEvents","_doMouseDown","JSON","parse","stringify","points","_subtractPoints2D","point0","point1","getMouseButton","mouseDoubleClickIgnoreListener","setTimeout","MOUSE_MOVE","pointerType","lastInteractionType","lastInteractionTime","handleTap","type","e","now","Date","stopPropagation","handleTapMouse","handleTapTouch","attachEvents","eventList","interactionType","tapHandler","passive","removeEvents","mouseEvents","touchEvents","getTouchEventPoints","changedTouches","map","i","touch","identifier","radiusX","radiusY","force","rotationAngle","Settings","getRuntimeSettings","TOUCH_START","TOUCH_START_ACTIVATE","TOUCH_PRESS","TOUCH_DRAG","TOUCH_END","TOUCH_TAP","TOUCH_SWIPE","Events","zeroIPoint","zeroIDistance","startPointsList","lastPointsList","isTouchStart","startTime","pressTimeout","pressDelay","pressMaxDistance","accumulatedDistance","swipeDistanceThreshold","swiped","swipeToleranceMs","defaultTapState","taps","tapTimeout","tapMaxDistance","tapToleranceMs","tapState","triggerEventCallback","ele","name","_onTouchDrag","currentPointsList","_updateTouchEventsLastPoints","getDeltaPoints","deltaDistance","getDeltaDistanceBetweenIPoints","totalDistance","getDeltaDistance","getMeanTouchPoints","copyPointsList","currentTime","getTime","x","y","swipe","RIGHT","LEFT","DOWN","UP","_checkTouchSwipe","_onTouchEnd","distanceFromStart","_checkTouchTap","lp","copyPoints","_onTouchPress","_onTouchStart","deltaY","spinX","spinY","pixelX","pixelY","wheelDelta","wheelDeltaY","wheelDeltaX","deltaX","deltaMode","normalizeWheel","direction","MOUSE_WHEEL","wheel","async","convertStackToVolumeLabelmap","args","result","triggerSegmentationModified","segmentationId","updateStackSegmentationState","imageIds","options","segmentation","removeOriginal","data","representationData","Labelmap","cache","getVolume","volumeId","removeVolumeLoadObject","SegmentationRepresentations","eventTarget","addEventListenerOnce","SEGMENTATION_RENDERED","triggerSegmentationDataModified","ToolAndAnnotations","proximity","isLocked","isPointNearTool","console","warn","getAnnotations","constructor","filterInteractableAnnotationsForElement","toolsWithMoveableHandles","getHandleNearImagePoint","CircleSculptCursor","this","toolInfo","toolSize","maxToolSize","shapeName","CHAIN_MAINTENANCE_ITERATIONS","CHAIN_PULL_STRENGTH_FACTOR","MAX_INTER_DISTANCE_FACTOR","renderShape","svgDrawingHelper","canvasLocation","drawCircle","pushHandles","sculptData","mouseCanvasPoint","pushedHandles","first","last","worldRadius","point","handleCanvasPoint","worldToCanvas","pushOneHandle","maintainChainStructure","configureToolSize","maxRadius","min","clientWidth","clientHeight","updateToolSize","activeAnnotation","radius","getMaxSpacing","minSpacing","max","getInsertPosition","previousIndex","nextIndex","insertPosition","previousCanvasPoint","nextCanvasPoint","midPoint","distanceToMidPoint","directionUnitVector","mousePoint","directionalVector","position","p1","p2","calculateMeanConsecutiveDistance","numPoints","mean","round","meanDistance","maxInterDistance","distanceToNext","pullDirection","adjustmentMagnitude","distanceToPrevious","transformWorldToIndex","transformIndexToWorld","GrowCutBaseTool","lastGrowCutCommand","toolProps","defaultToolProps","super","positiveStdDevMultiplier","shrinkExpandIncrement","islandRemoval","enabled","eventData","worldPoint","renderingEngine","viewUp","getCamera","segmentIndex","labelmapVolumeId","referencedVolumeId","getLabelmapSegmentationData","_isOrthogonalView","Error","growCutData","metadata","getViewReference","id","shrink","_runLastCommand","shrinkExpandAmount","expand","refresh","getGrowCutLabelmap","_growCutData","runGrowCut","config","labelmap","shrinkExpandAccumulator","growCutCommand","seeds","newPositiveStdDevMultiplier","negativeSeedMargin","updatedGrowCutData","positiveSeedValue","negativeSeedValue","growcutLabelmap","isPartialVolume","applyPartialGrowCutLabelmap","applyGrowCutLabelmap","_removeIslands","targetLabelmap","sourceLabelmap","srcLabelmapData","voxelManager","getCompleteScalarDataArray","tgtVoxelManager","srcColumns","srcRows","srcNumSlices","dimensions","tgtColumns","tgtRows","srcPixelsPerSlice","tgtPixelsPerSlice","srcSlice","srcRow","srcRowIJK","rowVoxelWorld","imageData","tgtRowIJK","tgtColumn","tgtRow","tgtSlice","srcOffset","tgtOffset","column","labelmapValue","setAtIndex","index","cmd","activeSeg","activeSegmentation","labelmapData","referencedImageIds","getImageIds","getOrCreateSegmentationVolume","currentImageId","getCurrentImageId","currentImage","getImage","fakeImage","imageLoader","_createFakeVolume","imageId","currentLabelmapImageId","fakeDerivedImage","segImageIds","referencedImageId","generateVolumeId","imageVolume","volumeLoader","cachedVolume","volumeProps","spacing","derivedVolume","ImageVolume","dataType","origin","putVolumeSync","volumeImageData","ijkVecColDir","ijkVecSliceDir","every","vec","getRemoveIslandData","removeIslandData","width","height","numPixelsPerSlice","worldIslandPoints","islandPointIndexes","ijkIslandPoints","getRenderingEngine","getViewport","concat","pointIndex","floor","initialize","previewSegmentIndex","floodFillSegmentIsland","removeExternalIslands","removeInternalIslands","getSegmentStyle","distancePointToContour","coords","contour","polyline","distance","Infinity","distanceToPoint","isNaN","eraseRectangle","operationData","inside","eraseOperationData","assign","eraseInsideRectangle","validate3x3Matrix","matrix","isArray","n","inverse3x3Matrix","mat","determinant","adjugate","inverse","normalizeVector","v","magnitude","sqrt","component","checkStandardBasis","directions","xVector","slice","yVector","zVector","normalizedX","normalizedY","normalizedZ","standardBasis","z","epsilon","isStandard","val","rotationMatrix","rotatePoint","rotatePoints","rotatedPoints","rotated","getToolsWithModesForElement","DEFAULT_MULTIPLIER","getVOIMultipliers","ptMultiplier","isPreScaled","isViewportPreScaled","fixedPTWindowWidth","xMultiplier","LivewirePath","inputPointArray","inputControlPointIndexArray","pointArray","_controlPointIndexes","getPoint","getLastPoint","isControlPoint","indexOf","addPoint","addControlPoint","getControlPoints","getNumControlPoints","removeLastControlPoint","pop","getLastControlPoint","removeLastPoints","count","splice","addPoints","newPointArray","prependPath","other","otherSize","shiftedIndexArray","appendPath","BucketQueue","numBits","getPriority","areEqual","_bucketCount","_mask","_size","_currentBucketIndex","_buckets","_buildArray","_getPriority","_areEqual","itemA","itemB","bucketIndex","_getBucketIndex","newHead","next","ret","remove","firstBucketNode","prevNode","node","isEmpty","buckets","fill","isEqual","utilities","MAX_UINT32","TWO_THIRD_PI","PI","LivewireScissors","grayscalePixelData","_getPointIndex","row","col","_getPointCoordinate","_getPointCost","searchGranularity","costs","numPixels","searchGranularityBits","laplace","gradXNew","gradYNew","_computeLaplace","gradMagnitude","_computeGradient","_computeGradientX","_computeGradientY","visited","parents","Uint32Array","Float32Array","startSearch","startPoint","startPointIndex","priorityQueueNew","findMinNearby","testPoint","xRange","yRange","minValue","minPoint","xTest","yTest","distanceCost","weight","findPathToPoint","targetPoint","coord","targetPointIndex","cost","priorityQueue","neighborsPoints","_getNeighborPoints","len","neighborPoint","neighborPointIndex","dist","_getWeightedDistance","neighborCost","pathPoints","pathPointIndex","reverse","_getDeltaX","_getDeltaY","_getGradientMagnitude","dx","dy","_getLaplace","lap","gradient","pixelIndex","gradX","gradY","_getGradientUnitVector","px","py","pointGradX","pointGradY","gradVecLen","_getGradientDirection","qx","qy","dgpUnitVec","gdqUnitVec","dp","dq","SQRT1_2","acos","isFinite","getCost","pointA","pointB","aX","aY","bX","bY","bIndex","list","sx","sy","ex","ey","createInstanceFromRawPixelData","pixelData","voiRange","lower","minPixelValue","upper","maxPixelValue","pixelRange","intersectAABB","aabb1","aabb2","minX","maxX","minY","maxY","distanceToPointSquared","aabb","aabbWidth","aabbHeight","aabbSize","aabbCenter","translatedPoint","angleBetweenLines","line1","line2","p3","p4","v1","v2","cos","angleBetween3DLines","angleBetween2DLines","Calculator","InstanceCalculator","storePointData","getStatistics","debug","getCanvasCircleRadius","circleCanvasPoints","center","end","getCanvasCircleCorners","pointInEllipse","ellipse","pointLPS","inverts","precalculated","precalculatePointInEllipse","xRadius","yRadius","zRadius","invXRadiusSq","invYRadiusSq","invZRadiusSq","centerL","centerP","centerS","dz","getCanvasEllipseCorners","ellipseCanvasPoints","bottom","right","angleFromCenter","angle","normalizeAngle","atan2","intervalFromPoints","pair","start","mergeIntervals","intervals","sort","a","b","merged","current","subtractIntervals","blocked","target","T0","T1","overlaps","p","q","curA","curB","gaps","cursor","clipInterval","inner","outerMerged","out","calculateInnerFanPercentage","outerFanPairs","innerFanPairs","mergedOuter","outerTotal","reduce","sum","clippedInnerIntervals","clipped","percentage","lineStart","lineEnd","distanceSquared","distanceToPointSquaredInfo","closestPoint","dotProduct","ORIENTATION_TOLERANCE","isPointOnLineSegment","orientation","arg","midPoint2","x1","y1","z1","x2","y2","z2","mirror","mirrorPoint","staticPoint","canvasPoints","newCanvasPoint","commonData","xDir","yDir","log","lastWorldPos","newWorldPos","worldPosDiff","xDist","yDist","numPointsToAdd","lastCanvasPoint","canvasDist","canvasDir","distPerPoint","areLineSegmentsIntersecting","q1","q2","line1MinX","line1MinY","line1MaxX","line1MaxY","line2MinX","line2MinY","line2MaxX","line2MaxY","orient","onSegment","r","orientationValue","PolylinePointType","PolylinePointPosition","PolylinePointDirection","ensuresNextPointers","polylinePoints","currentPoint","mergePolylines","targetPolyline","sourcePolyline","targetNormal","sourceNormal","dotNormals","targetPolylinePoints","sourcePolylinePoints","sourceIntersectionsCache","intersectionPointDirection","Exiting","Entering","pointInside","vertexPoint","Vertex","coordinates","Inside","Outside","intersectionsInfo","intersectedLineSegment","sourceLineSegmentId","intersectionCoordinate","coordinate","targetStartPointDistSquared","intersectionInfo","targetEdgePoint","Intersection","Edge","sourceEdgePoint","Unknown","cloned","sourceIntersectionPoints","lineSegmentId","intersectionPoint","lineSegStartDistSquared","getSourceAndTargetPointsList","getUnvisitedOutsidePoint","mergedPolyline","iterationCount","maxIterations","containsPoint","closed","numPolylinePoints","numIntersections","holes","hole","shouldClose","maxSegmentIndex","intersects","xIntersection","convexHull","pts","cross","o","getAABB","polylineToUse","numDimensions","is3D","currentPolyline","totalPoints","minZ","maxZ","getArea","area","getClosestLineSegmentIntersection","initialQ2Index","p2Index","intersections","q2Index","distances","intersection","intersectionPoints","midpoint","minDistance","segment","getFirstLineSegmentIntersectionIndexes","initialI","getLineSegmentIntersectionsCoordinates","polylineIndexes","getLineSegmentIntersectionsIndexes","maxI","PARALLEL_LINES_TOLERANCE","getLinesIntersection","diffQ1P1","diffQ2P2","denominator","line1AABB","line2AABB","numerator2","getNormal2","getNormal3","vecArea","refPoint","aZ","bZ","_getAreaVector","EPSILON","subPixelResolution","StackViewport","getImageData","volumeSpacing","viewPlaneNormal","iVector","jVector","kVector","viewRight","absViewRightDotI","absViewRightDotJ","absViewRightDotK","xSpacing","absViewUpDotI","absViewUpDotJ","absViewUpDotK","ySpacing","getWindingDirection","intersectPolyline","sourceLen","sourceP1","sourceP2","intersectionPointIndexes","intersectPolylines","mainPolyCoords","clipPolyCoordsInput","clipPolyCoords","mainArea","clipArea","currentClipPolyForPIP","intersectPt","lenP","lenQ","seg1Idx","seg2Idx","alpha1","alpha2","pt","buildAugmentedList","polyCoords","polyIndex","allIntersections","augmentedList","nodeIdCounter","originalPolyIndex","originalVertexIndex","prev","isIntersection","processedInPath","intersectionDir","segmentIntersections","isect","lastNode","alpha","finalList","lastNodeInFinal","firstNode","lastNodePopped","mainAugmented","clipAugmented","mainNode","mainIntersectData","partnerNode","clipNode","v_arrival_main","v_departure_clip","crossZ","midPrevMainSeg","resultPolygons","startCand","currentPathCoords","currentNode","onMainList","pathStartNode","safetyBreak","maxIter","switchedList","resultArea","isPointInsidePolyline3D","sharedDimensionIndex","projectedPolyline","projectedHoles","hole2D","point2D","p1p","p1p2","dot","p1p2Mag","projectionVectorMag","p1p2UnitVector","projectionVector","projectionPoint","closeContourProximity","projectTo2D","testPoints","array","points2D","firstDim","secondDim","vec2CrossZ","pointsAreEqual","robustSegmentIntersection","s","rxs","qmp","qmpxr","rDotR","sDotS","t0","t1","u0","u1","isInRange","t","u","PolylineNodeType","IntersectionDirection","subtractPolylines","targetPolylineCoords","sourcePolylineCoordsInput","sourcePolylineCoords","targetArea","sourceArea","sign","targetAugmented","sourceAugmented","tnode","tData","partner","snode","p_prev","p_curr","p_next_source","midPrevTargetSeg","prevSegMidpointInsideSource","resultPolylines","startNode","onTargetList","INSIDE","OUTSIDE","clipT","num","denom","c","tE","tL","clip","box","da","db","rotate","random","srcList","smoothAnnotation","knotsRatioPercentage","shouldPreventInterpolation","rotateMat","normal","focal","eye","up","rotateMatrix","planeP","rotation","interpolatedCanvasPoints","loop","unRotate","filterAnnotationsWithinSlice","getWorldWidthAndHeightFromCorners","getWorldWidthAndHeightFromTwoPoints","filterAnnotationsForDisplay","getPointInLineOfSightWithCriteria","isPlaneIntersectingAABB","filterAnnotationsWithinSamePlane","getPointsInLineOfSight","POSITIVE_SEED_LABEL","NEGATIVE_SEED_LABEL","DEFAULT_NEIGHBORHOOD_RADIUS","DEFAULT_POSITIVE_STD_DEV_MULTIPLIER","DEFAULT_NEGATIVE_STD_DEV_MULTIPLIER","DEFAULT_NEGATIVE_SEED_MARGIN","DEFAULT_NEGATIVE_SEEDS_COUNT","MAX_NEGATIVE_SEED_ATTEMPTS_MULTIPLIER","requestType","Enums","Prefetch","priority","range","lowEnd","highEnd","arr","nearestIndex","low","high","idx","getStackData","currentImageIdIndex","getCurrentImageIdIndex","getPromiseRemovedHandler","stackData","error","imageIdIndex","stackPrefetchData","indicesToRequest","clearFromImageIds","stack","imageIdSet","Set","requestDetails","has","additionalDetails","addToolState","getToolState","interpolateVec3","clamp","ColorbarCanvas","props","validateProps","colormap","imageRange","container","showFullPixelValueRange","_colormap","_imageRange","_voiRange","_showFullImageRange","_canvas","_createRootElement","appendTo","render","_setCanvasSize","showFullImageRange","appendChild","dispose","parentElement","removeChild","style","createElement","pointerEvents","boxSizing","isConnected","RGBPoints","rgbPoints","colorsCount","getColorPoint","offset","color","canvasContext","getContext","isHorizontal","maxValue","previousColorPoint","currentColorPoint","incRawPixelValue","rawPixelValue","tVoiRange","normColor","tColorRange","fillStyle","fillRect","DEFAULTS","FONT","COLOR","TICK_SIZE","TICK_WIDTH","TICK_LABEL_MARGIN","MAX_NUM_TICKS","TICKS_STEPS","ColorbarTicks","ticks","ticksProps","ticksStyle","rangeTextPosition","_font","font","_color","_tickSize","tickSize","_tickWidth","tickWidth","_labelMargin","labelMargin","_maxNumTicks","maxNumTicks","_rangeTextPosition","Right","_showFullPixelValueRange","_createCanvasElement","Number","parseInt","showFullRange","visible","display","_getTicks","roughStep","stepPower","pow","log10","roughtStepNormalized","step","scaleMax","ceil","scaleMin","ticksCount","_getLeftTickInfo","labelMeasure","labelPoint","tickPoints","_getRightTickInfo","_getTopTickInfo","_getBottomTickInfo","maxCanvasPixelValue","rangeWidth","clearRect","textBaseline","textAlign","strokeStyle","lineWidth","tick","label","toString","measureText","tickInfo","Top","Left","tickStart","tickEnd","beginPath","moveTo","lineTo","fillText","stroke","isRangeValid","isColorbarSizeValid","areColorbarRangesEqual","areColorbarSizesEqual","isRangeTextPositionValid","colorbarWidth","colorbarHeight","ColorbarRangeTextPosition","Bottom","Widget","_containerResizeCallback","contentRect","contentBoxSize","inlineSize","blockSize","_containerSize","onContainerResize","_id","_rootElement","createRootElement","_containerResizeObserver","ResizeObserver","rootElement","resizeObserver","currentContainer","unobserve","observe","destroy","disconnect","containerSize","classList","add","DEFAULT_VALUES","latLongTessellation","thetaResolution","startTheta","endTheta","phiResolution","startPhi","endPhi","pointType","extend","publicAPI","model","initialValues","arguments","m","obj","setGet","setGetArray","algo","classHierarchy","requestData","inData","outData","deleted","dataset","pointDataType","getPoints","getDataType","numPoles","deltaTheta","jStart","jEnd","numPts","numPolys","pointIdx","newTypedArray","normals","cellLocation","polys","deltaPhi","theta","phi","sin","norm","base","numOffset","subarray","setData","normalArray","numberOfComponents","getPointData","setNormals","getPolys","vtkSphereSource","vtkSphereSource$1","newInstance","Constants","Corners","TOP_LEFT","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_RIGHT","vtkErrorMacro","viewportCorner","viewportSize","minPixelSize","maxPixelSize","parentRenderer","interactiveRenderer","moveToProtected","superClass","previousCameraInput","selfRenderer","updateViewport","onCameraChangedSub","onCameraModifiedSub","onAnimationSub","onEndAnimationSub","selfSubscription","onCameraModified","_interactor","isAnimating","updateMarkerOrientation","_onParentRendererChanged","computeViewport","parentRen","getCurrentRenderer","xMin","yMin","xMax","yMax","view","getView","canvasSize","getSize","viewXSize","viewYSize","getViewportSize","minViewSize","pixelSize","xFrac","yFrac","setViewport","currentCamera","getActiveCamera","getReferenceByName","focalPoint","activeCamera","setPosition","setFocalPoint","setViewUp","resetCamera","setEnabled","enabling","actor","ren","renderWindow","getRenderWindow","addRenderer","getNumberOfLayers","setNumberOfLayers","setLayer","setInteractive","addViewProp","setVisibility","onEvent","unsubscribe","onModified","onAnimation","onEndAnimation","getCanvas","removeViewProp","findPokedRenderer","removeRenderer","modified","setViewportCorner","corner","setViewportSize","sizeFactor","setActor","previousState","getRenderer","delete","vtkOrientationMarkerWidget","vtkOrientationMarkerWidget$1","canvasToImageData","boundingBox","idata","setOrigin","setSpacing","setExtent","scalars","Uint8Array","buffer","setName","setScalars","ImageHelper","imageToImageData","image","transform","flipX","flipY","ctx","translate","scale","drawImage","STYLES","default","defaultStyle","fontStyle","fontFamily","fontColor","fontSizeScale","res","faceColor","edgeThickness","edgeColor","resolution","xMinusFaceProperty","text","xPlusFaceProperty","yMinusFaceProperty","yPlusFaceProperty","zMinusFaceProperty","zPlusFaceProperty","lps","faceRotation","applyDefinitions","definitions","cubeActor","AnnotatedCubePresets","applyPreset","registerStylePreset","FACE_TO_INDEX","xPlus","xMinus","yPlus","yMinus","zPlus","zMinus","cubeSource","mapper","texture","updateFaceTexture","faceName","newProp","prop","ctxt","strokeRect","save","textSize","restore","vtkImage","setInputData","updateAllFaceTextures","generate3DTextureCoordinates","setInputConnection","getOutputPort","setInterpolate","setDefaultStyle","setXPlusFaceProperty","setXMinusFaceProperty","setYPlusFaceProperty","setYMinusFaceProperty","setZPlusFaceProperty","setZMinusFaceProperty","setMapper","addTexture","vtkAnnotatedCubeActor","vtkAnnotatedCubeActor$1","Presets","appendCellData","dest","src","ptOffset","cellOffset","typedArray","currentIdx","offsetCellArray","outputPointsPrecision","DEFAULT","numberOfInputs","getNumberOfInputPorts","output","ttype","firstType","numVerts","numLines","numStrips","hasPtNormals","hasPtTCoords","hasPtScalars","ds","dsNumPts","getNumberOfPoints","getVerts","getNumberOfValues","getLines","getStrips","ptD","getNormals","getTCoords","getScalars","SINGLE","FLOAT","DOUBLE","setNumberOfPoints","pointData","getData","vertData","lineData","stripData","polyData","newPtNormals","newPtTCoords","newPtScalars","lds","dsNormals","numberOfTuples","getName","dsTCoords","dsScalars","getNumberOfComponents","dsPD","ptNorms","ptTCoords","ptScalars","setPoints","setTCoords","vtkAppendPolyData","vtkAppendPolyData$1","capping","xbot","numberOfPoints","cellArraySize","buildFromRadian","rotateFromDirections","apply","vtkConeSource","vtkConeSource$1","initAngle","numberOfPolys","normalsData","tcData","tcoords","nbot","ntop","xtop","tcbot","tctop","otherRadius","botIdx","topIdx","vtkCylinderSource","vtkCylinderSource$1","tipResolution","tipRadius","tipLength","shaftResolution","shaftRadius","invert","cylinder","setResolution","setRadius","setHeight","setCenter","cylinderPD","getOutputData","cylinderPts","cylinderNormals","buildFromDegree","rotateZ","cone","conePD","conePts","append","addInputData","appendPD","appendPts","vtkArrowSource","vtkArrowSource$1","centerDataSet","bounds","getBounds","shiftDataset","axis","addColor","g","rgbArray","Uint8ClampedArray","recenter","xConfig","yConfig","zConfig","defaultValues","_mapper","update","currentConfig","xAxis","yAxis","zAxis","source","_debouncedUpdate","debounce","setXAxisColor","setXConfig","getXConfig","setYAxisColor","setYConfig","getYConfig","setZAxisColor","setZConfig","getZConfig","getXAxisColor","getYAxisColor","getZAxisColor","_onConfigChanged","_onXConfigChanged","_onYConfigChanged","_onZConfigChanged","vtkAxesActor","vtkAxesActor$1"],"sourceRoot":""}